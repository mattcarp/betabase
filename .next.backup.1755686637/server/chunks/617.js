"use strict";exports.id=617,exports.ids=[617],exports.modules={13602:(a,b,c)=>{function d(a){let b=Object.values(a).filter(a=>"number"==typeof a);return Object.entries(a).filter(([a,c])=>-1===b.indexOf(+a)).map(([a,b])=>b)}function e(a,b){return"bigint"==typeof b?b.toString():b}function f(a){return{get value(){{let b=a();return Object.defineProperty(this,"value",{value:b}),b}}}}function g(a){return null==a}function h(a){let b=+!!a.startsWith("^"),c=a.endsWith("$")?a.length-1:a.length;return a.slice(b,c)}function i(a,b){let c=(a.toString().split(".")[1]||"").length,d=(b.toString().split(".")[1]||"").length,e=c>d?c:d;return Number.parseInt(a.toFixed(e).replace(".",""))%Number.parseInt(b.toFixed(e).replace(".",""))/10**e}function j(a,b,c){Object.defineProperty(a,b,{get(){{let d=c();return a[b]=d,d}},set(c){Object.defineProperty(a,b,{value:c})},configurable:!0})}function k(a,b,c){Object.defineProperty(a,b,{value:c,writable:!0,enumerable:!0,configurable:!0})}function l(a){return JSON.stringify(a)}c.d(b,{$f:()=>r,A2:()=>t,Gv:()=>n,LG:()=>i,NM:()=>u,OH:()=>A,PO:()=>f,QH:()=>C,Qd:()=>p,Rc:()=>G,UQ:()=>l,Up:()=>w,Vy:()=>k,X$:()=>y,cJ:()=>x,cl:()=>g,gJ:()=>j,gx:()=>m,h1:()=>z,hI:()=>o,iR:()=>F,k8:()=>e,lQ:()=>D,mw:()=>B,o8:()=>s,p6:()=>h,qQ:()=>q,sn:()=>H,w5:()=>d,zH:()=>v});let m=Error.captureStackTrace?Error.captureStackTrace:(...a)=>{};function n(a){return"object"==typeof a&&null!==a&&!Array.isArray(a)}let o=f(()=>{if("undefined"!=typeof navigator&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{return Function(""),!0}catch(a){return!1}});function p(a){if(!1===n(a))return!1;let b=a.constructor;if(void 0===b)return!0;let c=b.prototype;return!1!==n(c)&&!1!==Object.prototype.hasOwnProperty.call(c,"isPrototypeOf")}let q=new Set(["string","number","symbol"]);function r(a){return a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function s(a,b,c){let d=new a._zod.constr(b??a._zod.def);return(!b||c?.parent)&&(d._zod.parent=a),d}function t(a){if(!a)return{};if("string"==typeof a)return{error:()=>a};if(a?.message!==void 0){if(a?.error!==void 0)throw Error("Cannot specify both `message` and `error` params");a.error=a.message}return(delete a.message,"string"==typeof a.error)?{...a,error:()=>a.error}:a}function u(a){return Object.keys(a).filter(b=>"optional"===a[b]._zod.optin&&"optional"===a[b]._zod.optout)}let v={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-0x80000000,0x7fffffff],uint32:[0,0xffffffff],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function w(a,b){let c={},d=a._zod.def;for(let a in b){if(!(a in d.shape))throw Error(`Unrecognized key: "${a}"`);b[a]&&(c[a]=d.shape[a])}return s(a,{...a._zod.def,shape:c,checks:[]})}function x(a,b){let c={...a._zod.def.shape},d=a._zod.def;for(let a in b){if(!(a in d.shape))throw Error(`Unrecognized key: "${a}"`);b[a]&&delete c[a]}return s(a,{...a._zod.def,shape:c,checks:[]})}function y(a,b){if(!p(b))throw Error("Invalid input to extend: expected a plain object");let c={...a._zod.def,get shape(){let c={...a._zod.def.shape,...b};return k(this,"shape",c),c},checks:[]};return s(a,c)}function z(a,b){return s(a,{...a._zod.def,get shape(){let c={...a._zod.def.shape,...b._zod.def.shape};return k(this,"shape",c),c},catchall:b._zod.def.catchall,checks:[]})}function A(a,b,c){let d=b._zod.def.shape,e={...d};if(c)for(let b in c){if(!(b in d))throw Error(`Unrecognized key: "${b}"`);c[b]&&(e[b]=a?new a({type:"optional",innerType:d[b]}):d[b])}else for(let b in d)e[b]=a?new a({type:"optional",innerType:d[b]}):d[b];return s(b,{...b._zod.def,shape:e,checks:[]})}function B(a,b,c){let d=b._zod.def.shape,e={...d};if(c)for(let b in c){if(!(b in e))throw Error(`Unrecognized key: "${b}"`);c[b]&&(e[b]=new a({type:"nonoptional",innerType:d[b]}))}else for(let b in d)e[b]=new a({type:"nonoptional",innerType:d[b]});return s(b,{...b._zod.def,shape:e,checks:[]})}function C(a,b=0){for(let c=b;c<a.issues.length;c++)if(a.issues[c]?.continue!==!0)return!0;return!1}function D(a,b){return b.map(b=>(b.path??(b.path=[]),b.path.unshift(a),b))}function E(a){return"string"==typeof a?a:a?.message}function F(a,b,c){let d={...a,path:a.path??[]};return a.message||(d.message=E(a.inst?._zod.def?.error?.(a))??E(b?.error?.(a))??E(c.customError?.(a))??E(c.localeError?.(a))??"Invalid input"),delete d.inst,delete d.continue,b?.reportInput||delete d.input,d}function G(a){return Array.isArray(a)?"array":"string"==typeof a?"string":"unknown"}function H(...a){let[b,c,d]=a;return"string"==typeof b?{message:b,code:"custom",input:c,inst:d}:{...b}}},27771:(a,b,c)=>{c.d(b,{Od:()=>i,Rb:()=>h,Tj:()=>g,bp:()=>l,wG:()=>k,xL:()=>j});var d=c(41725),e=c(84181),f=c(13602);let g=a=>(b,c,e,g)=>{let h=e?Object.assign(e,{async:!1}):{async:!1},i=b._zod.run({value:c,issues:[]},h);if(i instanceof Promise)throw new d.GT;if(i.issues.length){let b=new(g?.Err??a)(i.issues.map(a=>f.iR(a,h,d.$W())));throw f.gx(b,g?.callee),b}return i.value};e.Kd;let h=a=>async(b,c,e,g)=>{let h=e?Object.assign(e,{async:!0}):{async:!0},i=b._zod.run({value:c,issues:[]},h);if(i instanceof Promise&&(i=await i),i.issues.length){let b=new(g?.Err??a)(i.issues.map(a=>f.iR(a,h,d.$W())));throw f.gx(b,g?.callee),b}return i.value};e.Kd;let i=a=>(b,c,g)=>{let h=g?{...g,async:!1}:{async:!1},i=b._zod.run({value:c,issues:[]},h);if(i instanceof Promise)throw new d.GT;return i.issues.length?{success:!1,error:new(a??e.a$)(i.issues.map(a=>f.iR(a,h,d.$W())))}:{success:!0,data:i.value}},j=i(e.Kd),k=a=>async(b,c,e)=>{let g=e?Object.assign(e,{async:!0}):{async:!0},h=b._zod.run({value:c,issues:[]},g);return h instanceof Promise&&(h=await h),h.issues.length?{success:!1,error:new a(h.issues.map(a=>f.iR(a,g,d.$W())))}:{success:!0,data:h.value}},l=k(e.Kd)},28200:(a,b,c)=>{c.d(b,{N:()=>ao});var d=c(67330),e=c(45702),f=c(75490),g=c(59432),h=f.Ik({error:f.Ik({message:f.Yj(),type:f.Yj().nullish(),param:f.bz().nullish(),code:f.KC([f.Yj(),f.ai()]).nullish()})}),i=(0,d.sl)({errorSchema:h,errorToMessage:a=>a.error.message});function j({id:a,model:b,created:c}){return{id:null!=a?a:void 0,modelId:null!=b?b:void 0,timestamp:null!=c?new Date(1e3*c):void 0}}function k(a){switch(a){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var l=f.Ik({logitBias:f.g1(g.qG(f.rS,void 0),f.ai()).optional(),logprobs:f.KC([f.zM(),f.ai()]).optional(),parallelToolCalls:f.zM().optional(),user:f.Yj().optional(),reasoningEffort:f.k5(["minimal","low","medium","high"]).optional(),maxCompletionTokens:f.ai().optional(),store:f.zM().optional(),metadata:f.g1(f.Yj().max(64),f.Yj().max(512)).optional(),prediction:f.g1(f.Yj(),f.bz()).optional(),structuredOutputs:f.zM().optional(),serviceTier:f.k5(["auto","flex","priority"]).optional(),strictJsonSchema:f.zM().optional(),textVerbosity:f.k5(["low","medium","high"]).optional(),promptCacheKey:f.Yj().optional(),safetyIdentifier:f.Yj().optional()}),m=f.Ik({key:f.Yj(),type:f.k5(["eq","ne","gt","gte","lt","lte"]),value:f.KC([f.Yj(),f.ai(),f.zM()])}),n=f.Ik({type:f.k5(["and","or"]),filters:f.YO(f.KC([m,f.RZ(()=>n)]))}),o=f.KC([m,n]),p=f.Ik({vectorStoreIds:f.YO(f.Yj()).optional(),maxNumResults:f.ai().optional(),ranking:f.Ik({ranker:f.k5(["auto","default-2024-08-21"]).optional()}).optional(),filters:o.optional()}),q=(0,d.hL)({id:"openai.file_search",name:"file_search",inputSchema:f.Ik({query:f.Yj()})}),r=f.Ik({searchContextSize:f.k5(["low","medium","high"]).optional(),userLocation:f.Ik({type:f.eu("approximate"),country:f.Yj().optional(),city:f.Yj().optional(),region:f.Yj().optional(),timezone:f.Yj().optional()}).optional()}),s=(0,d.hL)({id:"openai.web_search_preview",name:"web_search_preview",inputSchema:f.Ik({})}),t=class{constructor(a,b){this.specificationVersion="v2",this.supportedUrls={"image/*":[/^https?:\/\/.*$/]},this.modelId=a,this.config=b}get provider(){return this.config.provider}async getArgs({prompt:a,maxOutputTokens:b,temperature:c,topP:f,topK:g,frequencyPenalty:h,presencePenalty:i,stopSequences:j,responseFormat:k,seed:m,tools:n,toolChoice:o,providerOptions:q}){var s,t,u,v,w,z,A,B,C;let D=[],E=null!=(s=await (0,d.xI)({provider:"openai",providerOptions:q,schema:l}))?s:{},F=null==(t=E.structuredOutputs)||t;null!=g&&D.push({type:"unsupported-setting",setting:"topK"}),(null==k?void 0:k.type)!=="json"||null==k.schema||F||D.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is only supported with structuredOutputs"});let{messages:G,warnings:H}=function({prompt:a,systemMessageMode:b="system"}){let c=[],f=[];for(let{role:g,content:h}of a)switch(g){case"system":switch(b){case"system":c.push({role:"system",content:h});break;case"developer":c.push({role:"developer",content:h});break;case"remove":f.push({type:"other",message:"system messages are removed for this model"});break;default:throw Error(`Unsupported system message mode: ${b}`)}break;case"user":if(1===h.length&&"text"===h[0].type){c.push({role:"user",content:h[0].text});break}c.push({role:"user",content:h.map((a,b)=>{var c,f,g;switch(a.type){case"text":return{type:"text",text:a.text};case"file":if(a.mediaType.startsWith("image/")){let b="image/*"===a.mediaType?"image/jpeg":a.mediaType;return{type:"image_url",image_url:{url:a.data instanceof URL?a.data.toString():`data:${b};base64,${(0,d.ej)(a.data)}`,detail:null==(f=null==(c=a.providerOptions)?void 0:c.openai)?void 0:f.imageDetail}}}if(a.mediaType.startsWith("audio/")){if(a.data instanceof URL)throw new e.b8({functionality:"audio file parts with URLs"});switch(a.mediaType){case"audio/wav":return{type:"input_audio",input_audio:{data:(0,d.ej)(a.data),format:"wav"}};case"audio/mp3":case"audio/mpeg":return{type:"input_audio",input_audio:{data:(0,d.ej)(a.data),format:"mp3"}};default:throw new e.b8({functionality:`audio content parts with media type ${a.mediaType}`})}}if("application/pdf"===a.mediaType){if(a.data instanceof URL)throw new e.b8({functionality:"PDF file parts with URLs"});return{type:"file",file:"string"==typeof a.data&&a.data.startsWith("file-")?{file_id:a.data}:{filename:null!=(g=a.filename)?g:`part-${b}.pdf`,file_data:`data:application/pdf;base64,${(0,d.ej)(a.data)}`}}}else throw new e.b8({functionality:`file part media type ${a.mediaType}`})}})});break;case"assistant":{let a="",b=[];for(let c of h)switch(c.type){case"text":a+=c.text;break;case"tool-call":b.push({id:c.toolCallId,type:"function",function:{name:c.toolName,arguments:JSON.stringify(c.input)}})}c.push({role:"assistant",content:a,tool_calls:b.length>0?b:void 0});break}case"tool":for(let a of h){let b,d=a.output;switch(d.type){case"text":case"error-text":b=d.value;break;case"content":case"json":case"error-json":b=JSON.stringify(d.value)}c.push({role:"tool",tool_call_id:a.toolCallId,content:b})}break;default:throw Error(`Unsupported role: ${g}`)}return{messages:c,warnings:f}}({prompt:a,systemMessageMode:x(w=this.modelId)?null!=(A=null==(z=y[w])?void 0:z.systemMessageMode)?A:"developer":"system"});D.push(...H);let I=null!=(u=E.strictJsonSchema)&&u,J={model:this.modelId,logit_bias:E.logitBias,logprobs:!0===E.logprobs||"number"==typeof E.logprobs||void 0,top_logprobs:"number"==typeof E.logprobs?E.logprobs:"boolean"==typeof E.logprobs&&E.logprobs?0:void 0,user:E.user,parallel_tool_calls:E.parallelToolCalls,max_tokens:b,temperature:c,top_p:f,frequency_penalty:h,presence_penalty:i,response_format:(null==k?void 0:k.type)==="json"?F&&null!=k.schema?{type:"json_schema",json_schema:{schema:k.schema,strict:I,name:null!=(v=k.name)?v:"response",description:k.description}}:{type:"json_object"}:void 0,stop:j,seed:m,verbosity:E.textVerbosity,max_completion_tokens:E.maxCompletionTokens,store:E.store,metadata:E.metadata,prediction:E.prediction,reasoning_effort:E.reasoningEffort,service_tier:E.serviceTier,prompt_cache_key:E.promptCacheKey,safety_identifier:E.safetyIdentifier,messages:G};x(this.modelId)?(null!=J.temperature&&(J.temperature=void 0,D.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),null!=J.top_p&&(J.top_p=void 0,D.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"})),null!=J.frequency_penalty&&(J.frequency_penalty=void 0,D.push({type:"unsupported-setting",setting:"frequencyPenalty",details:"frequencyPenalty is not supported for reasoning models"})),null!=J.presence_penalty&&(J.presence_penalty=void 0,D.push({type:"unsupported-setting",setting:"presencePenalty",details:"presencePenalty is not supported for reasoning models"})),null!=J.logit_bias&&(J.logit_bias=void 0,D.push({type:"other",message:"logitBias is not supported for reasoning models"})),null!=J.logprobs&&(J.logprobs=void 0,D.push({type:"other",message:"logprobs is not supported for reasoning models"})),null!=J.top_logprobs&&(J.top_logprobs=void 0,D.push({type:"other",message:"topLogprobs is not supported for reasoning models"})),null!=J.max_tokens&&(null==J.max_completion_tokens&&(J.max_completion_tokens=J.max_tokens),J.max_tokens=void 0)):(this.modelId.startsWith("gpt-4o-search-preview")||this.modelId.startsWith("gpt-4o-mini-search-preview"))&&null!=J.temperature&&(J.temperature=void 0,D.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for the search preview models and has been removed."})),"flex"!==E.serviceTier||(B=this.modelId).startsWith("o3")||B.startsWith("o4-mini")||B.startsWith("gpt-5")&&!B.startsWith("gpt-5-chat")||(D.push({type:"unsupported-setting",setting:"serviceTier",details:"flex processing is only available for o3, o4-mini, and gpt-5 models"}),J.service_tier=void 0),"priority"!==E.serviceTier||(C=this.modelId).startsWith("gpt-4")||C.startsWith("gpt-5-mini")||C.startsWith("gpt-5")&&!C.startsWith("gpt-5-nano")&&!C.startsWith("gpt-5-chat")||C.startsWith("o3")||C.startsWith("o4-mini")||(D.push({type:"unsupported-setting",setting:"serviceTier",details:"priority processing is only available for supported models (gpt-4, gpt-5, gpt-5-mini, o3, o4-mini) and requires Enterprise access. gpt-5-nano is not supported"}),J.service_tier=void 0);let{tools:K,toolChoice:L,toolWarnings:M}=function({tools:a,toolChoice:b,structuredOutputs:c,strictJsonSchema:d}){a=(null==a?void 0:a.length)?a:void 0;let f=[];if(null==a)return{tools:void 0,toolChoice:void 0,toolWarnings:f};let g=[];for(let b of a)switch(b.type){case"function":g.push({type:"function",function:{name:b.name,description:b.description,parameters:b.inputSchema,strict:c?d:void 0}});break;case"provider-defined":switch(b.id){case"openai.file_search":{let a=p.parse(b.args);g.push({type:"file_search",vector_store_ids:a.vectorStoreIds,max_num_results:a.maxNumResults,ranking_options:a.ranking?{ranker:a.ranking.ranker}:void 0,filters:a.filters});break}case"openai.web_search_preview":{let a=r.parse(b.args);g.push({type:"web_search_preview",search_context_size:a.searchContextSize,user_location:a.userLocation});break}default:f.push({type:"unsupported-tool",tool:b})}break;default:f.push({type:"unsupported-tool",tool:b})}if(null==b)return{tools:g,toolChoice:void 0,toolWarnings:f};let h=b.type;switch(h){case"auto":case"none":case"required":return{tools:g,toolChoice:h,toolWarnings:f};case"tool":return{tools:g,toolChoice:{type:"function",function:{name:b.toolName}},toolWarnings:f};default:throw new e.b8({functionality:`tool choice type: ${h}`})}}({tools:n,toolChoice:o,structuredOutputs:F,strictJsonSchema:I});return{args:{...J,tools:K,tool_choice:L},warnings:[...D,...M]}}async doGenerate(a){var b,c,e,f,g,h,l,m,n,o,p,q,r,s;let{args:t,warnings:u}=await this.getArgs(a),{responseHeaders:w,value:x,rawValue:y}=await (0,d.GU)({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:(0,d.m2)(this.config.headers(),a.headers),body:t,failedResponseHandler:i,successfulResponseHandler:(0,d.cV)(v),abortSignal:a.abortSignal,fetch:this.config.fetch}),z=x.choices[0],A=[],B=z.message.content;for(let a of(null!=B&&B.length>0&&A.push({type:"text",text:B}),null!=(b=z.message.tool_calls)?b:[]))A.push({type:"tool-call",toolCallId:null!=(c=a.id)?c:(0,d.$C)(),toolName:a.function.name,input:a.function.arguments});for(let a of null!=(e=z.message.annotations)?e:[])A.push({type:"source",sourceType:"url",id:(0,d.$C)(),url:a.url,title:a.title});let C=null==(f=x.usage)?void 0:f.completion_tokens_details,D=null==(g=x.usage)?void 0:g.prompt_tokens_details,E={openai:{}};return(null==C?void 0:C.accepted_prediction_tokens)!=null&&(E.openai.acceptedPredictionTokens=null==C?void 0:C.accepted_prediction_tokens),(null==C?void 0:C.rejected_prediction_tokens)!=null&&(E.openai.rejectedPredictionTokens=null==C?void 0:C.rejected_prediction_tokens),(null==(h=z.logprobs)?void 0:h.content)!=null&&(E.openai.logprobs=z.logprobs.content),{content:A,finishReason:k(z.finish_reason),usage:{inputTokens:null!=(m=null==(l=x.usage)?void 0:l.prompt_tokens)?m:void 0,outputTokens:null!=(o=null==(n=x.usage)?void 0:n.completion_tokens)?o:void 0,totalTokens:null!=(q=null==(p=x.usage)?void 0:p.total_tokens)?q:void 0,reasoningTokens:null!=(r=null==C?void 0:C.reasoning_tokens)?r:void 0,cachedInputTokens:null!=(s=null==D?void 0:D.cached_tokens)?s:void 0},request:{body:t},response:{...j(x),headers:w,body:y},warnings:u,providerMetadata:E}}async doStream(a){let{args:b,warnings:c}=await this.getArgs(a),f={...b,stream:!0,stream_options:{include_usage:!0}},{responseHeaders:g,value:h}=await (0,d.GU)({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:(0,d.m2)(this.config.headers(),a.headers),body:f,failedResponseHandler:i,successfulResponseHandler:(0,d.Ds)(w),abortSignal:a.abortSignal,fetch:this.config.fetch}),l=[],m="unknown",n={inputTokens:void 0,outputTokens:void 0,totalTokens:void 0},o=!0,p=!1,q={openai:{}};return{stream:h.pipeThrough(new TransformStream({start(a){a.enqueue({type:"stream-start",warnings:c})},transform(b,c){var f,g,h,i,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K;if(a.includeRawChunks&&c.enqueue({type:"raw",rawValue:b.rawValue}),!b.success){m="error",c.enqueue({type:"error",error:b.error});return}let L=b.value;if("error"in L){m="error",c.enqueue({type:"error",error:L.error});return}o&&(o=!1,c.enqueue({type:"response-metadata",...j(L)})),null!=L.usage&&(n.inputTokens=null!=(f=L.usage.prompt_tokens)?f:void 0,n.outputTokens=null!=(g=L.usage.completion_tokens)?g:void 0,n.totalTokens=null!=(h=L.usage.total_tokens)?h:void 0,n.reasoningTokens=null!=(r=null==(i=L.usage.completion_tokens_details)?void 0:i.reasoning_tokens)?r:void 0,n.cachedInputTokens=null!=(t=null==(s=L.usage.prompt_tokens_details)?void 0:s.cached_tokens)?t:void 0,(null==(u=L.usage.completion_tokens_details)?void 0:u.accepted_prediction_tokens)!=null&&(q.openai.acceptedPredictionTokens=null==(v=L.usage.completion_tokens_details)?void 0:v.accepted_prediction_tokens),(null==(w=L.usage.completion_tokens_details)?void 0:w.rejected_prediction_tokens)!=null&&(q.openai.rejectedPredictionTokens=null==(x=L.usage.completion_tokens_details)?void 0:x.rejected_prediction_tokens));let M=L.choices[0];if((null==M?void 0:M.finish_reason)!=null&&(m=k(M.finish_reason)),(null==(y=null==M?void 0:M.logprobs)?void 0:y.content)!=null&&(q.openai.logprobs=M.logprobs.content),(null==M?void 0:M.delta)==null)return;let N=M.delta;if(null!=N.content&&(p||(c.enqueue({type:"text-start",id:"0"}),p=!0),c.enqueue({type:"text-delta",id:"0",delta:N.content})),null!=N.tool_calls)for(let a of N.tool_calls){let b=a.index;if(null==l[b]){if("function"!==a.type)throw new e.xn({data:a,message:"Expected 'function' type."});if(null==a.id)throw new e.xn({data:a,message:"Expected 'id' to be a string."});if((null==(z=a.function)?void 0:z.name)==null)throw new e.xn({data:a,message:"Expected 'function.name' to be a string."});c.enqueue({type:"tool-input-start",id:a.id,toolName:a.function.name}),l[b]={id:a.id,type:"function",function:{name:a.function.name,arguments:null!=(A=a.function.arguments)?A:""},hasFinished:!1};let f=l[b];(null==(B=f.function)?void 0:B.name)!=null&&(null==(C=f.function)?void 0:C.arguments)!=null&&(f.function.arguments.length>0&&c.enqueue({type:"tool-input-delta",id:f.id,delta:f.function.arguments}),(0,d.v0)(f.function.arguments)&&(c.enqueue({type:"tool-input-end",id:f.id}),c.enqueue({type:"tool-call",toolCallId:null!=(D=f.id)?D:(0,d.$C)(),toolName:f.function.name,input:f.function.arguments}),f.hasFinished=!0));continue}let f=l[b];!f.hasFinished&&((null==(E=a.function)?void 0:E.arguments)!=null&&(f.function.arguments+=null!=(G=null==(F=a.function)?void 0:F.arguments)?G:""),c.enqueue({type:"tool-input-delta",id:f.id,delta:null!=(H=a.function.arguments)?H:""}),(null==(I=f.function)?void 0:I.name)!=null&&(null==(J=f.function)?void 0:J.arguments)!=null&&(0,d.v0)(f.function.arguments)&&(c.enqueue({type:"tool-input-end",id:f.id}),c.enqueue({type:"tool-call",toolCallId:null!=(K=f.id)?K:(0,d.$C)(),toolName:f.function.name,input:f.function.arguments}),f.hasFinished=!0))}if(null!=N.annotations)for(let a of N.annotations)c.enqueue({type:"source",sourceType:"url",id:(0,d.$C)(),url:a.url,title:a.title})},flush(a){p&&a.enqueue({type:"text-end",id:"0"}),a.enqueue({type:"finish",finishReason:m,usage:n,...null!=q?{providerMetadata:q}:{}})}})),request:{body:f},response:{headers:g}}}},u=f.Ik({prompt_tokens:f.ai().nullish(),completion_tokens:f.ai().nullish(),total_tokens:f.ai().nullish(),prompt_tokens_details:f.Ik({cached_tokens:f.ai().nullish()}).nullish(),completion_tokens_details:f.Ik({reasoning_tokens:f.ai().nullish(),accepted_prediction_tokens:f.ai().nullish(),rejected_prediction_tokens:f.ai().nullish()}).nullish()}).nullish(),v=f.Ik({id:f.Yj().nullish(),created:f.ai().nullish(),model:f.Yj().nullish(),choices:f.YO(f.Ik({message:f.Ik({role:f.eu("assistant").nullish(),content:f.Yj().nullish(),tool_calls:f.YO(f.Ik({id:f.Yj().nullish(),type:f.eu("function"),function:f.Ik({name:f.Yj(),arguments:f.Yj()})})).nullish(),annotations:f.YO(f.Ik({type:f.eu("url_citation"),start_index:f.ai(),end_index:f.ai(),url:f.Yj(),title:f.Yj()})).nullish()}),index:f.ai(),logprobs:f.Ik({content:f.YO(f.Ik({token:f.Yj(),logprob:f.ai(),top_logprobs:f.YO(f.Ik({token:f.Yj(),logprob:f.ai()}))})).nullish()}).nullish(),finish_reason:f.Yj().nullish()})),usage:u}),w=f.KC([f.Ik({id:f.Yj().nullish(),created:f.ai().nullish(),model:f.Yj().nullish(),choices:f.YO(f.Ik({delta:f.Ik({role:f.k5(["assistant"]).nullish(),content:f.Yj().nullish(),tool_calls:f.YO(f.Ik({index:f.ai(),id:f.Yj().nullish(),type:f.eu("function").nullish(),function:f.Ik({name:f.Yj().nullish(),arguments:f.Yj().nullish()})})).nullish(),annotations:f.YO(f.Ik({type:f.eu("url_citation"),start_index:f.ai(),end_index:f.ai(),url:f.Yj(),title:f.Yj()})).nullish()}).nullish(),logprobs:f.Ik({content:f.YO(f.Ik({token:f.Yj(),logprob:f.ai(),top_logprobs:f.YO(f.Ik({token:f.Yj(),logprob:f.ai()}))})).nullish()}).nullish(),finish_reason:f.Yj().nullish(),index:f.ai()})),usage:u}),h]);function x(a){return(a.startsWith("o")||a.startsWith("gpt-5"))&&!a.startsWith("gpt-5-chat")}var y={"o1-mini":{systemMessageMode:"remove"},"o1-mini-2024-09-12":{systemMessageMode:"remove"},"o1-preview":{systemMessageMode:"remove"},"o1-preview-2024-09-12":{systemMessageMode:"remove"},o3:{systemMessageMode:"developer"},"o3-2025-04-16":{systemMessageMode:"developer"},"o3-mini":{systemMessageMode:"developer"},"o3-mini-2025-01-31":{systemMessageMode:"developer"},"o4-mini":{systemMessageMode:"developer"},"o4-mini-2025-04-16":{systemMessageMode:"developer"}};function z({id:a,model:b,created:c}){return{id:null!=a?a:void 0,modelId:null!=b?b:void 0,timestamp:null!=c?new Date(1e3*c):void 0}}function A(a){switch(a){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var B=f.Ik({echo:f.zM().optional(),logitBias:f.g1(f.Yj(),f.ai()).optional(),suffix:f.Yj().optional(),user:f.Yj().optional(),logprobs:f.KC([f.zM(),f.ai()]).optional()}),C=class{constructor(a,b){this.specificationVersion="v2",this.supportedUrls={},this.modelId=a,this.config=b}get providerOptionsName(){return this.config.provider.split(".")[0].trim()}get provider(){return this.config.provider}async getArgs({prompt:a,maxOutputTokens:b,temperature:c,topP:f,topK:g,frequencyPenalty:h,presencePenalty:i,stopSequences:j,responseFormat:k,tools:l,toolChoice:m,seed:n,providerOptions:o}){let p=[],q={...await (0,d.xI)({provider:"openai",providerOptions:o,schema:B}),...await (0,d.xI)({provider:this.providerOptionsName,providerOptions:o,schema:B})};null!=g&&p.push({type:"unsupported-setting",setting:"topK"}),(null==l?void 0:l.length)&&p.push({type:"unsupported-setting",setting:"tools"}),null!=m&&p.push({type:"unsupported-setting",setting:"toolChoice"}),null!=k&&"text"!==k.type&&p.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});let{prompt:r,stopSequences:s}=function({prompt:a,user:b="user",assistant:c="assistant"}){let d="";for(let{role:f,content:g}of("system"===a[0].role&&(d+=`${a[0].content}

`,a=a.slice(1)),a))switch(f){case"system":throw new e.M3({message:"Unexpected system message in prompt: ${content}",prompt:a});case"user":{let a=g.map(a=>{if("text"===a.type)return a.text}).filter(Boolean).join("");d+=`${b}:
${a}

`;break}case"assistant":{let a=g.map(a=>{switch(a.type){case"text":return a.text;case"tool-call":throw new e.b8({functionality:"tool-call messages"})}}).join("");d+=`${c}:
${a}

`;break}case"tool":throw new e.b8({functionality:"tool messages"});default:throw Error(`Unsupported role: ${f}`)}return{prompt:d+=`${c}:
`,stopSequences:[`
${b}:`]}}({prompt:a}),t=[...null!=s?s:[],...null!=j?j:[]];return{args:{model:this.modelId,echo:q.echo,logit_bias:q.logitBias,logprobs:(null==q?void 0:q.logprobs)===!0?0:(null==q?void 0:q.logprobs)===!1||null==q?void 0:q.logprobs,suffix:q.suffix,user:q.user,max_tokens:b,temperature:c,top_p:f,frequency_penalty:h,presence_penalty:i,seed:n,prompt:r,stop:t.length>0?t:void 0},warnings:p}}async doGenerate(a){var b,c,e;let{args:f,warnings:g}=await this.getArgs(a),{responseHeaders:h,value:j,rawValue:k}=await (0,d.GU)({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:(0,d.m2)(this.config.headers(),a.headers),body:f,failedResponseHandler:i,successfulResponseHandler:(0,d.cV)(E),abortSignal:a.abortSignal,fetch:this.config.fetch}),l=j.choices[0],m={openai:{}};return null!=l.logprobs&&(m.openai.logprobs=l.logprobs),{content:[{type:"text",text:l.text}],usage:{inputTokens:null==(b=j.usage)?void 0:b.prompt_tokens,outputTokens:null==(c=j.usage)?void 0:c.completion_tokens,totalTokens:null==(e=j.usage)?void 0:e.total_tokens},finishReason:A(l.finish_reason),request:{body:f},response:{...z(j),headers:h,body:k},providerMetadata:m,warnings:g}}async doStream(a){let{args:b,warnings:c}=await this.getArgs(a),e={...b,stream:!0,stream_options:{include_usage:!0}},{responseHeaders:f,value:g}=await (0,d.GU)({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:(0,d.m2)(this.config.headers(),a.headers),body:e,failedResponseHandler:i,successfulResponseHandler:(0,d.Ds)(F),abortSignal:a.abortSignal,fetch:this.config.fetch}),h="unknown",j={openai:{}},k={inputTokens:void 0,outputTokens:void 0,totalTokens:void 0},l=!0;return{stream:g.pipeThrough(new TransformStream({start(a){a.enqueue({type:"stream-start",warnings:c})},transform(b,c){if(a.includeRawChunks&&c.enqueue({type:"raw",rawValue:b.rawValue}),!b.success){h="error",c.enqueue({type:"error",error:b.error});return}let d=b.value;if("error"in d){h="error",c.enqueue({type:"error",error:d.error});return}l&&(l=!1,c.enqueue({type:"response-metadata",...z(d)}),c.enqueue({type:"text-start",id:"0"})),null!=d.usage&&(k.inputTokens=d.usage.prompt_tokens,k.outputTokens=d.usage.completion_tokens,k.totalTokens=d.usage.total_tokens);let e=d.choices[0];(null==e?void 0:e.finish_reason)!=null&&(h=A(e.finish_reason)),(null==e?void 0:e.logprobs)!=null&&(j.openai.logprobs=e.logprobs),(null==e?void 0:e.text)!=null&&e.text.length>0&&c.enqueue({type:"text-delta",id:"0",delta:e.text})},flush(a){l||a.enqueue({type:"text-end",id:"0"}),a.enqueue({type:"finish",finishReason:h,providerMetadata:j,usage:k})}})),request:{body:e},response:{headers:f}}}},D=f.Ik({prompt_tokens:f.ai(),completion_tokens:f.ai(),total_tokens:f.ai()}),E=f.Ik({id:f.Yj().nullish(),created:f.ai().nullish(),model:f.Yj().nullish(),choices:f.YO(f.Ik({text:f.Yj(),finish_reason:f.Yj(),logprobs:f.Ik({tokens:f.YO(f.Yj()),token_logprobs:f.YO(f.ai()),top_logprobs:f.YO(f.g1(f.Yj(),f.ai())).nullish()}).nullish()})),usage:D.nullish()}),F=f.KC([f.Ik({id:f.Yj().nullish(),created:f.ai().nullish(),model:f.Yj().nullish(),choices:f.YO(f.Ik({text:f.Yj(),finish_reason:f.Yj().nullish(),index:f.ai(),logprobs:f.Ik({tokens:f.YO(f.Yj()),token_logprobs:f.YO(f.ai()),top_logprobs:f.YO(f.g1(f.Yj(),f.ai())).nullish()}).nullish()})),usage:D.nullish()}),h]),G=f.Ik({dimensions:f.ai().optional(),user:f.Yj().optional()}),H=class{constructor(a,b){this.specificationVersion="v2",this.maxEmbeddingsPerCall=2048,this.supportsParallelCalls=!0,this.modelId=a,this.config=b}get provider(){return this.config.provider}async doEmbed({values:a,headers:b,abortSignal:c,providerOptions:f}){var g;if(a.length>this.maxEmbeddingsPerCall)throw new e.Ch({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:a});let h=null!=(g=await (0,d.xI)({provider:"openai",providerOptions:f,schema:G}))?g:{},{responseHeaders:j,value:k,rawValue:l}=await (0,d.GU)({url:this.config.url({path:"/embeddings",modelId:this.modelId}),headers:(0,d.m2)(this.config.headers(),b),body:{model:this.modelId,input:a,encoding_format:"float",dimensions:h.dimensions,user:h.user},failedResponseHandler:i,successfulResponseHandler:(0,d.cV)(I),abortSignal:c,fetch:this.config.fetch});return{embeddings:k.data.map(a=>a.embedding),usage:k.usage?{tokens:k.usage.prompt_tokens}:void 0,response:{headers:j,body:l}}}},I=f.Ik({data:f.YO(f.Ik({embedding:f.YO(f.ai())})),usage:f.Ik({prompt_tokens:f.ai()}).nullish()}),J={"dall-e-3":1,"dall-e-2":10,"gpt-image-1":10},K=new Set(["gpt-image-1"]),L=class{constructor(a,b){this.modelId=a,this.config=b,this.specificationVersion="v2"}get maxImagesPerCall(){var a;return null!=(a=J[this.modelId])?a:1}get provider(){return this.config.provider}async doGenerate({prompt:a,n:b,size:c,aspectRatio:e,seed:f,providerOptions:g,headers:h,abortSignal:j}){var k,l,m,n;let o=[];null!=e&&o.push({type:"unsupported-setting",setting:"aspectRatio",details:"This model does not support aspect ratio. Use `size` instead."}),null!=f&&o.push({type:"unsupported-setting",setting:"seed"});let p=null!=(m=null==(l=null==(k=this.config._internal)?void 0:k.currentDate)?void 0:l.call(k))?m:new Date,{value:q,responseHeaders:r}=await (0,d.GU)({url:this.config.url({path:"/images/generations",modelId:this.modelId}),headers:(0,d.m2)(this.config.headers(),h),body:{model:this.modelId,prompt:a,n:b,size:c,...null!=(n=g.openai)?n:{},...!K.has(this.modelId)?{response_format:"b64_json"}:{}},failedResponseHandler:i,successfulResponseHandler:(0,d.cV)(M),abortSignal:j,fetch:this.config.fetch});return{images:q.data.map(a=>a.b64_json),warnings:o,response:{timestamp:p,modelId:this.modelId,headers:r},providerMetadata:{openai:{images:q.data.map(a=>a.revised_prompt?{revisedPrompt:a.revised_prompt}:null)}}}}},M=f.Ik({data:f.YO(f.Ik({b64_json:f.Yj(),revised_prompt:f.Yj().optional()}))}),N=f.Ik({container:f.KC([f.Yj(),f.Ik({fileIds:f.YO(f.Yj()).optional()})]).optional()}),O={codeInterpreter:(0,d.hL)({id:"openai.code_interpreter",name:"code_interpreter",inputSchema:f.Ik({})}),fileSearch:q,webSearchPreview:s};function P(a,b){return!!b&&b.some(b=>a.startsWith(b))}async function Q({prompt:a,systemMessageMode:b,fileIdPrefixes:c}){var f,g,h,i,j,k;let l=[],m=[];for(let{role:n,content:o}of a)switch(n){case"system":switch(b){case"system":l.push({role:"system",content:o});break;case"developer":l.push({role:"developer",content:o});break;case"remove":m.push({type:"other",message:"system messages are removed for this model"});break;default:throw Error(`Unsupported system message mode: ${b}`)}break;case"user":l.push({role:"user",content:o.map((a,b)=>{var f,g,h;switch(a.type){case"text":return{type:"input_text",text:a.text};case"file":if(a.mediaType.startsWith("image/")){let b="image/*"===a.mediaType?"image/jpeg":a.mediaType;return{type:"input_image",...a.data instanceof URL?{image_url:a.data.toString()}:"string"==typeof a.data&&P(a.data,c)?{file_id:a.data}:{image_url:`data:${b};base64,${(0,d.ej)(a.data)}`},detail:null==(g=null==(f=a.providerOptions)?void 0:f.openai)?void 0:g.imageDetail}}if("application/pdf"===a.mediaType){if(a.data instanceof URL)throw new e.b8({functionality:"PDF file parts with URLs"});return{type:"input_file",..."string"==typeof a.data&&P(a.data,c)?{file_id:a.data}:{filename:null!=(h=a.filename)?h:`part-${b}.pdf`,file_data:`data:application/pdf;base64,${(0,d.ej)(a.data)}`}}}throw new e.b8({functionality:`file part media type ${a.mediaType}`})}})});break;case"assistant":{let a={};for(let b of o)switch(b.type){case"text":l.push({role:"assistant",content:[{type:"output_text",text:b.text}],id:null!=(h=null==(g=null==(f=b.providerOptions)?void 0:f.openai)?void 0:g.itemId)?h:void 0});break;case"tool-call":if(b.providerExecuted)break;l.push({type:"function_call",call_id:b.toolCallId,name:b.toolName,arguments:JSON.stringify(b.input),id:null!=(k=null==(j=null==(i=b.providerOptions)?void 0:i.openai)?void 0:j.itemId)?k:void 0});break;case"tool-result":m.push({type:"other",message:"tool result parts in assistant messages are not supported for OpenAI responses"});break;case"reasoning":{let c=await (0,d.xI)({provider:"openai",providerOptions:b.providerOptions,schema:R}),e=null==c?void 0:c.itemId;if(null!=e){let d=a[e],f=[];b.text.length>0?f.push({type:"summary_text",text:b.text}):void 0!==d&&m.push({type:"other",message:`Cannot append empty reasoning part to existing reasoning sequence. Skipping reasoning part: ${JSON.stringify(b)}.`}),void 0===d?(a[e]={type:"reasoning",id:e,encrypted_content:null==c?void 0:c.reasoningEncryptedContent,summary:f},l.push(a[e])):d.summary.push(...f)}else m.push({type:"other",message:`Non-OpenAI reasoning parts are not supported. Skipping reasoning part: ${JSON.stringify(b)}.`})}}break}case"tool":for(let a of o){let b,c=a.output;switch(c.type){case"text":case"error-text":b=c.value;break;case"content":case"json":case"error-json":b=JSON.stringify(c.value)}l.push({type:"function_call_output",call_id:a.toolCallId,output:b})}break;default:throw Error(`Unsupported role: ${n}`)}return{messages:l,warnings:m}}var R=f.Ik({itemId:f.Yj().nullish(),reasoningEncryptedContent:f.Yj().nullish()});function S({finishReason:a,hasToolCalls:b}){switch(a){case void 0:case null:return b?"tool-calls":"stop";case"max_output_tokens":return"length";case"content_filter":return"content-filter";default:return b?"tool-calls":"unknown"}}var T=f.YO(f.Ik({token:f.Yj(),logprob:f.ai(),top_logprobs:f.YO(f.Ik({token:f.Yj(),logprob:f.ai()}))})),U=class{constructor(a,b){this.specificationVersion="v2",this.supportedUrls={"image/*":[/^https?:\/\/.*$/]},this.modelId=a,this.config=b}get provider(){return this.config.provider}async getArgs({maxOutputTokens:a,temperature:b,stopSequences:c,topP:f,topK:g,presencePenalty:h,frequencyPenalty:i,seed:j,prompt:k,providerOptions:l,tools:m,toolChoice:n,responseFormat:o}){var q,s;let t=[],u=function(a){let b={requiredAutoTruncation:!1,systemMessageMode:"system",supportsFlexProcessing:a.startsWith("o3")||a.startsWith("o4-mini")||a.startsWith("gpt-5")&&!a.startsWith("gpt-5-chat"),supportsPriorityProcessing:a.startsWith("gpt-4")||a.startsWith("gpt-5-mini")||a.startsWith("gpt-5")&&!a.startsWith("gpt-5-nano")&&!a.startsWith("gpt-5-chat")||a.startsWith("o3")||a.startsWith("o4-mini")};return a.startsWith("gpt-5-chat")?{...b,isReasoningModel:!1}:a.startsWith("o")||a.startsWith("gpt-5")||a.startsWith("codex-")||a.startsWith("computer-use")?a.startsWith("o1-mini")||a.startsWith("o1-preview")?{...b,isReasoningModel:!0,systemMessageMode:"remove"}:{...b,isReasoningModel:!0,systemMessageMode:"developer"}:{...b,isReasoningModel:!1}}(this.modelId);null!=g&&t.push({type:"unsupported-setting",setting:"topK"}),null!=j&&t.push({type:"unsupported-setting",setting:"seed"}),null!=h&&t.push({type:"unsupported-setting",setting:"presencePenalty"}),null!=i&&t.push({type:"unsupported-setting",setting:"frequencyPenalty"}),null!=c&&t.push({type:"unsupported-setting",setting:"stopSequences"});let{messages:v,warnings:w}=await Q({prompt:k,systemMessageMode:u.systemMessageMode,fileIdPrefixes:this.config.fileIdPrefixes});t.push(...w);let x=await (0,d.xI)({provider:"openai",providerOptions:l,schema:ah}),y=null!=(q=null==x?void 0:x.strictJsonSchema)&&q,z="number"==typeof(null==x?void 0:x.logprobs)?null==x?void 0:x.logprobs:(null==x?void 0:x.logprobs)===!0?20:void 0,A=z?Array.isArray(null==x?void 0:x.include)?[...null==x?void 0:x.include,"message.output_text.logprobs"]:["message.output_text.logprobs"]:null==x?void 0:x.include,B={model:this.modelId,input:v,temperature:b,top_p:f,max_output_tokens:a,...((null==o?void 0:o.type)==="json"||(null==x?void 0:x.textVerbosity))&&{text:{...(null==o?void 0:o.type)==="json"&&{format:null!=o.schema?{type:"json_schema",strict:y,name:null!=(s=o.name)?s:"response",description:o.description,schema:o.schema}:{type:"json_object"}},...(null==x?void 0:x.textVerbosity)&&{verbosity:x.textVerbosity}}},metadata:null==x?void 0:x.metadata,parallel_tool_calls:null==x?void 0:x.parallelToolCalls,previous_response_id:null==x?void 0:x.previousResponseId,store:null==x?void 0:x.store,user:null==x?void 0:x.user,instructions:null==x?void 0:x.instructions,service_tier:null==x?void 0:x.serviceTier,include:A,prompt_cache_key:null==x?void 0:x.promptCacheKey,safety_identifier:null==x?void 0:x.safetyIdentifier,top_logprobs:z,...u.isReasoningModel&&((null==x?void 0:x.reasoningEffort)!=null||(null==x?void 0:x.reasoningSummary)!=null)&&{reasoning:{...(null==x?void 0:x.reasoningEffort)!=null&&{effort:x.reasoningEffort},...(null==x?void 0:x.reasoningSummary)!=null&&{summary:x.reasoningSummary}}},...u.requiredAutoTruncation&&{truncation:"auto"}};u.isReasoningModel?(null!=B.temperature&&(B.temperature=void 0,t.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),null!=B.top_p&&(B.top_p=void 0,t.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"}))):((null==x?void 0:x.reasoningEffort)!=null&&t.push({type:"unsupported-setting",setting:"reasoningEffort",details:"reasoningEffort is not supported for non-reasoning models"}),(null==x?void 0:x.reasoningSummary)!=null&&t.push({type:"unsupported-setting",setting:"reasoningSummary",details:"reasoningSummary is not supported for non-reasoning models"})),(null==x?void 0:x.serviceTier)!=="flex"||u.supportsFlexProcessing||(t.push({type:"unsupported-setting",setting:"serviceTier",details:"flex processing is only available for o3, o4-mini, and gpt-5 models"}),delete B.service_tier),(null==x?void 0:x.serviceTier)!=="priority"||u.supportsPriorityProcessing||(t.push({type:"unsupported-setting",setting:"serviceTier",details:"priority processing is only available for supported models (gpt-4, gpt-5, gpt-5-mini, o3, o4-mini) and requires Enterprise access. gpt-5-nano is not supported"}),delete B.service_tier);let{tools:C,toolChoice:D,toolWarnings:E}=function({tools:a,toolChoice:b,strictJsonSchema:c}){a=(null==a?void 0:a.length)?a:void 0;let d=[];if(null==a)return{tools:void 0,toolChoice:void 0,toolWarnings:d};let f=[];for(let b of a)switch(b.type){case"function":f.push({type:"function",name:b.name,description:b.description,parameters:b.inputSchema,strict:c});break;case"provider-defined":switch(b.id){case"openai.file_search":{let a=p.parse(b.args);f.push({type:"file_search",vector_store_ids:a.vectorStoreIds,max_num_results:a.maxNumResults,ranking_options:a.ranking?{ranker:a.ranking.ranker}:void 0,filters:a.filters});break}case"openai.web_search_preview":{let a=r.parse(b.args);f.push({type:"web_search_preview",search_context_size:a.searchContextSize,user_location:a.userLocation});break}case"openai.code_interpreter":{let a=N.parse(b.args);f.push({type:"code_interpreter",container:null==a.container?{type:"auto",file_ids:void 0}:"string"==typeof a.container?a.container:{type:"auto",file_ids:a.container.fileIds}});break}default:d.push({type:"unsupported-tool",tool:b})}break;default:d.push({type:"unsupported-tool",tool:b})}if(null==b)return{tools:f,toolChoice:void 0,toolWarnings:d};let g=b.type;switch(g){case"auto":case"none":case"required":return{tools:f,toolChoice:g,toolWarnings:d};case"tool":return{tools:f,toolChoice:"code_interpreter"===b.toolName||"file_search"===b.toolName||"web_search_preview"===b.toolName?{type:b.toolName}:{type:"function",name:b.toolName},toolWarnings:d};default:throw new e.b8({functionality:`tool choice type: ${g}`})}}({tools:m,toolChoice:n,strictJsonSchema:y});return{args:{...B,tools:C,tool_choice:D},warnings:[...t,...E]}}async doGenerate(a){var b,c,g,h,j,k,l,m,n,o,p,q,r,s,t,u,v;let{args:w,warnings:x}=await this.getArgs(a),y=this.config.url({path:"/responses",modelId:this.modelId}),{responseHeaders:z,value:A,rawValue:B}=await (0,d.GU)({url:y,headers:(0,d.m2)(this.config.headers(),a.headers),body:w,failedResponseHandler:i,successfulResponseHandler:(0,d.cV)(f.Ik({id:f.Yj(),created_at:f.ai(),error:f.Ik({code:f.Yj(),message:f.Yj()}).nullish(),model:f.Yj(),output:f.YO(f.gM("type",[f.Ik({type:f.eu("message"),role:f.eu("assistant"),id:f.Yj(),content:f.YO(f.Ik({type:f.eu("output_text"),text:f.Yj(),logprobs:T.nullish(),annotations:f.YO(f.gM("type",[f.Ik({type:f.eu("url_citation"),start_index:f.ai(),end_index:f.ai(),url:f.Yj(),title:f.Yj()}),f.Ik({type:f.eu("file_citation"),start_index:f.ai(),end_index:f.ai(),file_id:f.Yj(),quote:f.Yj()})]))}))}),f.Ik({type:f.eu("function_call"),call_id:f.Yj(),name:f.Yj(),arguments:f.Yj(),id:f.Yj()}),f.Ik({type:f.eu("web_search_call"),id:f.Yj(),status:f.Yj().optional(),action:f.Ik({type:f.eu("search"),query:f.Yj().optional()}).nullish()}),f.Ik({type:f.eu("computer_call"),id:f.Yj(),status:f.Yj().optional()}),f.Ik({type:f.eu("file_search_call"),id:f.Yj(),status:f.Yj().optional(),queries:f.YO(f.Yj()).nullish(),results:f.YO(f.Ik({attributes:f.Ik({file_id:f.Yj(),filename:f.Yj(),score:f.ai(),text:f.Yj()})})).nullish()}),f.Ik({type:f.eu("reasoning"),id:f.Yj(),encrypted_content:f.Yj().nullish(),summary:f.YO(f.Ik({type:f.eu("summary_text"),text:f.Yj()}))})])),incomplete_details:f.Ik({reason:f.Yj()}).nullable(),usage:V})),abortSignal:a.abortSignal,fetch:this.config.fetch});if(A.error)throw new e.hL({message:A.error.message,url:y,requestBodyValues:w,statusCode:400,responseHeaders:z,responseBody:B,isRetryable:!1});let C=[],D=[];for(let e of A.output)switch(e.type){case"reasoning":for(let a of(0===e.summary.length&&e.summary.push({type:"summary_text",text:""}),e.summary))C.push({type:"reasoning",text:a.text,providerMetadata:{openai:{itemId:e.id,reasoningEncryptedContent:null!=(b=e.encrypted_content)?b:null}}});break;case"message":for(let b of e.content)for(let f of((null==(g=null==(c=a.providerOptions)?void 0:c.openai)?void 0:g.logprobs)&&b.logprobs&&D.push(b.logprobs),C.push({type:"text",text:b.text,providerMetadata:{openai:{itemId:e.id}}}),b.annotations))"url_citation"===f.type?C.push({type:"source",sourceType:"url",id:null!=(k=null==(j=(h=this.config).generateId)?void 0:j.call(h))?k:(0,d.$C)(),url:f.url,title:f.title}):"file_citation"===f.type&&C.push({type:"source",sourceType:"document",id:null!=(n=null==(m=(l=this.config).generateId)?void 0:m.call(l))?n:(0,d.$C)(),mediaType:"text/plain",title:f.quote,filename:f.file_id});break;case"function_call":C.push({type:"tool-call",toolCallId:e.call_id,toolName:e.name,input:e.arguments,providerMetadata:{openai:{itemId:e.id}}});break;case"web_search_call":C.push({type:"tool-call",toolCallId:e.id,toolName:"web_search_preview",input:null!=(p=null==(o=e.action)?void 0:o.query)?p:"",providerExecuted:!0}),C.push({type:"tool-result",toolCallId:e.id,toolName:"web_search_preview",result:{status:e.status||"completed",...(null==(q=e.action)?void 0:q.query)&&{query:e.action.query}},providerExecuted:!0});break;case"computer_call":C.push({type:"tool-call",toolCallId:e.id,toolName:"computer_use",input:"",providerExecuted:!0}),C.push({type:"tool-result",toolCallId:e.id,toolName:"computer_use",result:{type:"computer_use_tool_result",status:e.status||"completed"},providerExecuted:!0});break;case"file_search_call":C.push({type:"tool-call",toolCallId:e.id,toolName:"file_search",input:"",providerExecuted:!0}),C.push({type:"tool-result",toolCallId:e.id,toolName:"file_search",result:{type:"file_search_tool_result",status:e.status||"completed",...e.queries&&{queries:e.queries},...e.results&&{results:e.results}},providerExecuted:!0})}let E={openai:{responseId:A.id}};return D.length>0&&(E.openai.logprobs=D),{content:C,finishReason:S({finishReason:null==(r=A.incomplete_details)?void 0:r.reason,hasToolCalls:C.some(a=>"tool-call"===a.type)}),usage:{inputTokens:A.usage.input_tokens,outputTokens:A.usage.output_tokens,totalTokens:A.usage.input_tokens+A.usage.output_tokens,reasoningTokens:null!=(t=null==(s=A.usage.output_tokens_details)?void 0:s.reasoning_tokens)?t:void 0,cachedInputTokens:null!=(v=null==(u=A.usage.input_tokens_details)?void 0:u.cached_tokens)?v:void 0},request:{body:w},response:{id:A.id,timestamp:new Date(1e3*A.created_at),modelId:A.model,headers:z,body:B},providerMetadata:E,warnings:x}}async doStream(a){let{args:b,warnings:c}=await this.getArgs(a),{responseHeaders:e,value:f}=await (0,d.GU)({url:this.config.url({path:"/responses",modelId:this.modelId}),headers:(0,d.m2)(this.config.headers(),a.headers),body:{...b,stream:!0},failedResponseHandler:i,successfulResponseHandler:(0,d.Ds)(ae),abortSignal:a.abortSignal,fetch:this.config.fetch}),g=this,h="unknown",j={inputTokens:void 0,outputTokens:void 0,totalTokens:void 0},k=[],l=null,m={},n=!1,o={};return{stream:f.pipeThrough(new TransformStream({start(a){a.enqueue({type:"stream-start",warnings:c})},transform(b,c){var e,f,i,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H;if(a.includeRawChunks&&c.enqueue({type:"raw",rawValue:b.rawValue}),!b.success){h="error",c.enqueue({type:"error",error:b.error});return}let I=b.value;if(ag(I)){"function_call"===I.item.type?(m[I.output_index]={toolName:I.item.name,toolCallId:I.item.call_id},c.enqueue({type:"tool-input-start",id:I.item.call_id,toolName:I.item.name})):"web_search_call"===I.item.type?(m[I.output_index]={toolName:"web_search_preview",toolCallId:I.item.id},c.enqueue({type:"tool-input-start",id:I.item.id,toolName:"web_search_preview"})):"computer_call"===I.item.type?(m[I.output_index]={toolName:"computer_use",toolCallId:I.item.id},c.enqueue({type:"tool-input-start",id:I.item.id,toolName:"computer_use"})):"file_search_call"===I.item.type?(m[I.output_index]={toolName:"file_search",toolCallId:I.item.id},c.enqueue({type:"tool-input-start",id:I.item.id,toolName:"file_search"})):"message"===I.item.type?c.enqueue({type:"text-start",id:I.item.id,providerMetadata:{openai:{itemId:I.item.id}}}):ag(F=I)&&"reasoning"===F.item.type&&(o[I.item.id]={encryptedContent:I.item.encrypted_content,summaryParts:[0]},c.enqueue({type:"reasoning-start",id:`${I.item.id}:0`,providerMetadata:{openai:{itemId:I.item.id,reasoningEncryptedContent:null!=(e=I.item.encrypted_content)?e:null}}}))}else if(af(I))if("function_call"===I.item.type)m[I.output_index]=void 0,n=!0,c.enqueue({type:"tool-input-end",id:I.item.call_id}),c.enqueue({type:"tool-call",toolCallId:I.item.call_id,toolName:I.item.name,input:I.item.arguments,providerMetadata:{openai:{itemId:I.item.id}}});else if("web_search_call"===I.item.type)m[I.output_index]=void 0,n=!0,c.enqueue({type:"tool-input-end",id:I.item.id}),c.enqueue({type:"tool-call",toolCallId:I.item.id,toolName:"web_search_preview",input:null!=(i=null==(f=I.item.action)?void 0:f.query)?i:"",providerExecuted:!0}),c.enqueue({type:"tool-result",toolCallId:I.item.id,toolName:"web_search_preview",result:{type:"web_search_tool_result",status:I.item.status||"completed",...(null==(p=I.item.action)?void 0:p.query)&&{query:I.item.action.query}},providerExecuted:!0});else if("computer_call"===I.item.type)m[I.output_index]=void 0,n=!0,c.enqueue({type:"tool-input-end",id:I.item.id}),c.enqueue({type:"tool-call",toolCallId:I.item.id,toolName:"computer_use",input:"",providerExecuted:!0}),c.enqueue({type:"tool-result",toolCallId:I.item.id,toolName:"computer_use",result:{type:"computer_use_tool_result",status:I.item.status||"completed"},providerExecuted:!0});else if("file_search_call"===I.item.type)m[I.output_index]=void 0,n=!0,c.enqueue({type:"tool-input-end",id:I.item.id}),c.enqueue({type:"tool-call",toolCallId:I.item.id,toolName:"file_search",input:"",providerExecuted:!0}),c.enqueue({type:"tool-result",toolCallId:I.item.id,toolName:"file_search",result:{type:"file_search_tool_result",status:I.item.status||"completed",...I.item.queries&&{queries:I.item.queries},...I.item.results&&{results:I.item.results}},providerExecuted:!0});else if("message"===I.item.type)c.enqueue({type:"text-end",id:I.item.id});else{if(af(G=I)&&"reasoning"===G.item.type){for(let a of o[I.item.id].summaryParts)c.enqueue({type:"reasoning-end",id:`${I.item.id}:${a}`,providerMetadata:{openai:{itemId:I.item.id,reasoningEncryptedContent:null!=(q=I.item.encrypted_content)?q:null}}});delete o[I.item.id]}}else if("response.function_call_arguments.delta"===I.type){let a=m[I.output_index];null!=a&&c.enqueue({type:"tool-input-delta",id:a.toolCallId,delta:I.delta})}else{"response.created"===I.type?(l=I.response.id,c.enqueue({type:"response-metadata",id:I.response.id,timestamp:new Date(1e3*I.response.created_at),modelId:I.response.model})):"response.output_text.delta"===I.type?(c.enqueue({type:"text-delta",id:I.item_id,delta:I.delta}),I.logprobs&&k.push(I.logprobs)):"response.reasoning_summary_part.added"===I.type?I.summary_index>0&&(null==(r=o[I.item_id])||r.summaryParts.push(I.summary_index),c.enqueue({type:"reasoning-start",id:`${I.item_id}:${I.summary_index}`,providerMetadata:{openai:{itemId:I.item_id,reasoningEncryptedContent:null!=(t=null==(s=o[I.item_id])?void 0:s.encryptedContent)?t:null}}})):"response.reasoning_summary_text.delta"===I.type?c.enqueue({type:"reasoning-delta",id:`${I.item_id}:${I.summary_index}`,delta:I.delta,providerMetadata:{openai:{itemId:I.item_id}}}):"response.completed"===(H=I).type||"response.incomplete"===H.type?(h=S({finishReason:null==(u=I.response.incomplete_details)?void 0:u.reason,hasToolCalls:n}),j.inputTokens=I.response.usage.input_tokens,j.outputTokens=I.response.usage.output_tokens,j.totalTokens=I.response.usage.input_tokens+I.response.usage.output_tokens,j.reasoningTokens=null!=(w=null==(v=I.response.usage.output_tokens_details)?void 0:v.reasoning_tokens)?w:void 0,j.cachedInputTokens=null!=(y=null==(x=I.response.usage.input_tokens_details)?void 0:x.cached_tokens)?y:void 0):"response.output_text.annotation.added"===I.type?"url_citation"===I.annotation.type?c.enqueue({type:"source",sourceType:"url",id:null!=(B=null==(A=(z=g.config).generateId)?void 0:A.call(z))?B:(0,d.$C)(),url:I.annotation.url,title:I.annotation.title}):"file_citation"===I.annotation.type&&c.enqueue({type:"source",sourceType:"document",id:null!=(E=null==(D=(C=g.config).generateId)?void 0:D.call(C))?E:(0,d.$C)(),mediaType:"text/plain",title:I.annotation.quote,filename:I.annotation.file_id}):"error"===I.type&&c.enqueue({type:"error",error:I})}},flush(a){let b={openai:{responseId:l}};k.length>0&&(b.openai.logprobs=k),a.enqueue({type:"finish",finishReason:h,usage:j,providerMetadata:b})}})),request:{body:b},response:{headers:e}}}},V=f.Ik({input_tokens:f.ai(),input_tokens_details:f.Ik({cached_tokens:f.ai().nullish()}).nullish(),output_tokens:f.ai(),output_tokens_details:f.Ik({reasoning_tokens:f.ai().nullish()}).nullish()}),W=f.Ik({type:f.eu("response.output_text.delta"),item_id:f.Yj(),delta:f.Yj(),logprobs:T.nullish()}),X=f.Ik({type:f.eu("error"),code:f.Yj(),message:f.Yj(),param:f.Yj().nullish(),sequence_number:f.ai()}),Y=f.Ik({type:f.k5(["response.completed","response.incomplete"]),response:f.Ik({incomplete_details:f.Ik({reason:f.Yj()}).nullish(),usage:V})}),Z=f.Ik({type:f.eu("response.created"),response:f.Ik({id:f.Yj(),created_at:f.ai(),model:f.Yj()})}),$=f.Ik({type:f.eu("response.output_item.added"),output_index:f.ai(),item:f.gM("type",[f.Ik({type:f.eu("message"),id:f.Yj()}),f.Ik({type:f.eu("reasoning"),id:f.Yj(),encrypted_content:f.Yj().nullish()}),f.Ik({type:f.eu("function_call"),id:f.Yj(),call_id:f.Yj(),name:f.Yj(),arguments:f.Yj()}),f.Ik({type:f.eu("web_search_call"),id:f.Yj(),status:f.Yj(),action:f.Ik({type:f.eu("search"),query:f.Yj().optional()}).nullish()}),f.Ik({type:f.eu("computer_call"),id:f.Yj(),status:f.Yj()}),f.Ik({type:f.eu("file_search_call"),id:f.Yj(),status:f.Yj(),queries:f.YO(f.Yj()).nullish(),results:f.YO(f.Ik({attributes:f.Ik({file_id:f.Yj(),filename:f.Yj(),score:f.ai(),text:f.Yj()})})).optional()})])}),_=f.Ik({type:f.eu("response.output_item.done"),output_index:f.ai(),item:f.gM("type",[f.Ik({type:f.eu("message"),id:f.Yj()}),f.Ik({type:f.eu("reasoning"),id:f.Yj(),encrypted_content:f.Yj().nullish()}),f.Ik({type:f.eu("function_call"),id:f.Yj(),call_id:f.Yj(),name:f.Yj(),arguments:f.Yj(),status:f.eu("completed")}),f.Ik({type:f.eu("web_search_call"),id:f.Yj(),status:f.eu("completed"),action:f.Ik({type:f.eu("search"),query:f.Yj().optional()}).nullish()}),f.Ik({type:f.eu("computer_call"),id:f.Yj(),status:f.eu("completed")}),f.Ik({type:f.eu("file_search_call"),id:f.Yj(),status:f.eu("completed"),queries:f.YO(f.Yj()).nullish(),results:f.YO(f.Ik({attributes:f.Ik({file_id:f.Yj(),filename:f.Yj(),score:f.ai(),text:f.Yj()})})).nullish()})])}),aa=f.Ik({type:f.eu("response.function_call_arguments.delta"),item_id:f.Yj(),output_index:f.ai(),delta:f.Yj()}),ab=f.Ik({type:f.eu("response.output_text.annotation.added"),annotation:f.gM("type",[f.Ik({type:f.eu("url_citation"),url:f.Yj(),title:f.Yj()}),f.Ik({type:f.eu("file_citation"),file_id:f.Yj(),quote:f.Yj()})])}),ac=f.Ik({type:f.eu("response.reasoning_summary_part.added"),item_id:f.Yj(),summary_index:f.ai()}),ad=f.Ik({type:f.eu("response.reasoning_summary_text.delta"),item_id:f.Yj(),summary_index:f.ai(),delta:f.Yj()}),ae=f.KC([W,Y,Z,$,_,aa,ab,ac,ad,X,f.Ik({type:f.Yj()}).loose()]);function af(a){return"response.output_item.done"===a.type}function ag(a){return"response.output_item.added"===a.type}var ah=f.Ik({metadata:f.bz().nullish(),parallelToolCalls:f.zM().nullish(),previousResponseId:f.Yj().nullish(),store:f.zM().nullish(),user:f.Yj().nullish(),reasoningEffort:f.Yj().nullish(),strictJsonSchema:f.zM().nullish(),instructions:f.Yj().nullish(),reasoningSummary:f.Yj().nullish(),serviceTier:f.k5(["auto","flex","priority"]).nullish(),include:f.YO(f.k5(["reasoning.encrypted_content","file_search_call.results","message.output_text.logprobs"])).nullish(),textVerbosity:f.k5(["low","medium","high"]).nullish(),promptCacheKey:f.Yj().nullish(),safetyIdentifier:f.Yj().nullish(),logprobs:f.KC([f.zM(),f.ai().min(1).max(20)]).optional()}),ai=f.Ik({instructions:f.Yj().nullish(),speed:f.ai().min(.25).max(4).default(1).nullish()}),aj=class{constructor(a,b){this.modelId=a,this.config=b,this.specificationVersion="v2"}get provider(){return this.config.provider}async getArgs({text:a,voice:b="alloy",outputFormat:c="mp3",speed:e,instructions:f,language:g,providerOptions:h}){let i=[],j=await (0,d.xI)({provider:"openai",providerOptions:h,schema:ai}),k={model:this.modelId,input:a,voice:b,response_format:"mp3",speed:e,instructions:f};if(c&&(["mp3","opus","aac","flac","wav","pcm"].includes(c)?k.response_format=c:i.push({type:"unsupported-setting",setting:"outputFormat",details:`Unsupported output format: ${c}. Using mp3 instead.`})),j){let a={};for(let b in a){let c=a[b];void 0!==c&&(k[b]=c)}}return g&&i.push({type:"unsupported-setting",setting:"language",details:`OpenAI speech models do not support language selection. Language parameter "${g}" was ignored.`}),{requestBody:k,warnings:i}}async doGenerate(a){var b,c,e;let f=null!=(e=null==(c=null==(b=this.config._internal)?void 0:b.currentDate)?void 0:c.call(b))?e:new Date,{requestBody:g,warnings:h}=await this.getArgs(a),{value:j,responseHeaders:k,rawValue:l}=await (0,d.GU)({url:this.config.url({path:"/audio/speech",modelId:this.modelId}),headers:(0,d.m2)(this.config.headers(),a.headers),body:g,failedResponseHandler:i,successfulResponseHandler:(0,d.HD)(),abortSignal:a.abortSignal,fetch:this.config.fetch});return{audio:j,warnings:h,request:{body:JSON.stringify(g)},response:{timestamp:f,modelId:this.modelId,headers:k,body:l}}}},ak=f.Ik({include:f.YO(f.Yj()).optional(),language:f.Yj().optional(),prompt:f.Yj().optional(),temperature:f.ai().min(0).max(1).default(0).optional(),timestampGranularities:f.YO(f.k5(["word","segment"])).default(["segment"]).optional()}),al={afrikaans:"af",arabic:"ar",armenian:"hy",azerbaijani:"az",belarusian:"be",bosnian:"bs",bulgarian:"bg",catalan:"ca",chinese:"zh",croatian:"hr",czech:"cs",danish:"da",dutch:"nl",english:"en",estonian:"et",finnish:"fi",french:"fr",galician:"gl",german:"de",greek:"el",hebrew:"he",hindi:"hi",hungarian:"hu",icelandic:"is",indonesian:"id",italian:"it",japanese:"ja",kannada:"kn",kazakh:"kk",korean:"ko",latvian:"lv",lithuanian:"lt",macedonian:"mk",malay:"ms",marathi:"mr",maori:"mi",nepali:"ne",norwegian:"no",persian:"fa",polish:"pl",portuguese:"pt",romanian:"ro",russian:"ru",serbian:"sr",slovak:"sk",slovenian:"sl",spanish:"es",swahili:"sw",swedish:"sv",tagalog:"tl",tamil:"ta",thai:"th",turkish:"tr",ukrainian:"uk",urdu:"ur",vietnamese:"vi",welsh:"cy"},am=class{constructor(a,b){this.modelId=a,this.config=b,this.specificationVersion="v2"}get provider(){return this.config.provider}async getArgs({audio:a,mediaType:b,providerOptions:c}){let e=await (0,d.xI)({provider:"openai",providerOptions:c,schema:ak}),f=new FormData,g=a instanceof Uint8Array?new Blob([a]):new Blob([(0,d.Z9)(a)]);if(f.append("model",this.modelId),f.append("file",new File([g],"audio",{type:b})),e)for(let[a,b]of Object.entries({include:e.include,language:e.language,prompt:e.prompt,response_format:"verbose_json",temperature:e.temperature,timestamp_granularities:e.timestampGranularities}))null!=b&&f.append(a,String(b));return{formData:f,warnings:[]}}async doGenerate(a){var b,c,e,f,g,h,j,k;let l=null!=(e=null==(c=null==(b=this.config._internal)?void 0:b.currentDate)?void 0:c.call(b))?e:new Date,{formData:m,warnings:n}=await this.getArgs(a),{value:o,responseHeaders:p,rawValue:q}=await (0,d.S)({url:this.config.url({path:"/audio/transcriptions",modelId:this.modelId}),headers:(0,d.m2)(this.config.headers(),a.headers),formData:m,failedResponseHandler:i,successfulResponseHandler:(0,d.cV)(an),abortSignal:a.abortSignal,fetch:this.config.fetch}),r=null!=o.language&&o.language in al?al[o.language]:void 0;return{text:o.text,segments:null!=(j=null!=(h=null==(f=o.segments)?void 0:f.map(a=>({text:a.text,startSecond:a.start,endSecond:a.end})))?h:null==(g=o.words)?void 0:g.map(a=>({text:a.word,startSecond:a.start,endSecond:a.end})))?j:[],language:r,durationInSeconds:null!=(k=o.duration)?k:void 0,warnings:n,response:{timestamp:l,modelId:this.modelId,headers:p,body:q}}}},an=f.Ik({text:f.Yj(),language:f.Yj().nullish(),duration:f.ai().nullish(),words:f.YO(f.Ik({word:f.Yj(),start:f.ai(),end:f.ai()})).nullish(),segments:f.YO(f.Ik({id:f.ai(),seek:f.ai(),start:f.ai(),end:f.ai(),text:f.Yj(),tokens:f.YO(f.ai()),temperature:f.ai(),avg_logprob:f.ai(),compression_ratio:f.ai(),no_speech_prob:f.ai()})).nullish()}),ao=function(a={}){var b,c;let e=null!=(b=(0,d.ae)(a.baseURL))?b:"https://api.openai.com/v1",f=null!=(c=a.name)?c:"openai",g=()=>({Authorization:`Bearer ${(0,d.WL)({apiKey:a.apiKey,environmentVariableName:"OPENAI_API_KEY",description:"OpenAI"})}`,"OpenAI-Organization":a.organization,"OpenAI-Project":a.project,...a.headers}),h=b=>new H(b,{provider:`${f}.embedding`,url:({path:a})=>`${e}${a}`,headers:g,fetch:a.fetch}),i=b=>new L(b,{provider:`${f}.image`,url:({path:a})=>`${e}${a}`,headers:g,fetch:a.fetch}),j=b=>new am(b,{provider:`${f}.transcription`,url:({path:a})=>`${e}${a}`,headers:g,fetch:a.fetch}),k=b=>new aj(b,{provider:`${f}.speech`,url:({path:a})=>`${e}${a}`,headers:g,fetch:a.fetch}),l=a=>{if(new.target)throw Error("The OpenAI model function cannot be called with the new keyword.");return m(a)},m=b=>new U(b,{provider:`${f}.responses`,url:({path:a})=>`${e}${a}`,headers:g,fetch:a.fetch,fileIdPrefixes:["file-"]}),n=function(a){return l(a)};return n.languageModel=l,n.chat=b=>new t(b,{provider:`${f}.chat`,url:({path:a})=>`${e}${a}`,headers:g,fetch:a.fetch}),n.completion=b=>new C(b,{provider:`${f}.completion`,url:({path:a})=>`${e}${a}`,headers:g,fetch:a.fetch}),n.responses=m,n.embedding=h,n.textEmbedding=h,n.textEmbeddingModel=h,n.image=i,n.imageModel=i,n.transcription=j,n.transcriptionModel=j,n.speech=k,n.speechModel=k,n.tools=O,n}()},29979:(a,b,c)=>{c.d(b,{DG:()=>q,E6:()=>v,J:()=>u,J_:()=>j,Jk:()=>k,KH:()=>l,Kk:()=>n,NI:()=>r,QP:()=>g,RM:()=>o,Tt:()=>t,Yk:()=>m,kH:()=>s,ql:()=>p,sm:()=>i,v$:()=>w});var d=c(41725),e=c(44667),f=c(13602);let g=d.xI("$ZodCheck",(a,b)=>{var c;a._zod??(a._zod={}),a._zod.def=b,(c=a._zod).onattach??(c.onattach=[])}),h={number:"number",bigint:"bigint",object:"date"},i=d.xI("$ZodCheckLessThan",(a,b)=>{g.init(a,b);let c=h[typeof b.value];a._zod.onattach.push(a=>{let c=a._zod.bag,d=(b.inclusive?c.maximum:c.exclusiveMaximum)??1/0;b.value<d&&(b.inclusive?c.maximum=b.value:c.exclusiveMaximum=b.value)}),a._zod.check=d=>{(b.inclusive?d.value<=b.value:d.value<b.value)||d.issues.push({origin:c,code:"too_big",maximum:b.value,input:d.value,inclusive:b.inclusive,inst:a,continue:!b.abort})}}),j=d.xI("$ZodCheckGreaterThan",(a,b)=>{g.init(a,b);let c=h[typeof b.value];a._zod.onattach.push(a=>{let c=a._zod.bag,d=(b.inclusive?c.minimum:c.exclusiveMinimum)??-1/0;b.value>d&&(b.inclusive?c.minimum=b.value:c.exclusiveMinimum=b.value)}),a._zod.check=d=>{(b.inclusive?d.value>=b.value:d.value>b.value)||d.issues.push({origin:c,code:"too_small",minimum:b.value,input:d.value,inclusive:b.inclusive,inst:a,continue:!b.abort})}}),k=d.xI("$ZodCheckMultipleOf",(a,b)=>{g.init(a,b),a._zod.onattach.push(a=>{var c;(c=a._zod.bag).multipleOf??(c.multipleOf=b.value)}),a._zod.check=c=>{if(typeof c.value!=typeof b.value)throw Error("Cannot mix number and bigint in multiple_of check.");("bigint"==typeof c.value?c.value%b.value===BigInt(0):0===f.LG(c.value,b.value))||c.issues.push({origin:typeof c.value,code:"not_multiple_of",divisor:b.value,input:c.value,inst:a,continue:!b.abort})}}),l=d.xI("$ZodCheckNumberFormat",(a,b)=>{g.init(a,b),b.format=b.format||"float64";let c=b.format?.includes("int"),d=c?"int":"number",[h,i]=f.zH[b.format];a._zod.onattach.push(a=>{let d=a._zod.bag;d.format=b.format,d.minimum=h,d.maximum=i,c&&(d.pattern=e.nd)}),a._zod.check=e=>{let f=e.value;if(c){if(!Number.isInteger(f))return void e.issues.push({expected:d,format:b.format,code:"invalid_type",input:f,inst:a});if(!Number.isSafeInteger(f))return void(f>0?e.issues.push({input:f,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:a,origin:d,continue:!b.abort}):e.issues.push({input:f,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:a,origin:d,continue:!b.abort}))}f<h&&e.issues.push({origin:"number",input:f,code:"too_small",minimum:h,inclusive:!0,inst:a,continue:!b.abort}),f>i&&e.issues.push({origin:"number",input:f,code:"too_big",maximum:i,inst:a})}}),m=d.xI("$ZodCheckMaxLength",(a,b)=>{var c;g.init(a,b),(c=a._zod.def).when??(c.when=a=>{let b=a.value;return!f.cl(b)&&void 0!==b.length}),a._zod.onattach.push(a=>{let c=a._zod.bag.maximum??1/0;b.maximum<c&&(a._zod.bag.maximum=b.maximum)}),a._zod.check=c=>{let d=c.value;if(d.length<=b.maximum)return;let e=f.Rc(d);c.issues.push({origin:e,code:"too_big",maximum:b.maximum,inclusive:!0,input:d,inst:a,continue:!b.abort})}}),n=d.xI("$ZodCheckMinLength",(a,b)=>{var c;g.init(a,b),(c=a._zod.def).when??(c.when=a=>{let b=a.value;return!f.cl(b)&&void 0!==b.length}),a._zod.onattach.push(a=>{let c=a._zod.bag.minimum??-1/0;b.minimum>c&&(a._zod.bag.minimum=b.minimum)}),a._zod.check=c=>{let d=c.value;if(d.length>=b.minimum)return;let e=f.Rc(d);c.issues.push({origin:e,code:"too_small",minimum:b.minimum,inclusive:!0,input:d,inst:a,continue:!b.abort})}}),o=d.xI("$ZodCheckLengthEquals",(a,b)=>{var c;g.init(a,b),(c=a._zod.def).when??(c.when=a=>{let b=a.value;return!f.cl(b)&&void 0!==b.length}),a._zod.onattach.push(a=>{let c=a._zod.bag;c.minimum=b.length,c.maximum=b.length,c.length=b.length}),a._zod.check=c=>{let d=c.value,e=d.length;if(e===b.length)return;let g=f.Rc(d),h=e>b.length;c.issues.push({origin:g,...h?{code:"too_big",maximum:b.length}:{code:"too_small",minimum:b.length},inclusive:!0,exact:!0,input:c.value,inst:a,continue:!b.abort})}}),p=d.xI("$ZodCheckStringFormat",(a,b)=>{var c,d;g.init(a,b),a._zod.onattach.push(a=>{let c=a._zod.bag;c.format=b.format,b.pattern&&(c.patterns??(c.patterns=new Set),c.patterns.add(b.pattern))}),b.pattern?(c=a._zod).check??(c.check=c=>{b.pattern.lastIndex=0,b.pattern.test(c.value)||c.issues.push({origin:"string",code:"invalid_format",format:b.format,input:c.value,...b.pattern?{pattern:b.pattern.toString()}:{},inst:a,continue:!b.abort})}):(d=a._zod).check??(d.check=()=>{})}),q=d.xI("$ZodCheckRegex",(a,b)=>{p.init(a,b),a._zod.check=c=>{b.pattern.lastIndex=0,b.pattern.test(c.value)||c.issues.push({origin:"string",code:"invalid_format",format:"regex",input:c.value,pattern:b.pattern.toString(),inst:a,continue:!b.abort})}}),r=d.xI("$ZodCheckLowerCase",(a,b)=>{b.pattern??(b.pattern=e.AC),p.init(a,b)}),s=d.xI("$ZodCheckUpperCase",(a,b)=>{b.pattern??(b.pattern=e.Zv),p.init(a,b)}),t=d.xI("$ZodCheckIncludes",(a,b)=>{g.init(a,b);let c=f.$f(b.includes),d=new RegExp("number"==typeof b.position?`^.{${b.position}}${c}`:c);b.pattern=d,a._zod.onattach.push(a=>{let b=a._zod.bag;b.patterns??(b.patterns=new Set),b.patterns.add(d)}),a._zod.check=c=>{c.value.includes(b.includes,b.position)||c.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:b.includes,input:c.value,inst:a,continue:!b.abort})}}),u=d.xI("$ZodCheckStartsWith",(a,b)=>{g.init(a,b);let c=RegExp(`^${f.$f(b.prefix)}.*`);b.pattern??(b.pattern=c),a._zod.onattach.push(a=>{let b=a._zod.bag;b.patterns??(b.patterns=new Set),b.patterns.add(c)}),a._zod.check=c=>{c.value.startsWith(b.prefix)||c.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:b.prefix,input:c.value,inst:a,continue:!b.abort})}}),v=d.xI("$ZodCheckEndsWith",(a,b)=>{g.init(a,b);let c=RegExp(`.*${f.$f(b.suffix)}$`);b.pattern??(b.pattern=c),a._zod.onattach.push(a=>{let b=a._zod.bag;b.patterns??(b.patterns=new Set),b.patterns.add(c)}),a._zod.check=c=>{c.value.endsWith(b.suffix)||c.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:b.suffix,input:c.value,inst:a,continue:!b.abort})}}),w=d.xI("$ZodCheckOverwrite",(a,b)=>{g.init(a,b),a._zod.check=a=>{a.value=b.tx(a.value)}})},41725:(a,b,c)=>{function d(a,b,c){function d(c,d){var e;for(let f in Object.defineProperty(c,"_zod",{value:c._zod??{},enumerable:!1}),(e=c._zod).traits??(e.traits=new Set),c._zod.traits.add(a),b(c,d),g.prototype)f in c||Object.defineProperty(c,f,{value:g.prototype[f].bind(c)});c._zod.constr=g,c._zod.def=d}let e=c?.Parent??Object;class f extends e{}function g(a){var b;let e=c?.Parent?new f:this;for(let c of(d(e,a),(b=e._zod).deferred??(b.deferred=[]),e._zod.deferred))c();return e}return Object.defineProperty(f,"name",{value:a}),Object.defineProperty(g,"init",{value:d}),Object.defineProperty(g,Symbol.hasInstance,{value:b=>!!c?.Parent&&b instanceof c.Parent||b?._zod?.traits?.has(a)}),Object.defineProperty(g,"name",{value:a}),g}c.d(b,{$W:()=>g,GT:()=>e,cr:()=>f,xI:()=>d}),Object.freeze({status:"aborted"}),Symbol("zod_brand");class e extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}let f={};function g(a){return a&&Object.assign(f,a),f}},44667:(a,b,c)=>{c.d(b,{AC:()=>G,Ak:()=>i,Gl:()=>e,K3:()=>s,OI:()=>u,Os:()=>k,Rp:()=>m,Yj:()=>B,Z0:()=>f,Zg:()=>n,Zv:()=>H,ai:()=>D,ch:()=>F,fO:()=>h,gF:()=>d,hQ:()=>v,kB:()=>z,kM:()=>g,l7:()=>r,nd:()=>C,p0:()=>j,p6:()=>x,r0:()=>t,uR:()=>l,uX:()=>o,ug:()=>p,w$:()=>A,zM:()=>E,zr:()=>q});let d=/^[cC][^\s-]{8,}$/,e=/^[0-9a-z]+$/,f=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,g=/^[0-9a-vA-V]{20}$/,h=/^[A-Za-z0-9]{27}$/,i=/^[a-zA-Z0-9_-]{21}$/,j=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,k=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,l=a=>a?RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${a}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000)$/,m=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/;function n(){return RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")}let o=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,p=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})$/,q=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,r=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,s=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,t=/^[A-Za-z0-9_-]*$/,u=/^([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+$/,v=/^\+(?:[0-9]){6,14}[0-9]$/,w="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",x=RegExp(`^${w}$`);function y(a){let b="(?:[01]\\d|2[0-3]):[0-5]\\d";return"number"==typeof a.precision?-1===a.precision?`${b}`:0===a.precision?`${b}:[0-5]\\d`:`${b}:[0-5]\\d\\.\\d{${a.precision}}`:`${b}(?::[0-5]\\d(?:\\.\\d+)?)?`}function z(a){return RegExp(`^${y(a)}$`)}function A(a){let b=y({precision:a.precision}),c=["Z"];a.local&&c.push(""),a.offset&&c.push("([+-]\\d{2}:\\d{2})");let d=`${b}(?:${c.join("|")})`;return RegExp(`^${w}T(?:${d})$`)}let B=a=>{let b=a?`[\\s\\S]{${a?.minimum??0},${a?.maximum??""}}`:"[\\s\\S]*";return RegExp(`^${b}$`)},C=/^\d+$/,D=/^-?\d+(?:\.\d+)?/i,E=/true|false/i,F=/null/i,G=/^[^A-Z]*$/,H=/^[^a-z]*$/},45443:(a,b,c)=>{c.d(b,{qg:()=>i,EJ:()=>j,xL:()=>k,bp:()=>l});var d=c(27771),e=c(84181),f=c(41725);let g=(a,b)=>{e.a$.init(a,b),a.name="ZodError",Object.defineProperties(a,{format:{value:b=>e.Wk(a,b)},flatten:{value:b=>e.JM(a,b)},addIssue:{value:b=>a.issues.push(b)},addIssues:{value:b=>a.issues.push(...b)},isEmpty:{get:()=>0===a.issues.length}})};f.xI("ZodError",g);let h=f.xI("ZodError",g,{Parent:Error}),i=d.Tj(h),j=d.Rb(h),k=d.Od(h),l=d.wG(h)},45702:(a,b,c)=>{c.d(b,{Ch:()=>ab,Di:()=>F,Kq:()=>V,M3:()=>J,Tt:()=>A,b8:()=>ak,bD:()=>s,eM:()=>Z,hL:()=>w,iM:()=>ag,u1:()=>B,u6:()=>R,xn:()=>N});var d,e,f,g,h,i,j,k,l,m,n,o,p="vercel.ai.error",q=Symbol.for(p),r=class a extends Error{constructor({name:a,message:b,cause:c}){super(b),this[d]=!0,this.name=a,this.cause=c}static isInstance(b){return a.hasMarker(b,p)}static hasMarker(a,b){let c=Symbol.for(b);return null!=a&&"object"==typeof a&&c in a&&"boolean"==typeof a[c]&&!0===a[c]}};d=q;var s=r,t="AI_APICallError",u=`vercel.ai.error.${t}`,v=Symbol.for(u),w=class extends s{constructor({message:a,url:b,requestBodyValues:c,statusCode:d,responseHeaders:f,responseBody:g,cause:h,isRetryable:i=null!=d&&(408===d||409===d||429===d||d>=500),data:j}){super({name:t,message:a,cause:h}),this[e]=!0,this.url=b,this.requestBodyValues=c,this.statusCode=d,this.responseHeaders=f,this.responseBody=g,this.isRetryable=i,this.data=j}static isInstance(a){return s.hasMarker(a,u)}};e=v;var x="AI_EmptyResponseBodyError",y=`vercel.ai.error.${x}`,z=Symbol.for(y),A=class extends s{constructor({message:a="Empty response body"}={}){super({name:x,message:a}),this[f]=!0}static isInstance(a){return s.hasMarker(a,y)}};function B(a){return null==a?"unknown error":"string"==typeof a?a:a instanceof Error?a.message:JSON.stringify(a)}f=z;var C="AI_InvalidArgumentError",D=`vercel.ai.error.${C}`,E=Symbol.for(D),F=class extends s{constructor({message:a,cause:b,argument:c}){super({name:C,message:a,cause:b}),this[g]=!0,this.argument=c}static isInstance(a){return s.hasMarker(a,D)}};g=E;var G="AI_InvalidPromptError",H=`vercel.ai.error.${G}`,I=Symbol.for(H),J=class extends s{constructor({prompt:a,message:b,cause:c}){super({name:G,message:`Invalid prompt: ${b}`,cause:c}),this[h]=!0,this.prompt=a}static isInstance(a){return s.hasMarker(a,H)}};h=I;var K="AI_InvalidResponseDataError",L=`vercel.ai.error.${K}`,M=Symbol.for(L),N=class extends s{constructor({data:a,message:b=`Invalid response data: ${JSON.stringify(a)}.`}){super({name:K,message:b}),this[i]=!0,this.data=a}static isInstance(a){return s.hasMarker(a,L)}};i=M;var O="AI_JSONParseError",P=`vercel.ai.error.${O}`,Q=Symbol.for(P),R=class extends s{constructor({text:a,cause:b}){super({name:O,message:`JSON parsing failed: Text: ${a}.
Error message: ${B(b)}`,cause:b}),this[j]=!0,this.text=a}static isInstance(a){return s.hasMarker(a,P)}};j=Q;var S="AI_LoadAPIKeyError",T=`vercel.ai.error.${S}`,U=Symbol.for(T),V=class extends s{constructor({message:a}){super({name:S,message:a}),this[k]=!0}static isInstance(a){return s.hasMarker(a,T)}};k=U,Symbol.for("vercel.ai.error.AI_LoadSettingError"),Symbol.for("vercel.ai.error.AI_NoContentGeneratedError");var W="AI_NoSuchModelError",X=`vercel.ai.error.${W}`,Y=Symbol.for(X),Z=class extends s{constructor({errorName:a=W,modelId:b,modelType:c,message:d=`No such ${c}: ${b}`}){super({name:a,message:d}),this[l]=!0,this.modelId=b,this.modelType=c}static isInstance(a){return s.hasMarker(a,X)}};l=Y;var $="AI_TooManyEmbeddingValuesForCallError",_=`vercel.ai.error.${$}`,aa=Symbol.for(_),ab=class extends s{constructor(a){super({name:$,message:`Too many values for a single embedding call. The ${a.provider} model "${a.modelId}" can only embed up to ${a.maxEmbeddingsPerCall} values per call, but ${a.values.length} values were provided.`}),this[m]=!0,this.provider=a.provider,this.modelId=a.modelId,this.maxEmbeddingsPerCall=a.maxEmbeddingsPerCall,this.values=a.values}static isInstance(a){return s.hasMarker(a,_)}};m=aa;var ac="AI_TypeValidationError",ad=`vercel.ai.error.${ac}`,ae=Symbol.for(ad),af=class a extends s{constructor({value:a,cause:b}){super({name:ac,message:`Type validation failed: Value: ${JSON.stringify(a)}.
Error message: ${B(b)}`,cause:b}),this[n]=!0,this.value=a}static isInstance(a){return s.hasMarker(a,ad)}static wrap({value:b,cause:c}){return a.isInstance(c)&&c.value===b?c:new a({value:b,cause:c})}};n=ae;var ag=af,ah="AI_UnsupportedFunctionalityError",ai=`vercel.ai.error.${ah}`,aj=Symbol.for(ai),ak=class extends s{constructor({functionality:a,message:b=`'${a}' functionality not supported.`}){super({name:ah,message:b}),this[o]=!0,this.functionality=a}static isInstance(a){return s.hasMarker(a,ai)}};o=aj},59432:(a,b,c)=>{c.d(b,{$O:()=>v,$S:()=>$,Au:()=>O,Be:()=>i,Bj:()=>q,Ct:()=>r,Dl:()=>o,ER:()=>_,Eb:()=>T,F7:()=>G,FO:()=>ag,Fk:()=>W,Fn:()=>m,G1:()=>C,G8:()=>N,Hi:()=>S,Il:()=>ad,KA:()=>L,KB:()=>A,Kn:()=>E,LK:()=>I,Mu:()=>g,Ny:()=>u,Pw:()=>s,Rl:()=>f,Tx:()=>Q,Uy:()=>w,WN:()=>ac,YA:()=>V,Zm:()=>P,_L:()=>J,_z:()=>t,aC:()=>n,bS:()=>aa,cU:()=>z,dR:()=>Z,dZ:()=>af,db:()=>D,em:()=>M,f2:()=>F,fU:()=>ah,fs:()=>p,gP:()=>x,hH:()=>X,jw:()=>K,lo:()=>ab,m9:()=>U,nA:()=>j,pY:()=>k,qF:()=>Y,qG:()=>H,qm:()=>R,rk:()=>B,rt:()=>y,tB:()=>h,wA:()=>l,xY:()=>ae});var d=c(29979),e=c(13602);function f(a,b){return new a({type:"string",...e.A2(b)})}function g(a,b){return new a({type:"string",format:"email",check:"string_format",abort:!1,...e.A2(b)})}function h(a,b){return new a({type:"string",format:"guid",check:"string_format",abort:!1,...e.A2(b)})}function i(a,b){return new a({type:"string",format:"uuid",check:"string_format",abort:!1,...e.A2(b)})}function j(a,b){return new a({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...e.A2(b)})}function k(a,b){return new a({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...e.A2(b)})}function l(a,b){return new a({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...e.A2(b)})}function m(a,b){return new a({type:"string",format:"url",check:"string_format",abort:!1,...e.A2(b)})}function n(a,b){return new a({type:"string",format:"emoji",check:"string_format",abort:!1,...e.A2(b)})}function o(a,b){return new a({type:"string",format:"nanoid",check:"string_format",abort:!1,...e.A2(b)})}function p(a,b){return new a({type:"string",format:"cuid",check:"string_format",abort:!1,...e.A2(b)})}function q(a,b){return new a({type:"string",format:"cuid2",check:"string_format",abort:!1,...e.A2(b)})}function r(a,b){return new a({type:"string",format:"ulid",check:"string_format",abort:!1,...e.A2(b)})}function s(a,b){return new a({type:"string",format:"xid",check:"string_format",abort:!1,...e.A2(b)})}function t(a,b){return new a({type:"string",format:"ksuid",check:"string_format",abort:!1,...e.A2(b)})}function u(a,b){return new a({type:"string",format:"ipv4",check:"string_format",abort:!1,...e.A2(b)})}function v(a,b){return new a({type:"string",format:"ipv6",check:"string_format",abort:!1,...e.A2(b)})}function w(a,b){return new a({type:"string",format:"cidrv4",check:"string_format",abort:!1,...e.A2(b)})}function x(a,b){return new a({type:"string",format:"cidrv6",check:"string_format",abort:!1,...e.A2(b)})}function y(a,b){return new a({type:"string",format:"base64",check:"string_format",abort:!1,...e.A2(b)})}function z(a,b){return new a({type:"string",format:"base64url",check:"string_format",abort:!1,...e.A2(b)})}function A(a,b){return new a({type:"string",format:"e164",check:"string_format",abort:!1,...e.A2(b)})}function B(a,b){return new a({type:"string",format:"jwt",check:"string_format",abort:!1,...e.A2(b)})}function C(a,b){return new a({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...e.A2(b)})}function D(a,b){return new a({type:"string",format:"date",check:"string_format",...e.A2(b)})}function E(a,b){return new a({type:"string",format:"time",check:"string_format",precision:null,...e.A2(b)})}function F(a,b){return new a({type:"string",format:"duration",check:"string_format",...e.A2(b)})}function G(a,b){return new a({type:"number",checks:[],...e.A2(b)})}function H(a,b){return new a({type:"number",coerce:!0,checks:[],...e.A2(b)})}function I(a,b){return new a({type:"number",check:"number_format",abort:!1,format:"safeint",...e.A2(b)})}function J(a,b){return new a({type:"boolean",...e.A2(b)})}function K(a,b){return new a({type:"null",...e.A2(b)})}function L(a){return new a({type:"any"})}function M(a){return new a({type:"unknown"})}function N(a,b){return new a({type:"never",...e.A2(b)})}function O(a,b){return new d.sm({check:"less_than",...e.A2(b),value:a,inclusive:!1})}function P(a,b){return new d.sm({check:"less_than",...e.A2(b),value:a,inclusive:!0})}function Q(a,b){return new d.J_({check:"greater_than",...e.A2(b),value:a,inclusive:!1})}function R(a,b){return new d.J_({check:"greater_than",...e.A2(b),value:a,inclusive:!0})}function S(a,b){return new d.Jk({check:"multiple_of",...e.A2(b),value:a})}function T(a,b){return new d.Yk({check:"max_length",...e.A2(b),maximum:a})}function U(a,b){return new d.Kk({check:"min_length",...e.A2(b),minimum:a})}function V(a,b){return new d.RM({check:"length_equals",...e.A2(b),length:a})}function W(a,b){return new d.DG({check:"string_format",format:"regex",...e.A2(b),pattern:a})}function X(a){return new d.NI({check:"string_format",format:"lowercase",...e.A2(a)})}function Y(a){return new d.kH({check:"string_format",format:"uppercase",...e.A2(a)})}function Z(a,b){return new d.Tt({check:"string_format",format:"includes",...e.A2(b),includes:a})}function $(a,b){return new d.J({check:"string_format",format:"starts_with",...e.A2(b),prefix:a})}function _(a,b){return new d.E6({check:"string_format",format:"ends_with",...e.A2(b),suffix:a})}function aa(a){return new d.v$({check:"overwrite",tx:a})}function ab(a){return aa(b=>b.normalize(a))}function ac(){return aa(a=>a.trim())}function ad(){return aa(a=>a.toLowerCase())}function ae(){return aa(a=>a.toUpperCase())}function af(a,b,c){return new a({type:"array",element:b,...e.A2(c)})}function ag(a,b,c){let d=e.A2(c);return d.abort??(d.abort=!0),new a({type:"custom",check:"custom",fn:b,...d})}function ah(a,b,c){return new a({type:"custom",check:"custom",fn:b,...e.A2(c)})}},62902:(a,b,c)=>{c.d(b,{ut:()=>cD,Df:()=>b1,gM:()=>ci});var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C=c(67330),D=c(45702),E=c(75490),F=Symbol.for("vercel.ai.gateway.error"),G=class a extends(e=Error,d=F,e){constructor({message:a,statusCode:b=500,cause:c}){super(a),this[d]=!0,this.statusCode=b,this.cause=c}static isInstance(b){return a.hasMarker(b)}static hasMarker(a){return"object"==typeof a&&null!==a&&F in a&&!0===a[F]}},H="GatewayAuthenticationError",I=Symbol.for(`vercel.ai.gateway.error.${H}`),J=class a extends(g=G,f=I,g){constructor({message:a="Authentication failed",statusCode:b=401,cause:c}={}){super({message:a,statusCode:b,cause:c}),this[f]=!0,this.name=H,this.type="authentication_error"}static isInstance(a){return G.hasMarker(a)&&I in a}static createContextualError({apiKeyProvided:b,oidcTokenProvided:c,message:d="Authentication failed",statusCode:e=401,cause:f}){return new a({message:b?`AI Gateway authentication failed: Invalid API key provided.

The token is expected to be provided via the 'apiKey' option or 'AI_GATEWAY_API_KEY' environment variable.`:c?`AI Gateway authentication failed: Invalid OIDC token provided.

The token is expected to be provided via the 'VERCEL_OIDC_TOKEN' environment variable. It expires every 12 hours.
- make sure your Vercel project settings have OIDC enabled
- if running locally with 'vercel dev', the token is automatically obtained and refreshed
- if running locally with your own dev server, run 'vercel env pull' to fetch the token
- in production/preview, the token is automatically obtained and refreshed

Alternative: Provide an API key via 'apiKey' option or 'AI_GATEWAY_API_KEY' environment variable.`:`AI Gateway authentication failed: No authentication provided.

Provide either an API key or OIDC token.

API key instructions:

The token is expected to be provided via the 'apiKey' option or 'AI_GATEWAY_API_KEY' environment variable.

OIDC token instructions:

The token is expected to be provided via the 'VERCEL_OIDC_TOKEN' environment variable. It expires every 12 hours.
- make sure your Vercel project settings have OIDC enabled
- if running locally with 'vercel dev', the token is automatically obtained and refreshed
- if running locally with your own dev server, run 'vercel env pull' to fetch the token
- in production/preview, the token is automatically obtained and refreshed`,statusCode:e,cause:f})}},K="GatewayInvalidRequestError",L=Symbol.for(`vercel.ai.gateway.error.${K}`),M=class extends(i=G,h=L,i){constructor({message:a="Invalid request",statusCode:b=400,cause:c}={}){super({message:a,statusCode:b,cause:c}),this[h]=!0,this.name=K,this.type="invalid_request_error"}static isInstance(a){return G.hasMarker(a)&&L in a}},N="GatewayRateLimitError",O=Symbol.for(`vercel.ai.gateway.error.${N}`),P=class extends(k=G,j=O,k){constructor({message:a="Rate limit exceeded",statusCode:b=429,cause:c}={}){super({message:a,statusCode:b,cause:c}),this[j]=!0,this.name=N,this.type="rate_limit_exceeded"}static isInstance(a){return G.hasMarker(a)&&O in a}},Q="GatewayModelNotFoundError",R=Symbol.for(`vercel.ai.gateway.error.${Q}`),S=E.Ik({modelId:E.Yj()}),T=class extends(m=G,l=R,m){constructor({message:a="Model not found",statusCode:b=404,modelId:c,cause:d}={}){super({message:a,statusCode:b,cause:d}),this[l]=!0,this.name=Q,this.type="model_not_found",this.modelId=c}static isInstance(a){return G.hasMarker(a)&&R in a}},U="GatewayInternalServerError",V=Symbol.for(`vercel.ai.gateway.error.${U}`),W=class extends(o=G,n=V,o){constructor({message:a="Internal server error",statusCode:b=500,cause:c}={}){super({message:a,statusCode:b,cause:c}),this[n]=!0,this.name=U,this.type="internal_server_error"}static isInstance(a){return G.hasMarker(a)&&V in a}},X="GatewayResponseError",Y=Symbol.for(`vercel.ai.gateway.error.${X}`),Z=class extends(q=G,p=Y,q){constructor({message:a="Invalid response from Gateway",statusCode:b=502,response:c,validationError:d,cause:e}={}){super({message:a,statusCode:b,cause:e}),this[p]=!0,this.name=X,this.type="response_error",this.response=c,this.validationError=d}static isInstance(a){return G.hasMarker(a)&&Y in a}};function $({response:a,statusCode:b,defaultMessage:c="Gateway request failed",cause:d,authMethod:e}){let f=_.safeParse(a);if(!f.success)return new Z({message:`Invalid error response format: ${c}`,statusCode:b,response:a,validationError:f.error,cause:d});let g=f.data,h=g.error.type,i=g.error.message;switch(h){case"authentication_error":return J.createContextualError({apiKeyProvided:"api-key"===e,oidcTokenProvided:"oidc"===e,statusCode:b,cause:d});case"invalid_request_error":return new M({message:i,statusCode:b,cause:d});case"rate_limit_exceeded":return new P({message:i,statusCode:b,cause:d});case"model_not_found":{let a=S.safeParse(g.error.param);return new T({message:i,statusCode:b,modelId:a.success?a.data.modelId:void 0,cause:d})}default:return new W({message:i,statusCode:b,cause:d})}}var _=E.Ik({error:E.Ik({message:E.Yj(),type:E.Yj().nullish(),param:E.L5().nullish(),code:E.KC([E.Yj(),E.ai()]).nullish()})});function aa(a,b){var c;return G.isInstance(a)?a:D.hL.isInstance(a)?$({response:function(a){if(void 0!==a.data)return a.data;if(null!=a.responseBody)try{return JSON.parse(a.responseBody)}catch(b){return a.responseBody}return{}}(a),statusCode:null!=(c=a.statusCode)?c:500,defaultMessage:"Gateway request failed",cause:a,authMethod:b}):$({response:{},statusCode:500,defaultMessage:a instanceof Error?`Gateway request failed: ${a.message}`:"Unknown Gateway error",cause:a,authMethod:b})}var ab="ai-gateway-auth-method";function ac(a){let b=ad.safeParse(a[ab]);return b.success?b.data:void 0}var ad=E.KC([E.eu("api-key"),E.eu("oidc")]),ae=class{constructor(a){this.config=a}async getAvailableModels(){try{let{value:a}=await (0,C.$b)({url:`${this.config.baseURL}/config`,headers:await (0,C.hd)(this.config.headers()),successfulResponseHandler:(0,C.cV)(ai),failedResponseHandler:(0,C.sl)({errorSchema:E.bz(),errorToMessage:a=>a}),fetch:this.config.fetch});return a}catch(a){throw aa(a)}}},af=E.Ik({specificationVersion:E.eu("v2"),provider:E.Yj(),modelId:E.Yj()}),ag=E.Ik({input:E.Yj(),output:E.Yj()}),ah=E.Ik({id:E.Yj(),name:E.Yj(),description:E.Yj().nullish(),pricing:ag.nullish(),specification:af}),ai=E.Ik({models:E.YO(ah)}),aj=class{constructor(a,b){this.modelId=a,this.config=b,this.specificationVersion="v2",this.supportedUrls={"*/*":[/.*/]}}get provider(){return this.config.provider}async getArgs(a){let{abortSignal:b,...c}=a;return{args:this.maybeEncodeFileParts(c),warnings:[]}}async doGenerate(a){let{args:b,warnings:c}=await this.getArgs(a),{abortSignal:d}=a,e=await (0,C.hd)(this.config.headers());try{let{responseHeaders:f,value:g,rawValue:h}=await (0,C.GU)({url:this.getUrl(),headers:(0,C.m2)(e,a.headers,this.getModelConfigHeaders(this.modelId,!1),await (0,C.hd)(this.config.o11yHeaders)),body:b,successfulResponseHandler:(0,C.cV)(E.bz()),failedResponseHandler:(0,C.sl)({errorSchema:E.bz(),errorToMessage:a=>a}),...d&&{abortSignal:d},fetch:this.config.fetch});return{...g,request:{body:b},response:{headers:f,body:h},warnings:c}}catch(a){throw aa(a,ac(e))}}async doStream(a){let{args:b,warnings:c}=await this.getArgs(a),{abortSignal:d}=a,e=await (0,C.hd)(this.config.headers());try{let{value:f,responseHeaders:g}=await (0,C.GU)({url:this.getUrl(),headers:(0,C.m2)(e,a.headers,this.getModelConfigHeaders(this.modelId,!0),await (0,C.hd)(this.config.o11yHeaders)),body:b,successfulResponseHandler:(0,C.Ds)(E.bz()),failedResponseHandler:(0,C.sl)({errorSchema:E.bz(),errorToMessage:a=>a}),...d&&{abortSignal:d},fetch:this.config.fetch});return{stream:f.pipeThrough(new TransformStream({start(a){c.length>0&&a.enqueue({type:"stream-start",warnings:c})},transform(b,c){if(b.success){let d=b.value;("raw"!==d.type||a.includeRawChunks)&&("response-metadata"===d.type&&d.timestamp&&"string"==typeof d.timestamp&&(d.timestamp=new Date(d.timestamp)),c.enqueue(d))}else c.error(b.error)}})),request:{body:b},response:{headers:g}}}catch(a){throw aa(a,ac(e))}}isFilePart(a){return a&&"object"==typeof a&&"type"in a&&"file"===a.type}maybeEncodeFileParts(a){for(let b of a.prompt)for(let a of b.content)if(this.isFilePart(a)&&a.data instanceof Uint8Array){let b=Uint8Array.from(a.data),c=Buffer.from(b).toString("base64");a.data=new URL(`data:${a.mediaType||"application/octet-stream"};base64,${c}`)}return a}getUrl(){return`${this.config.baseURL}/language-model`}getModelConfigHeaders(a,b){return{"ai-language-model-specification-version":"2","ai-language-model-id":a,"ai-language-model-streaming":String(b)}}},ak=class{constructor(a,b){this.modelId=a,this.config=b,this.specificationVersion="v2",this.maxEmbeddingsPerCall=2048,this.supportsParallelCalls=!0}get provider(){return this.config.provider}async doEmbed({values:a,headers:b,abortSignal:c,providerOptions:d}){var e;let f=await (0,C.hd)(this.config.headers());try{let{responseHeaders:g,value:h,rawValue:i}=await (0,C.GU)({url:this.getUrl(),headers:(0,C.m2)(f,null!=b?b:{},this.getModelConfigHeaders(),await (0,C.hd)(this.config.o11yHeaders)),body:{input:1===a.length?a[0]:a,...null!=d?d:{}},successfulResponseHandler:(0,C.cV)(al),failedResponseHandler:(0,C.sl)({errorSchema:E.bz(),errorToMessage:a=>a}),...c&&{abortSignal:c},fetch:this.config.fetch});return{embeddings:h.embeddings,usage:null!=(e=h.usage)?e:void 0,providerMetadata:h.providerMetadata,response:{headers:g,body:i}}}catch(a){throw aa(a,ac(f))}}getUrl(){return`${this.config.baseURL}/embedding-model`}getModelConfigHeaders(){return{"ai-embedding-model-specification-version":"2","ai-model-id":this.modelId}}},al=E.Ik({embeddings:E.YO(E.YO(E.ai())),usage:E.Ik({tokens:E.ai()}).nullish(),providerMetadata:E.g1(E.Yj(),E.g1(E.Yj(),E.L5())).optional()});async function am(){var a,b;let c=null!=(b=null==(a=ap().headers)?void 0:a["x-vercel-oidc-token"])?b:process.env.VERCEL_OIDC_TOKEN;if(!c)throw new J({message:"OIDC token not available",statusCode:401});return c}async function an(){var a;return null==(a=ap().headers)?void 0:a["x-vercel-id"]}var ao=Symbol.for("@vercel/request-context");function ap(){var a,b,c;return null!=(c=null==(b=null==(a=globalThis[ao])?void 0:a.get)?void 0:b.call(a))?c:{}}var aq=function(a={}){var b,c;let d=null,e=null,f=null!=(b=a.metadataCacheRefreshMillis)?b:3e5,g=0,h=null!=(c=(0,C.ae)(a.baseURL))?c:"https://ai-gateway.vercel.sh/v1/ai",i=async()=>{let b=await ar(a);if(b)return{Authorization:`Bearer ${b.token}`,"ai-gateway-protocol-version":"0.0.1",[ab]:b.authMethod,...a.headers};throw J.createContextualError({apiKeyProvided:!1,oidcTokenProvided:!1,statusCode:401})},j=()=>{let a=(0,C.x3)({settingValue:void 0,environmentVariableName:"VERCEL_DEPLOYMENT_ID"}),b=(0,C.x3)({settingValue:void 0,environmentVariableName:"VERCEL_ENV"}),c=(0,C.x3)({settingValue:void 0,environmentVariableName:"VERCEL_REGION"});return async()=>{let d=await an();return{...a&&{"ai-o11y-deployment-id":a},...b&&{"ai-o11y-environment":b},...c&&{"ai-o11y-region":c},...d&&{"ai-o11y-request-id":d}}}},k=b=>new aj(b,{provider:"gateway",baseURL:h,headers:i,fetch:a.fetch,o11yHeaders:j()}),l=function(a){if(new.target)throw Error("The Gateway Provider model function cannot be called with the new keyword.");return k(a)};return l.getAvailableModels=async()=>{var b,c,j;let k=null!=(j=null==(c=null==(b=a._internal)?void 0:b.currentDate)?void 0:c.call(b).getTime())?j:Date.now();return(!d||k-g>f)&&(g=k,d=new ae({baseURL:h,headers:i,fetch:a.fetch}).getAvailableModels().then(a=>(e=a,a)).catch(async a=>{throw aa(a,ac(await i()))})),e?Promise.resolve(e):d},l.imageModel=a=>{throw new D.eM({modelId:a,modelType:"imageModel"})},l.languageModel=k,l.textEmbeddingModel=b=>new ak(b,{provider:"gateway",baseURL:h,headers:i,fetch:a.fetch,o11yHeaders:j()}),l}();async function ar(a){let b=(0,C.x3)({settingValue:a.apiKey,environmentVariableName:"AI_GATEWAY_API_KEY"});if(b)return{token:b,authMethod:"api-key"};try{return{token:await am(),authMethod:"oidc"}}catch(a){return null}}var as=c(1476),at=c(13857),au=Object.defineProperty,av="AI_NoOutputSpecifiedError",aw=`vercel.ai.error.${av}`,ax=Symbol.for(aw),ay=class extends D.bD{constructor({message:a="No output specified."}={}){super({name:av,message:a}),this[r]=!0}static isInstance(a){return D.bD.hasMarker(a,aw)}};r=ax;var az="AI_InvalidArgumentError",aA=`vercel.ai.error.${az}`,aB=Symbol.for(aA),aC=class extends D.bD{constructor({parameter:a,value:b,message:c}){super({name:az,message:`Invalid argument for parameter ${a}: ${c}`}),this[s]=!0,this.parameter=a,this.value=b}static isInstance(a){return D.bD.hasMarker(a,aA)}};s=aB;Symbol.for("vercel.ai.error.AI_InvalidStreamPartError");D.bD;var aD="AI_InvalidToolInputError",aE=`vercel.ai.error.${aD}`,aF=Symbol.for(aE),aG=class extends D.bD{constructor({toolInput:a,toolName:b,cause:c,message:d=`Invalid input for tool ${b}: ${(0,D.u1)(c)}`}){super({name:aD,message:d,cause:c}),this[t]=!0,this.toolInput=a,this.toolName=b}static isInstance(a){return D.bD.hasMarker(a,aE)}};t=aF;Symbol.for("vercel.ai.error.AI_MCPClientError");D.bD;Symbol.for("vercel.ai.error.AI_NoImageGeneratedError");D.bD;var aH="AI_NoObjectGeneratedError",aI=`vercel.ai.error.${aH}`,aJ=Symbol.for(aI),aK=class extends D.bD{constructor({message:a="No object generated.",cause:b,text:c,response:d,usage:e,finishReason:f}){super({name:aH,message:a,cause:b}),this[u]=!0,this.text=c,this.response=d,this.usage=e,this.finishReason=f}static isInstance(a){return D.bD.hasMarker(a,aI)}};u=aJ;var aL="AI_NoOutputGeneratedError",aM=`vercel.ai.error.${aL}`,aN=Symbol.for(aM),aO=class extends D.bD{constructor({message:a="No output generated.",cause:b}={}){super({name:aL,message:a,cause:b}),this[v]=!0}static isInstance(a){return D.bD.hasMarker(a,aM)}};v=aN;var aP="AI_NoSuchToolError",aQ=`vercel.ai.error.${aP}`,aR=Symbol.for(aQ),aS=class extends D.bD{constructor({toolName:a,availableTools:b,message:c=`Model tried to call unavailable tool '${a}'. ${void 0===b?"No tools are available.":`Available tools: ${b.join(", ")}.`}`}){super({name:aP,message:c}),this[w]=!0,this.toolName=a,this.availableTools=b}static isInstance(a){return D.bD.hasMarker(a,aQ)}};w=aR;var aT="AI_ToolCallRepairError",aU=`vercel.ai.error.${aT}`,aV=Symbol.for(aU),aW=class extends D.bD{constructor({cause:a,originalError:b,message:c=`Error repairing tool call: ${(0,D.u1)(a)}`}){super({name:aT,message:c,cause:a}),this[x]=!0,this.originalError=b}static isInstance(a){return D.bD.hasMarker(a,aU)}};x=aV;var aX=class extends D.bD{constructor(a){super({name:"AI_UnsupportedModelVersionError",message:`Unsupported model version ${a.version} for provider "${a.provider}" and model "${a.modelId}". AI SDK 5 only supports models that implement specification version "v2".`}),this.version=a.version,this.provider=a.provider,this.modelId=a.modelId}},aY=Symbol.for("vercel.ai.error.AI_InvalidDataContentError");D.bD;var aZ="AI_InvalidMessageRoleError",a$=`vercel.ai.error.${aZ}`,a_=Symbol.for(a$),a0=class extends D.bD{constructor({role:a,message:b=`Invalid message role: '${a}'. Must be one of: "system", "user", "assistant", "tool".`}){super({name:aZ,message:b}),this[y]=!0,this.role=a}static isInstance(a){return D.bD.hasMarker(a,a$)}};y=a_;var a1="AI_MessageConversionError",a2=`vercel.ai.error.${a1}`,a3=Symbol.for(a2),a4=class extends D.bD{constructor({originalMessage:a,message:b}){super({name:a1,message:b}),this[z]=!0,this.originalMessage=a}static isInstance(a){return D.bD.hasMarker(a,a2)}};z=a3;var a5="AI_DownloadError",a6=`vercel.ai.error.${a5}`,a7=Symbol.for(a6),a8=class extends D.bD{constructor({url:a,statusCode:b,statusText:c,cause:d,message:e=null==d?`Failed to download ${a}: ${b} ${c}`:`Failed to download ${a}: ${d}`}){super({name:a5,message:e,cause:d}),this[A]=!0,this.url=a,this.statusCode=b,this.statusText=c}static isInstance(a){return D.bD.hasMarker(a,a6)}};A=a7;var a9="AI_RetryError",ba=`vercel.ai.error.${a9}`,bb=Symbol.for(ba),bc=class extends D.bD{constructor({message:a,reason:b,errors:c}){super({name:a9,message:a}),this[B]=!0,this.reason=b,this.errors=c,this.lastError=c[c.length-1]}static isInstance(a){return D.bD.hasMarker(a,ba)}};function bd(a){var b;if("string"!=typeof a){if("v2"!==a.specificationVersion)throw new aX({version:a.specificationVersion,provider:a.provider,modelId:a.modelId});return a}return(null!=(b=globalThis.AI_SDK_DEFAULT_PROVIDER)?b:aq).languageModel(a)}B=bb;var be=[{mediaType:"image/gif",bytesPrefix:[71,73,70],base64Prefix:"R0lG"},{mediaType:"image/png",bytesPrefix:[137,80,78,71],base64Prefix:"iVBORw"},{mediaType:"image/jpeg",bytesPrefix:[255,216],base64Prefix:"/9j/"},{mediaType:"image/webp",bytesPrefix:[82,73,70,70],base64Prefix:"UklGRg"},{mediaType:"image/bmp",bytesPrefix:[66,77],base64Prefix:"Qk"},{mediaType:"image/tiff",bytesPrefix:[73,73,42,0],base64Prefix:"SUkqAA"},{mediaType:"image/tiff",bytesPrefix:[77,77,0,42],base64Prefix:"TU0AKg"},{mediaType:"image/avif",bytesPrefix:[0,0,0,32,102,116,121,112,97,118,105,102],base64Prefix:"AAAAIGZ0eXBhdmlm"},{mediaType:"image/heic",bytesPrefix:[0,0,0,32,102,116,121,112,104,101,105,99],base64Prefix:"AAAAIGZ0eXBoZWlj"}];async function bf({url:a}){var b;let c=a.toString();try{let a=await fetch(c);if(!a.ok)throw new a8({url:c,statusCode:a.status,statusText:a.statusText});return{data:new Uint8Array(await a.arrayBuffer()),mediaType:null!=(b=a.headers.get("content-type"))?b:void 0}}catch(a){if(a8.isInstance(a))throw a;throw new a8({url:c,cause:a})}}var bg=E.KC([E.Yj(),E.Nl(Uint8Array),E.Nl(ArrayBuffer),E.Ie(a=>{var b,c;return null!=(c=null==(b=globalThis.Buffer)?void 0:b.isBuffer(a))&&c},{message:"Must be a Buffer"})]);function bh(a){if(a instanceof Uint8Array)return{data:a,mediaType:void 0};if(a instanceof ArrayBuffer)return{data:new Uint8Array(a),mediaType:void 0};if("string"==typeof a)try{a=new URL(a)}catch(a){}if(a instanceof URL&&"data:"===a.protocol){let{mediaType:b,base64Content:c}=function(a){try{let[b,c]=a.split(",");return{mediaType:b.split(";")[0].split(":")[1],base64Content:c}}catch(a){return{mediaType:void 0,base64Content:void 0}}}(a.toString());if(null==b||null==c)throw new D.bD({name:"InvalidDataContentError",message:`Invalid data URL format in content ${a.toString()}`});return{data:c,mediaType:b}}return{data:a,mediaType:void 0}}async function bi({prompt:a,supportedUrls:b,downloadImplementation:c=bf}){let d=await bj(a.messages,c,b);return[...null!=a.system?[{role:"system",content:a.system}]:[],...a.messages.map(a=>(function({message:a,downloadedAssets:b}){let c=a.role;switch(c){case"system":return{role:"system",content:a.content,providerOptions:a.providerOptions};case"user":if("string"==typeof a.content)return{role:"user",content:[{type:"text",text:a.content}],providerOptions:a.providerOptions};return{role:"user",content:a.content.map(a=>(function(a,b){var c;let d;if("text"===a.type)return{type:"text",text:a.text,providerOptions:a.providerOptions};let e=a.type;switch(e){case"image":d=a.image;break;case"file":d=a.data;break;default:throw Error(`Unsupported part type: ${e}`)}let{data:f,mediaType:g}=bh(d),h=null!=g?g:a.mediaType,i=f;if(i instanceof URL){let a=b[i.toString()];a&&(i=a.data,null!=h||(h=a.mediaType))}switch(e){case"image":return(i instanceof Uint8Array||"string"==typeof i)&&(h=null!=(c=function({data:a,signatures:b}){let c="string"==typeof a&&a.startsWith("SUQz")||"string"!=typeof a&&a.length>10&&73===a[0]&&68===a[1]&&51===a[2]?(a=>{let b="string"==typeof a?(0,C.Z9)(a):a,c=(127&b[6])<<21|(127&b[7])<<14|(127&b[8])<<7|127&b[9];return b.slice(c+10)})(a):a;for(let a of b)if("string"==typeof c?c.startsWith(a.base64Prefix):c.length>=a.bytesPrefix.length&&a.bytesPrefix.every((a,b)=>c[b]===a))return a.mediaType}({data:i,signatures:be}))?c:h),{type:"file",mediaType:null!=h?h:"image/*",filename:void 0,data:i,providerOptions:a.providerOptions};case"file":if(null==h)throw Error("Media type is missing for file part");return{type:"file",mediaType:h,filename:a.filename,data:i,providerOptions:a.providerOptions}}})(a,b)).filter(a=>"text"!==a.type||""!==a.text),providerOptions:a.providerOptions};case"assistant":if("string"==typeof a.content)return{role:"assistant",content:[{type:"text",text:a.content}],providerOptions:a.providerOptions};return{role:"assistant",content:a.content.filter(a=>"text"!==a.type||""!==a.text).map(a=>{let b=a.providerOptions;switch(a.type){case"file":{let{data:c,mediaType:d}=bh(a.data);return{type:"file",data:c,filename:a.filename,mediaType:null!=d?d:a.mediaType,providerOptions:b}}case"reasoning":return{type:"reasoning",text:a.text,providerOptions:b};case"text":return{type:"text",text:a.text,providerOptions:b};case"tool-call":return{type:"tool-call",toolCallId:a.toolCallId,toolName:a.toolName,input:a.input,providerExecuted:a.providerExecuted,providerOptions:b};case"tool-result":return{type:"tool-result",toolCallId:a.toolCallId,toolName:a.toolName,output:a.output,providerOptions:b}}}),providerOptions:a.providerOptions};case"tool":return{role:"tool",content:a.content.map(a=>({type:"tool-result",toolCallId:a.toolCallId,toolName:a.toolName,output:a.output,providerOptions:a.providerOptions})),providerOptions:a.providerOptions};default:throw new a0({role:c})}})({message:a,downloadedAssets:d}))]}async function bj(a,b,c){let d=a.filter(a=>"user"===a.role).map(a=>a.content).filter(a=>Array.isArray(a)).flat().filter(a=>"image"===a.type||"file"===a.type).map(a=>{var b;let c=null!=(b=a.mediaType)?b:"image"===a.type?"image/*":void 0,d="image"===a.type?a.image:a.data;if("string"==typeof d)try{d=new URL(d)}catch(a){}return{mediaType:c,data:d}}).filter(a=>a.data instanceof URL&&null!=a.mediaType&&!(0,C.qs)({url:a.data.toString(),mediaType:a.mediaType,supportedUrls:c})).map(a=>a.data);return Object.fromEntries((await Promise.all(d.map(async a=>({url:a,data:await b({url:a})})))).map(({url:a,data:b})=>[a.toString(),b]))}function bk({maxOutputTokens:a,temperature:b,topP:c,topK:d,presencePenalty:e,frequencyPenalty:f,seed:g,stopSequences:h}){if(null!=a){if(!Number.isInteger(a))throw new aC({parameter:"maxOutputTokens",value:a,message:"maxOutputTokens must be an integer"});if(a<1)throw new aC({parameter:"maxOutputTokens",value:a,message:"maxOutputTokens must be >= 1"})}if(null!=b&&"number"!=typeof b)throw new aC({parameter:"temperature",value:b,message:"temperature must be a number"});if(null!=c&&"number"!=typeof c)throw new aC({parameter:"topP",value:c,message:"topP must be a number"});if(null!=d&&"number"!=typeof d)throw new aC({parameter:"topK",value:d,message:"topK must be a number"});if(null!=e&&"number"!=typeof e)throw new aC({parameter:"presencePenalty",value:e,message:"presencePenalty must be a number"});if(null!=f&&"number"!=typeof f)throw new aC({parameter:"frequencyPenalty",value:f,message:"frequencyPenalty must be a number"});if(null!=g&&!Number.isInteger(g))throw new aC({parameter:"seed",value:g,message:"seed must be an integer"});return{maxOutputTokens:a,temperature:b,topP:c,topK:d,presencePenalty:e,frequencyPenalty:f,stopSequences:h,seed:g}}function bl({tools:a,toolChoice:b,activeTools:c}){return null!=a&&Object.keys(a).length>0?{tools:(null!=c?Object.entries(a).filter(([a])=>c.includes(a)):Object.entries(a)).map(([a,b])=>{let c=b.type;switch(c){case void 0:case"dynamic":case"function":return{type:"function",name:a,description:b.description,inputSchema:(0,C.mD)(b.inputSchema).jsonSchema,providerOptions:b.providerOptions};case"provider-defined":return{type:"provider-defined",name:a,id:b.id,args:b.args};default:throw Error(`Unsupported tool type: ${c}`)}}),toolChoice:null==b?{type:"auto"}:"string"==typeof b?{type:b}:{type:"tool",toolName:b.toolName}}:{tools:void 0,toolChoice:void 0}}var bm=E.RZ(()=>E.KC([E.ch(),E.Yj(),E.ai(),E.zM(),E.g1(E.Yj(),bm),E.YO(bm)])),bn=E.g1(E.Yj(),E.g1(E.Yj(),bm)),bo=E.Ik({type:E.eu("text"),text:E.Yj(),providerOptions:bn.optional()}),bp=E.Ik({type:E.eu("image"),image:E.KC([bg,E.Nl(URL)]),mediaType:E.Yj().optional(),providerOptions:bn.optional()}),bq=E.Ik({type:E.eu("file"),data:E.KC([bg,E.Nl(URL)]),filename:E.Yj().optional(),mediaType:E.Yj(),providerOptions:bn.optional()}),br=E.Ik({type:E.eu("reasoning"),text:E.Yj(),providerOptions:bn.optional()}),bs=E.Ik({type:E.eu("tool-call"),toolCallId:E.Yj(),toolName:E.Yj(),input:E.L5(),providerOptions:bn.optional(),providerExecuted:E.zM().optional()}),bt=E.gM("type",[E.Ik({type:E.eu("text"),value:E.Yj()}),E.Ik({type:E.eu("json"),value:bm}),E.Ik({type:E.eu("error-text"),value:E.Yj()}),E.Ik({type:E.eu("error-json"),value:bm}),E.Ik({type:E.eu("content"),value:E.YO(E.KC([E.Ik({type:E.eu("text"),text:E.Yj()}),E.Ik({type:E.eu("media"),data:E.Yj(),mediaType:E.Yj()})]))})]),bu=E.Ik({type:E.eu("tool-result"),toolCallId:E.Yj(),toolName:E.Yj(),output:bt,providerOptions:bn.optional()}),bv=E.Ik({role:E.eu("system"),content:E.Yj(),providerOptions:bn.optional()}),bw=E.Ik({role:E.eu("user"),content:E.KC([E.Yj(),E.YO(E.KC([bo,bp,bq]))]),providerOptions:bn.optional()}),bx=E.Ik({role:E.eu("assistant"),content:E.KC([E.Yj(),E.YO(E.KC([bo,bq,br,bs,bu]))]),providerOptions:bn.optional()}),by=E.Ik({role:E.eu("tool"),content:E.YO(bu),providerOptions:bn.optional()}),bz=E.KC([bv,bw,bx,by]);async function bA(a){let b;if(null==a.prompt&&null==a.messages)throw new D.M3({prompt:a,message:"prompt or messages must be defined"});if(null!=a.prompt&&null!=a.messages)throw new D.M3({prompt:a,message:"prompt and messages cannot be defined at the same time"});if(null!=a.system&&"string"!=typeof a.system)throw new D.M3({prompt:a,message:"system must be a string"});if(null!=a.prompt&&"string"==typeof a.prompt)b=[{role:"user",content:a.prompt}];else if(null!=a.prompt&&Array.isArray(a.prompt))b=a.prompt;else if(null!=a.messages)b=a.messages;else throw new D.M3({prompt:a,message:"prompt or messages must be defined"});if(0===b.length)throw new D.M3({prompt:a,message:"messages must not be empty"});let c=await (0,C.ZZ)({value:b,schema:E.YO(bz)});if(!c.success)throw new D.M3({prompt:a,message:"The messages must be a ModelMessage[]. If you have passed a UIMessage[], you can use convertToModelMessages to convert them.",cause:c.error});return{messages:b,system:a.system}}function bB(a){return J.isInstance(a)||T.isInstance(a)?new D.bD({name:"GatewayError",message:"Vercel AI Gateway access failed. If you want to use AI SDK providers directly, use the providers, e.g. @ai-sdk/openai, or register a different global default provider.",cause:a}):a}function bC({operationId:a,telemetry:b}){return{"operation.name":`${a}${(null==b?void 0:b.functionId)!=null?` ${b.functionId}`:""}`,"resource.name":null==b?void 0:b.functionId,"ai.operationId":a,"ai.telemetry.functionId":null==b?void 0:b.functionId}}function bD({model:a,settings:b,telemetry:c,headers:d}){var e;return{"ai.model.provider":a.provider,"ai.model.id":a.modelId,...Object.entries(b).reduce((a,[b,c])=>(a[`ai.settings.${b}`]=c,a),{}),...Object.entries(null!=(e=null==c?void 0:c.metadata)?e:{}).reduce((a,[b,c])=>(a[`ai.telemetry.metadata.${b}`]=c,a),{}),...Object.entries(null!=d?d:{}).reduce((a,[b,c])=>(void 0!==c&&(a[`ai.request.headers.${b}`]=c),a),{})}}var bE={startSpan:()=>bF,startActiveSpan:(a,b,c,d)=>"function"==typeof b?b(bF):"function"==typeof c?c(bF):"function"==typeof d?d(bF):void 0},bF={spanContext:()=>bG,setAttribute(){return this},setAttributes(){return this},addEvent(){return this},addLink(){return this},addLinks(){return this},setStatus(){return this},updateName(){return this},end(){return this},isRecording:()=>!1,recordException(){return this}},bG={traceId:"",spanId:"",traceFlags:0};function bH({isEnabled:a=!1,tracer:b}={}){return a?b||as.u.getTracer("ai"):bE}function bI({name:a,tracer:b,attributes:c,fn:d,endWhenDone:e=!0}){return b.startActiveSpan(a,{attributes:c},async a=>{try{let b=await d(a);return e&&a.end(),b}catch(b){try{bJ(a,b)}finally{a.end()}throw b}})}function bJ(a,b){b instanceof Error?(a.recordException({name:b.name,message:b.message,stack:b.stack}),a.setStatus({code:at.s.ERROR,message:b.message})):a.setStatus({code:at.s.ERROR})}function bK({telemetry:a,attributes:b}){return(null==a?void 0:a.isEnabled)!==!0?{}:Object.entries(b).reduce((b,[c,d])=>{if(null==d)return b;if("object"==typeof d&&"input"in d&&"function"==typeof d.input){if((null==a?void 0:a.recordInputs)===!1)return b;let e=d.input();return null==e?b:{...b,[c]:e}}if("object"==typeof d&&"output"in d&&"function"==typeof d.output){if((null==a?void 0:a.recordOutputs)===!1)return b;let e=d.output();return null==e?b:{...b,[c]:e}}return{...b,[c]:d}},{})}function bL(a){return JSON.stringify(a.map(a=>({...a,content:"string"==typeof a.content?a.content:a.content.map(a=>{var b;return"file"===a.type?{...a,data:a.data instanceof Uint8Array?"string"==typeof(b=a.data)?b:b instanceof ArrayBuffer?(0,C.n_)(new Uint8Array(b)):(0,C.n_)(b):a.data}:a})})))}function bM(a,b){return{inputTokens:bN(a.inputTokens,b.inputTokens),outputTokens:bN(a.outputTokens,b.outputTokens),totalTokens:bN(a.totalTokens,b.totalTokens),reasoningTokens:bN(a.reasoningTokens,b.reasoningTokens),cachedInputTokens:bN(a.cachedInputTokens,b.cachedInputTokens)}}function bN(a,b){return null==a&&null==b?void 0:(null!=a?a:0)+(null!=b?b:0)}function bO(a){return void 0===a?[]:Array.isArray(a)?a:[a]}async function bP(a,{maxRetries:b,delayInMs:c,backoffFactor:d,abortSignal:e},f=[]){try{return await a()}catch(j){if((0,C.zf)(j)||0===b)throw j;let g=(0,C.u1)(j),h=[...f,j],i=h.length;if(i>b)throw new bc({message:`Failed after ${i} attempts. Last error: ${g}`,reason:"maxRetriesExceeded",errors:h});if(j instanceof Error&&D.hL.isInstance(j)&&!0===j.isRetryable&&i<=b)return await (0,C.cb)(function({error:a,exponentialBackoffDelay:b}){let c,d=a.responseHeaders;if(!d)return b;let e=d["retry-after-ms"];if(e){let a=parseFloat(e);Number.isNaN(a)||(c=a)}let f=d["retry-after"];if(f&&void 0===c){let a=parseFloat(f);c=Number.isNaN(a)?Date.parse(f)-Date.now():1e3*a}return null!=c&&!Number.isNaN(c)&&0<=c&&(c<6e4||c<b)?c:b}({error:j,exponentialBackoffDelay:c}),{abortSignal:e}),bP(a,{maxRetries:b,delayInMs:d*c,backoffFactor:d,abortSignal:e},h);if(1===i)throw j;throw new bc({message:`Failed after ${i} attempts with non-retryable error: '${g}'`,reason:"errorNotRetryable",errors:h})}}function bQ({maxRetries:a,abortSignal:b}){if(null!=a){if(!Number.isInteger(a))throw new aC({parameter:"maxRetries",value:a,message:"maxRetries must be an integer"});if(a<0)throw new aC({parameter:"maxRetries",value:a,message:"maxRetries must be >= 0"})}let c=null!=a?a:2;return{maxRetries:c,retry:(({maxRetries:a=2,initialDelayInMs:b=2e3,backoffFactor:c=2,abortSignal:d}={})=>async e=>bP(e,{maxRetries:a,delayInMs:b,backoffFactor:c,abortSignal:d}))({maxRetries:c,abortSignal:b})}}function bR(a){let b=a.filter(a=>"text"===a.type);if(0!==b.length)return b.map(a=>a.text).join("")}var bS=class{constructor({data:a,mediaType:b}){let c=a instanceof Uint8Array;this.base64Data=c?void 0:a,this.uint8ArrayData=c?a:void 0,this.mediaType=b}get base64(){return null==this.base64Data&&(this.base64Data=(0,C.n_)(this.uint8ArrayData)),this.base64Data}get uint8Array(){return null==this.uint8ArrayData&&(this.uint8ArrayData=(0,C.Z9)(this.base64Data)),this.uint8ArrayData}},bT=class extends bS{constructor(a){super(a),this.type="file"}};async function bU({toolCall:a,tools:b,repairToolCall:c,system:d,messages:e}){try{if(null==b)throw new aS({toolName:a.toolName});try{return await bV({toolCall:a,tools:b})}catch(g){if(null==c||!(aS.isInstance(g)||aG.isInstance(g)))throw g;let f=null;try{f=await c({toolCall:a,tools:b,inputSchema:({toolName:a})=>{let{inputSchema:c}=b[a];return(0,C.mD)(c).jsonSchema},system:d,messages:e,error:g})}catch(a){throw new aW({cause:a,originalError:g})}if(null==f)throw g;return await bV({toolCall:f,tools:b})}}catch(b){return{type:"tool-call",toolCallId:a.toolCallId,toolName:a.toolName,input:a.input,dynamic:!0,invalid:!0,error:b}}}async function bV({toolCall:a,tools:b}){let c=a.toolName,d=b[c];if(null==d)throw new aS({toolName:a.toolName,availableTools:Object.keys(b)});let e=(0,C.mD)(d.inputSchema),f=""===a.input.trim()?await (0,C.ZZ)({value:{},schema:e}):await (0,C.N8)({text:a.input,schema:e});if(!1===f.success)throw new aG({toolName:c,toolInput:a.input,cause:f.error});return"dynamic"===d.type?{type:"tool-call",toolCallId:a.toolCallId,toolName:a.toolName,input:f.value,providerExecuted:a.providerExecuted,providerMetadata:a.providerMetadata,dynamic:!0}:{type:"tool-call",toolCallId:a.toolCallId,toolName:c,input:f.value,providerExecuted:a.providerExecuted,providerMetadata:a.providerMetadata}}var bW=class{constructor({content:a,finishReason:b,usage:c,warnings:d,request:e,response:f,providerMetadata:g}){this.content=a,this.finishReason=b,this.usage=c,this.warnings=d,this.request=e,this.response=f,this.providerMetadata=g}get text(){return this.content.filter(a=>"text"===a.type).map(a=>a.text).join("")}get reasoning(){return this.content.filter(a=>"reasoning"===a.type)}get reasoningText(){return 0===this.reasoning.length?void 0:this.reasoning.map(a=>a.text).join("")}get files(){return this.content.filter(a=>"file"===a.type).map(a=>a.file)}get sources(){return this.content.filter(a=>"source"===a.type)}get toolCalls(){return this.content.filter(a=>"tool-call"===a.type)}get staticToolCalls(){return this.toolCalls.filter(a=>!1===a.dynamic)}get dynamicToolCalls(){return this.toolCalls.filter(a=>!0===a.dynamic)}get toolResults(){return this.content.filter(a=>"tool-result"===a.type)}get staticToolResults(){return this.toolResults.filter(a=>!1===a.dynamic)}get dynamicToolResults(){return this.toolResults.filter(a=>!0===a.dynamic)}};function bX(a){return({steps:b})=>b.length===a}async function bY({stopConditions:a,steps:b}){return(await Promise.all(a.map(a=>a({steps:b})))).some(a=>a)}function bZ({output:a,tool:b,errorMode:c}){return"text"===c?{type:"error-text",value:(0,D.u1)(a)}:"json"===c?{type:"error-json",value:b$(a)}:(null==b?void 0:b.toModelOutput)?b.toModelOutput(a):"string"==typeof a?{type:"text",value:a}:{type:"json",value:b$(a)}}function b$(a){return void 0===a?null:a}function b_({content:a,tools:b}){let c=[],d=a.filter(a=>"source"!==a.type).filter(a=>("tool-result"!==a.type||a.providerExecuted)&&("tool-error"!==a.type||a.providerExecuted)).filter(a=>"text"!==a.type||a.text.length>0).map(a=>{switch(a.type){case"text":return{type:"text",text:a.text,providerOptions:a.providerMetadata};case"reasoning":return{type:"reasoning",text:a.text,providerOptions:a.providerMetadata};case"file":return{type:"file",data:a.file.base64,mediaType:a.file.mediaType,providerOptions:a.providerMetadata};case"tool-call":return{type:"tool-call",toolCallId:a.toolCallId,toolName:a.toolName,input:a.input,providerExecuted:a.providerExecuted,providerOptions:a.providerMetadata};case"tool-result":return{type:"tool-result",toolCallId:a.toolCallId,toolName:a.toolName,output:bZ({tool:null==b?void 0:b[a.toolName],output:a.output,errorMode:"none"}),providerExecuted:!0,providerOptions:a.providerMetadata};case"tool-error":return{type:"tool-result",toolCallId:a.toolCallId,toolName:a.toolName,output:bZ({tool:null==b?void 0:b[a.toolName],output:a.error,errorMode:"json"}),providerOptions:a.providerMetadata}}});d.length>0&&c.push({role:"assistant",content:d});let e=a.filter(a=>"tool-result"===a.type||"tool-error"===a.type).filter(a=>!a.providerExecuted).map(a=>({type:"tool-result",toolCallId:a.toolCallId,toolName:a.toolName,output:bZ({tool:null==b?void 0:b[a.toolName],output:"tool-result"===a.type?a.output:a.error,errorMode:"tool-error"===a.type?"text":"none"})}));return e.length>0&&c.push({role:"tool",content:e}),c}var b0=(0,C.hK)({prefix:"aitxt",size:24});async function b1({model:a,tools:b,toolChoice:c,system:d,prompt:e,messages:f,maxRetries:g,abortSignal:h,headers:i,stopWhen:j=bX(1),experimental_output:k,experimental_telemetry:l,providerOptions:m,experimental_activeTools:n,activeTools:o=n,experimental_prepareStep:p,prepareStep:q=p,experimental_repairToolCall:r,experimental_context:s,_internal:{generateId:t=b0,currentDate:u=()=>new Date}={},onStepFinish:v,...w}){let x=bd(a),y=bO(j),{maxRetries:z,retry:A}=bQ({maxRetries:g,abortSignal:h}),B=bD({model:x,telemetry:l,headers:i,settings:{...bk(w),maxRetries:z}}),D=await bA({system:d,prompt:e,messages:f}),E=bH(l);try{return await bI({name:"ai.generateText",attributes:bK({telemetry:l,attributes:{...bC({operationId:"ai.generateText",telemetry:l}),...B,"ai.model.provider":x.provider,"ai.model.id":x.modelId,"ai.prompt":{input:()=>JSON.stringify({system:d,prompt:e,messages:f})}}}),tracer:E,fn:async a=>{var e,f,g,j,n,p;let z,F=bk(w),G=[],H=[],I=[],J=[];do{let a=[...D.messages,...I],y=await (null==q?void 0:q({model:x,steps:J,stepNumber:J.length,messages:a})),K=await bi({prompt:{system:null!=(e=null==y?void 0:y.system)?e:D.system,messages:null!=(f=null==y?void 0:y.messages)?f:a},supportedUrls:await x.supportedUrls}),L=bd(null!=(g=null==y?void 0:y.model)?g:x),{toolChoice:M,tools:N}=bl({tools:b,toolChoice:null!=(j=null==y?void 0:y.toolChoice)?j:c,activeTools:null!=(n=null==y?void 0:y.activeTools)?n:o});z=await A(()=>{var a;return bI({name:"ai.generateText.doGenerate",attributes:bK({telemetry:l,attributes:{...bC({operationId:"ai.generateText.doGenerate",telemetry:l}),...B,"ai.model.provider":L.provider,"ai.model.id":L.modelId,"ai.prompt.messages":{input:()=>bL(K)},"ai.prompt.tools":{input:()=>null==N?void 0:N.map(a=>JSON.stringify(a))},"ai.prompt.toolChoice":{input:()=>null!=M?JSON.stringify(M):void 0},"gen_ai.system":L.provider,"gen_ai.request.model":L.modelId,"gen_ai.request.frequency_penalty":w.frequencyPenalty,"gen_ai.request.max_tokens":w.maxOutputTokens,"gen_ai.request.presence_penalty":w.presencePenalty,"gen_ai.request.stop_sequences":w.stopSequences,"gen_ai.request.temperature":null!=(a=w.temperature)?a:void 0,"gen_ai.request.top_k":w.topK,"gen_ai.request.top_p":w.topP}}),tracer:E,fn:async a=>{var b,c,d,e,f,g,j,n;let o=await L.doGenerate({...F,tools:N,toolChoice:M,responseFormat:null==k?void 0:k.responseFormat,prompt:K,providerOptions:m,abortSignal:h,headers:i}),p={id:null!=(c=null==(b=o.response)?void 0:b.id)?c:t(),timestamp:null!=(e=null==(d=o.response)?void 0:d.timestamp)?e:u(),modelId:null!=(g=null==(f=o.response)?void 0:f.modelId)?g:L.modelId,headers:null==(j=o.response)?void 0:j.headers,body:null==(n=o.response)?void 0:n.body};return a.setAttributes(bK({telemetry:l,attributes:{"ai.response.finishReason":o.finishReason,"ai.response.text":{output:()=>bR(o.content)},"ai.response.toolCalls":{output:()=>{let a=b4(o.content);return null==a?void 0:JSON.stringify(a)}},"ai.response.id":p.id,"ai.response.model":p.modelId,"ai.response.timestamp":p.timestamp.toISOString(),"ai.response.providerMetadata":JSON.stringify(o.providerMetadata),"ai.usage.promptTokens":o.usage.inputTokens,"ai.usage.completionTokens":o.usage.outputTokens,"gen_ai.response.finish_reasons":[o.finishReason],"gen_ai.response.id":p.id,"gen_ai.response.model":p.modelId,"gen_ai.usage.input_tokens":o.usage.inputTokens,"gen_ai.usage.output_tokens":o.usage.outputTokens}})),{...o,response:p}}})});let O=await Promise.all(z.content.filter(a=>"tool-call"===a.type).map(c=>bU({toolCall:c,tools:b,repairToolCall:r,system:d,messages:a})));for(let c of O){if(c.invalid)continue;let d=b[c.toolName];(null==d?void 0:d.onInputAvailable)!=null&&await d.onInputAvailable({input:c.input,toolCallId:c.toolCallId,messages:a,abortSignal:h,experimental_context:s})}let P=O.filter(a=>a.invalid&&a.dynamic);for(let a of(H=[],P))H.push({type:"tool-error",toolCallId:a.toolCallId,toolName:a.toolName,input:a.input,error:(0,C.u1)(a.error),dynamic:!0});G=O.filter(a=>!a.providerExecuted),null!=b&&H.push(...await b2({toolCalls:G.filter(a=>!a.invalid),tools:b,tracer:E,telemetry:l,messages:a,abortSignal:h,experimental_context:s}));let Q=function({content:a,toolCalls:b,toolOutputs:c}){return[...a.map(a=>{switch(a.type){case"text":case"reasoning":case"source":return a;case"file":return{type:"file",file:new bS(a)};case"tool-call":return b.find(b=>b.toolCallId===a.toolCallId);case"tool-result":{let c=b.find(b=>b.toolCallId===a.toolCallId);if(null==c)throw Error(`Tool call ${a.toolCallId} not found.`);if(a.isError)return{type:"tool-error",toolCallId:a.toolCallId,toolName:a.toolName,input:c.input,error:a.result,providerExecuted:!0,dynamic:c.dynamic};return{type:"tool-result",toolCallId:a.toolCallId,toolName:a.toolName,input:c.input,output:a.result,providerExecuted:!0,dynamic:c.dynamic}}}}),...c]}({content:z.content,toolCalls:O,toolOutputs:H});I.push(...b_({content:Q,tools:b}));let R=new bW({content:Q,finishReason:z.finishReason,usage:z.usage,warnings:z.warnings,providerMetadata:z.providerMetadata,request:null!=(p=z.request)?p:{},response:{...z.response,messages:structuredClone(I)}});J.push(R),await (null==v?void 0:v(R))}while(G.length>0&&H.length===G.length&&!await bY({stopConditions:y,steps:J}));a.setAttributes(bK({telemetry:l,attributes:{"ai.response.finishReason":z.finishReason,"ai.response.text":{output:()=>bR(z.content)},"ai.response.toolCalls":{output:()=>{let a=b4(z.content);return null==a?void 0:JSON.stringify(a)}},"ai.response.providerMetadata":JSON.stringify(z.providerMetadata),"ai.usage.promptTokens":z.usage.inputTokens,"ai.usage.completionTokens":z.usage.outputTokens}}));let K=J[J.length-1];return new b3({steps:J,resolvedOutput:await (null==k?void 0:k.parseOutput({text:K.text},{response:K.response,usage:K.usage,finishReason:K.finishReason}))})}})}catch(a){throw bB(a)}}async function b2({toolCalls:a,tools:b,tracer:c,telemetry:d,messages:e,abortSignal:f,experimental_context:g}){return(await Promise.all(a.map(async({toolCallId:a,toolName:h,input:i})=>{let j=b[h];if((null==j?void 0:j.execute)!=null)return bI({name:"ai.toolCall",attributes:bK({telemetry:d,attributes:{...bC({operationId:"ai.toolCall",telemetry:d}),"ai.toolCall.name":h,"ai.toolCall.id":a,"ai.toolCall.args":{output:()=>JSON.stringify(i)}}}),tracer:c,fn:async b=>{try{let c;for await(let b of(0,C.o8)({execute:j.execute.bind(j),input:i,options:{toolCallId:a,messages:e,abortSignal:f,experimental_context:g}}))"final"===b.type&&(c=b.output);try{b.setAttributes(bK({telemetry:d,attributes:{"ai.toolCall.result":{output:()=>JSON.stringify(c)}}}))}catch(a){}return{type:"tool-result",toolCallId:a,toolName:h,input:i,output:c,dynamic:"dynamic"===j.type}}catch(c){return bJ(b,c),{type:"tool-error",toolCallId:a,toolName:h,input:i,error:c,dynamic:"dynamic"===j.type}}}})}))).filter(a=>null!=a)}var b3=class{constructor(a){this.steps=a.steps,this.resolvedOutput=a.resolvedOutput}get finalStep(){return this.steps[this.steps.length-1]}get content(){return this.finalStep.content}get text(){return this.finalStep.text}get files(){return this.finalStep.files}get reasoningText(){return this.finalStep.reasoningText}get reasoning(){return this.finalStep.reasoning}get toolCalls(){return this.finalStep.toolCalls}get staticToolCalls(){return this.finalStep.staticToolCalls}get dynamicToolCalls(){return this.finalStep.dynamicToolCalls}get toolResults(){return this.finalStep.toolResults}get staticToolResults(){return this.finalStep.staticToolResults}get dynamicToolResults(){return this.finalStep.dynamicToolResults}get sources(){return this.finalStep.sources}get finishReason(){return this.finalStep.finishReason}get warnings(){return this.finalStep.warnings}get providerMetadata(){return this.finalStep.providerMetadata}get response(){return this.finalStep.response}get request(){return this.finalStep.request}get usage(){return this.finalStep.usage}get totalUsage(){return this.steps.reduce((a,b)=>bM(a,b.usage),{inputTokens:void 0,outputTokens:void 0,totalTokens:void 0,reasoningTokens:void 0,cachedInputTokens:void 0})}get experimental_output(){if(null==this.resolvedOutput)throw new ay;return this.resolvedOutput}};function b4(a){let b=a.filter(a=>"tool-call"===a.type);if(0!==b.length)return b.map(a=>({toolCallId:a.toolCallId,toolName:a.toolName,input:a.input}))}function b5(a,b){let c=new Headers(null!=a?a:{});for(let[a,d]of Object.entries(b))c.has(a)||c.set(a,d);return c}function b6({response:a,status:b,statusText:c,headers:d,stream:e}){a.writeHead(null!=b?b:200,c,d);let f=e.getReader();(async()=>{try{for(;;){let{done:b,value:c}=await f.read();if(b)break;a.write(c)}}catch(a){throw a}finally{a.end()}})()}var b7=class extends TransformStream{constructor(){super({transform(a,b){b.enqueue(`data: ${JSON.stringify(a)}

`)},flush(a){a.enqueue("data: [DONE]\n\n")}})}},b8={"content-type":"text/event-stream","cache-control":"no-cache",connection:"keep-alive","x-vercel-ai-ui-message-stream":"v1","x-accel-buffering":"no"};async function b9(a){if(void 0===a)return{value:void 0,state:"undefined-input"};let b=await (0,C.N8)({text:a});return b.success?{value:b.value,state:"successful-parse"}:(b=await (0,C.N8)({text:function(a){let b=["ROOT"],c=-1,d=null;function e(a,e,f){switch(a){case'"':c=e,b.pop(),b.push(f),b.push("INSIDE_STRING");break;case"f":case"t":case"n":c=e,d=e,b.pop(),b.push(f),b.push("INSIDE_LITERAL");break;case"-":b.pop(),b.push(f),b.push("INSIDE_NUMBER");break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":c=e,b.pop(),b.push(f),b.push("INSIDE_NUMBER");break;case"{":c=e,b.pop(),b.push(f),b.push("INSIDE_OBJECT_START");break;case"[":c=e,b.pop(),b.push(f),b.push("INSIDE_ARRAY_START")}}function f(a,d){switch(a){case",":b.pop(),b.push("INSIDE_OBJECT_AFTER_COMMA");break;case"}":c=d,b.pop()}}function g(a,d){switch(a){case",":b.pop(),b.push("INSIDE_ARRAY_AFTER_COMMA");break;case"]":c=d,b.pop()}}for(let h=0;h<a.length;h++){let i=a[h];switch(b[b.length-1]){case"ROOT":e(i,h,"FINISH");break;case"INSIDE_OBJECT_START":switch(i){case'"':b.pop(),b.push("INSIDE_OBJECT_KEY");break;case"}":c=h,b.pop()}break;case"INSIDE_OBJECT_AFTER_COMMA":'"'===i&&(b.pop(),b.push("INSIDE_OBJECT_KEY"));break;case"INSIDE_OBJECT_KEY":'"'===i&&(b.pop(),b.push("INSIDE_OBJECT_AFTER_KEY"));break;case"INSIDE_OBJECT_AFTER_KEY":":"===i&&(b.pop(),b.push("INSIDE_OBJECT_BEFORE_VALUE"));break;case"INSIDE_OBJECT_BEFORE_VALUE":e(i,h,"INSIDE_OBJECT_AFTER_VALUE");break;case"INSIDE_OBJECT_AFTER_VALUE":f(i,h);break;case"INSIDE_STRING":switch(i){case'"':b.pop(),c=h;break;case"\\":b.push("INSIDE_STRING_ESCAPE");break;default:c=h}break;case"INSIDE_ARRAY_START":"]"===i?(c=h,b.pop()):(c=h,e(i,h,"INSIDE_ARRAY_AFTER_VALUE"));break;case"INSIDE_ARRAY_AFTER_VALUE":switch(i){case",":b.pop(),b.push("INSIDE_ARRAY_AFTER_COMMA");break;case"]":c=h,b.pop();break;default:c=h}break;case"INSIDE_ARRAY_AFTER_COMMA":e(i,h,"INSIDE_ARRAY_AFTER_VALUE");break;case"INSIDE_STRING_ESCAPE":b.pop(),c=h;break;case"INSIDE_NUMBER":switch(i){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":c=h;break;case"e":case"E":case"-":case".":break;case",":b.pop(),"INSIDE_ARRAY_AFTER_VALUE"===b[b.length-1]&&g(i,h),"INSIDE_OBJECT_AFTER_VALUE"===b[b.length-1]&&f(i,h);break;case"}":b.pop(),"INSIDE_OBJECT_AFTER_VALUE"===b[b.length-1]&&f(i,h);break;case"]":b.pop(),"INSIDE_ARRAY_AFTER_VALUE"===b[b.length-1]&&g(i,h);break;default:b.pop()}break;case"INSIDE_LITERAL":{let e=a.substring(d,h+1);"false".startsWith(e)||"true".startsWith(e)||"null".startsWith(e)?c=h:(b.pop(),"INSIDE_OBJECT_AFTER_VALUE"===b[b.length-1]?f(i,h):"INSIDE_ARRAY_AFTER_VALUE"===b[b.length-1]&&g(i,h))}}}let h=a.slice(0,c+1);for(let c=b.length-1;c>=0;c--)switch(b[c]){case"INSIDE_STRING":h+='"';break;case"INSIDE_OBJECT_KEY":case"INSIDE_OBJECT_AFTER_KEY":case"INSIDE_OBJECT_AFTER_COMMA":case"INSIDE_OBJECT_START":case"INSIDE_OBJECT_BEFORE_VALUE":case"INSIDE_OBJECT_AFTER_VALUE":h+="}";break;case"INSIDE_ARRAY_START":case"INSIDE_ARRAY_AFTER_COMMA":case"INSIDE_ARRAY_AFTER_VALUE":h+="]";break;case"INSIDE_LITERAL":{let b=a.substring(d,a.length);"true".startsWith(b)?h+="true".slice(b.length):"false".startsWith(b)?h+="false".slice(b.length):"null".startsWith(b)&&(h+="null".slice(b.length))}}return h}(a)})).success?{value:b.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"}}function ca(a){return a.type.startsWith("tool-")}function cb(a){return a.type.split("-").slice(1).join("-")}function cc(a){let b=a.pipeThrough(new TransformStream);return b[Symbol.asyncIterator]=()=>{let a=b.getReader();return{async next(){let{done:b,value:c}=await a.read();return b?{done:!0,value:void 0}:{done:!1,value:c}}}},b}async function cd({stream:a,onError:b}){let c=a.getReader();try{for(;;){let{done:a}=await c.read();if(a)break}}catch(a){null==b||b(a)}finally{c.releaseLock()}}function ce(){let a,b;return{promise:new Promise((c,d)=>{a=c,b=d}),resolve:a,reject:b}}E.KC([E.re({type:E.eu("text-start"),id:E.Yj(),providerMetadata:bn.optional()}),E.re({type:E.eu("text-delta"),id:E.Yj(),delta:E.Yj(),providerMetadata:bn.optional()}),E.re({type:E.eu("text-end"),id:E.Yj(),providerMetadata:bn.optional()}),E.re({type:E.eu("error"),errorText:E.Yj()}),E.re({type:E.eu("tool-input-start"),toolCallId:E.Yj(),toolName:E.Yj(),providerExecuted:E.zM().optional(),dynamic:E.zM().optional()}),E.re({type:E.eu("tool-input-delta"),toolCallId:E.Yj(),inputTextDelta:E.Yj()}),E.re({type:E.eu("tool-input-available"),toolCallId:E.Yj(),toolName:E.Yj(),input:E.L5(),providerExecuted:E.zM().optional(),providerMetadata:bn.optional(),dynamic:E.zM().optional()}),E.re({type:E.eu("tool-input-error"),toolCallId:E.Yj(),toolName:E.Yj(),input:E.L5(),providerExecuted:E.zM().optional(),providerMetadata:bn.optional(),dynamic:E.zM().optional(),errorText:E.Yj()}),E.re({type:E.eu("tool-output-available"),toolCallId:E.Yj(),output:E.L5(),providerExecuted:E.zM().optional(),dynamic:E.zM().optional(),preliminary:E.zM().optional()}),E.re({type:E.eu("tool-output-error"),toolCallId:E.Yj(),errorText:E.Yj(),providerExecuted:E.zM().optional(),dynamic:E.zM().optional()}),E.re({type:E.eu("reasoning"),text:E.Yj(),providerMetadata:bn.optional()}),E.re({type:E.eu("reasoning-start"),id:E.Yj(),providerMetadata:bn.optional()}),E.re({type:E.eu("reasoning-delta"),id:E.Yj(),delta:E.Yj(),providerMetadata:bn.optional()}),E.re({type:E.eu("reasoning-end"),id:E.Yj(),providerMetadata:bn.optional()}),E.re({type:E.eu("reasoning-part-finish")}),E.re({type:E.eu("source-url"),sourceId:E.Yj(),url:E.Yj(),title:E.Yj().optional(),providerMetadata:bn.optional()}),E.re({type:E.eu("source-document"),sourceId:E.Yj(),mediaType:E.Yj(),title:E.Yj(),filename:E.Yj().optional(),providerMetadata:bn.optional()}),E.re({type:E.eu("file"),url:E.Yj(),mediaType:E.Yj(),providerMetadata:bn.optional()}),E.re({type:E.Yj().startsWith("data-"),id:E.Yj().optional(),data:E.L5(),transient:E.zM().optional()}),E.re({type:E.eu("start-step")}),E.re({type:E.eu("finish-step")}),E.re({type:E.eu("start"),messageId:E.Yj().optional(),messageMetadata:E.L5().optional()}),E.re({type:E.eu("finish"),messageMetadata:E.L5().optional()}),E.re({type:E.eu("abort")}),E.re({type:E.eu("message-metadata"),messageMetadata:E.L5()})]);var cf=class{constructor(){this.status={type:"pending"},this._resolve=void 0,this._reject=void 0}get promise(){return this._promise||(this._promise=new Promise((a,b)=>{"resolved"===this.status.type?a(this.status.value):"rejected"===this.status.type&&b(this.status.error),this._resolve=a,this._reject=b})),this._promise}resolve(a){var b;this.status={type:"resolved",value:a},this._promise&&(null==(b=this._resolve)||b.call(this,a))}reject(a){var b;this.status={type:"rejected",error:a},this._promise&&(null==(b=this._reject)||b.call(this,a))}};function cg(){var a,b;return null!=(b=null==(a=null==globalThis?void 0:globalThis.performance)?void 0:a.now())?b:Date.now()}var ch=(0,C.hK)({prefix:"aitxt",size:24});function ci({model:a,tools:b,toolChoice:c,system:d,prompt:e,messages:f,maxRetries:g,abortSignal:h,headers:i,stopWhen:j=bX(1),experimental_output:k,experimental_telemetry:l,prepareStep:m,providerOptions:n,experimental_activeTools:o,activeTools:p=o,experimental_repairToolCall:q,experimental_transform:r,includeRawChunks:s=!1,onChunk:t,onError:u=({error:a})=>{console.error(a)},onFinish:v,onAbort:w,onStepFinish:x,experimental_context:y,_internal:{now:z=cg,generateId:A=ch,currentDate:B=()=>new Date}={},...C}){return new cj({model:bd(a),telemetry:l,headers:i,settings:C,maxRetries:g,abortSignal:h,system:d,prompt:e,messages:f,tools:b,toolChoice:c,transforms:bO(r),activeTools:p,repairToolCall:q,stopConditions:bO(j),output:k,providerOptions:n,prepareStep:m,includeRawChunks:s,onChunk:t,onError:u,onFinish:v,onAbort:w,onStepFinish:x,now:z,currentDate:B,generateId:A,experimental_context:y})}var cj=class{constructor({model:a,telemetry:b,headers:c,settings:d,maxRetries:e,abortSignal:f,system:g,prompt:h,messages:i,tools:j,toolChoice:k,transforms:l,activeTools:m,repairToolCall:n,stopConditions:o,output:p,providerOptions:q,prepareStep:r,includeRawChunks:s,now:t,currentDate:u,generateId:v,onChunk:w,onError:x,onFinish:y,onAbort:z,onStepFinish:A,experimental_context:B}){let D,E,F,G;this._totalUsage=new cf,this._finishReason=new cf,this._steps=new cf,this.output=p,this.includeRawChunks=s,this.tools=j;let H=[],I=[],J={},K=[],L=[],M={},N={},O=new TransformStream({async transform(a,b){var c,d,e;b.enqueue(a);let{part:f}=a;if(("text-delta"===f.type||"reasoning-delta"===f.type||"source"===f.type||"tool-call"===f.type||"tool-result"===f.type||"tool-input-start"===f.type||"tool-input-delta"===f.type||"raw"===f.type)&&await (null==w?void 0:w({chunk:f})),"error"===f.type&&await x({error:bB(f.error)}),"text-start"===f.type&&(M[f.id]={type:"text",text:"",providerMetadata:f.providerMetadata},H.push(M[f.id])),"text-delta"===f.type){let a=M[f.id];if(null==a)return void b.enqueue({part:{type:"error",error:`text part ${f.id} not found`},partialOutput:void 0});a.text+=f.text,a.providerMetadata=null!=(c=f.providerMetadata)?c:a.providerMetadata}if("text-end"===f.type&&delete M[f.id],"reasoning-start"===f.type&&(N[f.id]={type:"reasoning",text:"",providerMetadata:f.providerMetadata},H.push(N[f.id])),"reasoning-delta"===f.type){let a=N[f.id];if(null==a)return void b.enqueue({part:{type:"error",error:`reasoning part ${f.id} not found`},partialOutput:void 0});a.text+=f.text,a.providerMetadata=null!=(d=f.providerMetadata)?d:a.providerMetadata}if("reasoning-end"===f.type){let a=N[f.id];if(null==a)return void b.enqueue({part:{type:"error",error:`reasoning part ${f.id} not found`},partialOutput:void 0});a.providerMetadata=null!=(e=f.providerMetadata)?e:a.providerMetadata,delete N[f.id]}if("file"===f.type&&H.push({type:"file",file:f.file}),"source"===f.type&&H.push(f),"tool-call"===f.type&&H.push(f),"tool-result"!==f.type||f.preliminary||H.push(f),"tool-error"===f.type&&H.push(f),"start-step"===f.type&&(J=f.request,K=f.warnings),"finish-step"===f.type){let a=b_({content:H,tools:j}),b=new bW({content:H,finishReason:f.finishReason,usage:f.usage,warnings:K,request:J,response:{...f.response,messages:[...I,...a]},providerMetadata:f.providerMetadata});await (null==A?void 0:A(b)),L.push(b),H=[],N={},M={},I.push(...a),D.resolve()}"finish"===f.type&&(G=f.totalUsage,F=f.finishReason)},async flush(a){try{if(0===L.length){let a=new aO({message:"No output generated. Check the stream for errors."});W._finishReason.reject(a),W._totalUsage.reject(a),W._steps.reject(a);return}let a=null!=F?F:"unknown",c=null!=G?G:{inputTokens:void 0,outputTokens:void 0,totalTokens:void 0};W._finishReason.resolve(a),W._totalUsage.resolve(c),W._steps.resolve(L);let d=L[L.length-1];await (null==y?void 0:y({finishReason:a,totalUsage:c,usage:d.usage,content:d.content,text:d.text,reasoningText:d.reasoningText,reasoning:d.reasoning,files:d.files,sources:d.sources,toolCalls:d.toolCalls,staticToolCalls:d.staticToolCalls,dynamicToolCalls:d.dynamicToolCalls,toolResults:d.toolResults,staticToolResults:d.staticToolResults,dynamicToolResults:d.dynamicToolResults,request:d.request,response:d.response,warnings:d.warnings,providerMetadata:d.providerMetadata,steps:L})),E.setAttributes(bK({telemetry:b,attributes:{"ai.response.finishReason":a,"ai.response.text":{output:()=>d.text},"ai.response.toolCalls":{output:()=>{var a;return(null==(a=d.toolCalls)?void 0:a.length)?JSON.stringify(d.toolCalls):void 0}},"ai.response.providerMetadata":JSON.stringify(d.providerMetadata),"ai.usage.inputTokens":c.inputTokens,"ai.usage.outputTokens":c.outputTokens,"ai.usage.totalTokens":c.totalTokens,"ai.usage.reasoningTokens":c.reasoningTokens,"ai.usage.cachedInputTokens":c.cachedInputTokens}}))}catch(b){a.error(b)}finally{E.end()}}}),P=function(){let a=[],b=null,c=!1,d=ce(),e=()=>{c=!0,d.resolve(),a.forEach(a=>a.cancel()),a=[],null==b||b.close()},f=async()=>{if(c&&0===a.length){null==b||b.close();return}if(0===a.length)return d=ce(),await d.promise,f();try{let{value:d,done:e}=await a[0].read();e?(a.shift(),a.length>0?await f():c&&(null==b||b.close())):null==b||b.enqueue(d)}catch(c){null==b||b.error(c),a.shift(),e()}};return{stream:new ReadableStream({start(a){b=a},pull:f,async cancel(){for(let b of a)await b.cancel();a=[],c=!0}}),addStream:b=>{if(c)throw Error("Cannot add inner stream: outer stream is closed");a.push(b.getReader()),d.resolve()},close:()=>{c=!0,d.resolve(),0===a.length&&(null==b||b.close())},terminate:e}}();this.addStream=P.addStream,this.closeStream=P.close;let Q=P.stream;for(let a of(Q=(Q=function(a,b){return new ReadableStream({async start(c){let d=a.getReader();try{for(;;){let{done:a,value:b}=await d.read();if(a){c.close();break}c.enqueue(b)}}catch(a){await b({error:a,controller:c})}},cancel:b=>a.cancel(b)})}(Q,({error:a,controller:b})=>{(0,C.zf)(a)&&(null==f?void 0:f.aborted)?(null==z||z({steps:L}),b.enqueue({type:"abort"}),b.close()):b.error(a)})).pipeThrough(new TransformStream({start(a){a.enqueue({type:"start"})}})),l))Q=Q.pipeThrough(a({tools:j,stopStream(){P.terminate()}}));this.baseStream=Q.pipeThrough(function(a){let b;if(!a)return new TransformStream({transform(a,b){b.enqueue({part:a,partialOutput:void 0})}});let c="",d="",e="";function f({controller:a,partialOutput:c}){a.enqueue({part:{type:"text-delta",id:b,text:d},partialOutput:c}),d=""}return new TransformStream({async transform(g,h){if("finish-step"===g.type&&d.length>0&&f({controller:h}),"text-delta"!==g.type&&"text-start"!==g.type&&"text-end"!==g.type)return void h.enqueue({part:g,partialOutput:void 0});if(null==b)b=g.id;else if(g.id!==b)return void h.enqueue({part:g,partialOutput:void 0});if("text-start"===g.type)return void h.enqueue({part:g,partialOutput:void 0});if("text-end"===g.type){d.length>0&&f({controller:h}),h.enqueue({part:g,partialOutput:void 0});return}c+=g.text,d+=g.text;let i=await a.parsePartial({text:c});if(null!=i){let a=JSON.stringify(i.partial);a!==e&&(f({controller:h,partialOutput:i.partial}),e=a)}}})}(p)).pipeThrough(O);let{maxRetries:R,retry:S}=bQ({maxRetries:e,abortSignal:f}),T=bH(b),U=bk(d),V=bD({model:a,telemetry:b,headers:c,settings:{...U,maxRetries:R}}),W=this;bI({name:"ai.streamText",attributes:bK({telemetry:b,attributes:{...bC({operationId:"ai.streamText",telemetry:b}),...V,"ai.prompt":{input:()=>JSON.stringify({system:g,prompt:h,messages:i})}}}),tracer:T,endWhenDone:!1,fn:async d=>{async function e({currentStep:d,responseMessages:l,usage:s}){var w,x,y,z,A;let E,F,G=W.includeRawChunks;D=new cf;let H=await bA({system:g,prompt:h,messages:i}),I=[...H.messages,...l],J=await (null==r?void 0:r({model:a,steps:L,stepNumber:L.length,messages:I})),K=await bi({prompt:{system:null!=(w=null==J?void 0:J.system)?w:H.system,messages:null!=(x=null==J?void 0:J.messages)?x:I},supportedUrls:await a.supportedUrls}),M=bd(null!=(y=null==J?void 0:J.model)?y:a),{toolChoice:N,tools:O}=bl({tools:j,toolChoice:null!=(z=null==J?void 0:J.toolChoice)?z:k,activeTools:null!=(A=null==J?void 0:J.activeTools)?A:m}),{result:{stream:P,response:Q,request:R},doStreamSpan:X,startTimestampMs:Y}=await S(()=>bI({name:"ai.streamText.doStream",attributes:bK({telemetry:b,attributes:{...bC({operationId:"ai.streamText.doStream",telemetry:b}),...V,"ai.model.provider":M.provider,"ai.model.id":M.modelId,"ai.prompt.messages":{input:()=>bL(K)},"ai.prompt.tools":{input:()=>null==O?void 0:O.map(a=>JSON.stringify(a))},"ai.prompt.toolChoice":{input:()=>null!=N?JSON.stringify(N):void 0},"gen_ai.system":M.provider,"gen_ai.request.model":M.modelId,"gen_ai.request.frequency_penalty":U.frequencyPenalty,"gen_ai.request.max_tokens":U.maxOutputTokens,"gen_ai.request.presence_penalty":U.presencePenalty,"gen_ai.request.stop_sequences":U.stopSequences,"gen_ai.request.temperature":U.temperature,"gen_ai.request.top_k":U.topK,"gen_ai.request.top_p":U.topP}}),tracer:T,endWhenDone:!1,fn:async a=>({startTimestampMs:t(),doStreamSpan:a,result:await M.doStream({...U,tools:O,toolChoice:N,responseFormat:null==p?void 0:p.responseFormat,prompt:K,providerOptions:q,abortSignal:f,headers:c,includeRawChunks:G})})})),Z=function({tools:a,generatorStream:b,tracer:c,telemetry:d,system:e,messages:f,abortSignal:g,repairToolCall:h,experimental_context:i}){let j,k=null,l=new ReadableStream({start(a){k=a}}),m=new Set,n=new Map,o=!1;function p(){o&&0===m.size&&(null!=j&&k.enqueue(j),k.close())}let q=new TransformStream({async transform(b,l){let o=b.type;switch(o){case"stream-start":case"text-start":case"text-delta":case"text-end":case"reasoning-start":case"reasoning-delta":case"reasoning-end":case"tool-input-start":case"tool-input-delta":case"tool-input-end":case"source":case"response-metadata":case"error":case"raw":l.enqueue(b);break;case"file":l.enqueue({type:"file",file:new bT({data:b.data,mediaType:b.mediaType})});break;case"finish":j={type:"finish",finishReason:b.finishReason,usage:b.usage,providerMetadata:b.providerMetadata};break;case"tool-call":try{let j=await bU({toolCall:b,tools:a,repairToolCall:h,system:e,messages:f});if(l.enqueue(j),j.invalid){k.enqueue({type:"tool-error",toolCallId:j.toolCallId,toolName:j.toolName,input:j.input,error:(0,C.u1)(j.error),dynamic:!0});break}let o=a[j.toolName];if(n.set(j.toolCallId,j.input),null!=o.onInputAvailable&&await o.onInputAvailable({input:j.input,toolCallId:j.toolCallId,messages:f,abortSignal:g,experimental_context:i}),null!=o.execute&&!0!==j.providerExecuted){let a=(0,C.$C)();m.add(a),bI({name:"ai.toolCall",attributes:bK({telemetry:d,attributes:{...bC({operationId:"ai.toolCall",telemetry:d}),"ai.toolCall.name":j.toolName,"ai.toolCall.id":j.toolCallId,"ai.toolCall.args":{output:()=>JSON.stringify(j.input)}}}),tracer:c,fn:async b=>{let c;try{for await(let a of(0,C.o8)({execute:o.execute.bind(o),input:j.input,options:{toolCallId:j.toolCallId,messages:f,abortSignal:g,experimental_context:i}}))k.enqueue({...j,type:"tool-result",output:a.output,..."preliminary"===a.type&&{preliminary:!0}}),"final"===a.type&&(c=a.output)}catch(c){bJ(b,c),k.enqueue({...j,type:"tool-error",error:c}),m.delete(a),p();return}m.delete(a),p();try{b.setAttributes(bK({telemetry:d,attributes:{"ai.toolCall.result":{output:()=>JSON.stringify(c)}}}))}catch(a){}}})}}catch(a){k.enqueue({type:"error",error:a})}break;case"tool-result":{let a=b.toolName;b.isError?k.enqueue({type:"tool-error",toolCallId:b.toolCallId,toolName:a,input:n.get(b.toolCallId),providerExecuted:b.providerExecuted,error:b.result}):l.enqueue({type:"tool-result",toolCallId:b.toolCallId,toolName:a,input:n.get(b.toolCallId),output:b.result,providerExecuted:b.providerExecuted});break}default:throw Error(`Unhandled chunk type: ${o}`)}},flush(){o=!0,p()}});return new ReadableStream({start:async a=>Promise.all([b.pipeThrough(q).pipeTo(new WritableStream({write(b){a.enqueue(b)},close(){}})),l.pipeTo(new WritableStream({write(b){a.enqueue(b)},close(){a.close()}}))])})}({tools:j,generatorStream:P,tracer:T,telemetry:b,system:g,messages:I,repairToolCall:n,abortSignal:f,experimental_context:B}),$=null!=R?R:{},_=[],aa=[],ab={},ac="unknown",ad={inputTokens:void 0,outputTokens:void 0,totalTokens:void 0},ae=!0,af={id:v(),timestamp:u(),modelId:a.modelId},ag="";W.addStream(Z.pipeThrough(new TransformStream({async transform(a,b){var c,d,e,g;if("stream-start"===a.type){E=a.warnings;return}if(ae){let a=t()-Y;ae=!1,X.addEvent("ai.stream.firstChunk",{"ai.response.msToFirstChunk":a}),X.setAttributes({"ai.response.msToFirstChunk":a}),b.enqueue({type:"start-step",request:$,warnings:null!=E?E:[]})}let h=a.type;switch(h){case"text-start":case"text-end":case"reasoning-start":case"reasoning-end":case"file":case"source":b.enqueue(a);break;case"text-delta":a.delta.length>0&&(b.enqueue({type:"text-delta",id:a.id,text:a.delta,providerMetadata:a.providerMetadata}),ag+=a.delta);break;case"reasoning-delta":b.enqueue({type:"reasoning-delta",id:a.id,text:a.delta,providerMetadata:a.providerMetadata});break;case"tool-call":b.enqueue(a),_.push(a);break;case"tool-result":b.enqueue(a),a.preliminary||aa.push(a);break;case"tool-error":b.enqueue(a),aa.push(a);break;case"response-metadata":af={id:null!=(c=a.id)?c:af.id,timestamp:null!=(d=a.timestamp)?d:af.timestamp,modelId:null!=(e=a.modelId)?e:af.modelId};break;case"finish":{ad=a.usage,ac=a.finishReason,F=a.providerMetadata;let b=t()-Y;X.addEvent("ai.stream.finish"),X.setAttributes({"ai.response.msToFinish":b,"ai.response.avgOutputTokensPerSecond":1e3*(null!=(g=ad.outputTokens)?g:0)/b});break}case"tool-input-start":{ab[a.id]=a.toolName;let c=null==j?void 0:j[a.toolName];(null==c?void 0:c.onInputStart)!=null&&await c.onInputStart({toolCallId:a.id,messages:I,abortSignal:f,experimental_context:B}),b.enqueue({...a,dynamic:(null==c?void 0:c.type)==="dynamic"});break}case"tool-input-end":delete ab[a.id],b.enqueue(a);break;case"tool-input-delta":{let c=ab[a.id],d=null==j?void 0:j[c];(null==d?void 0:d.onInputDelta)!=null&&await d.onInputDelta({inputTextDelta:a.delta,toolCallId:a.id,messages:I,abortSignal:f,experimental_context:B}),b.enqueue(a);break}case"error":b.enqueue(a),ac="error";break;case"raw":G&&b.enqueue(a);break;default:throw Error(`Unknown chunk type: ${h}`)}},async flush(a){let c=_.length>0?JSON.stringify(_):void 0;try{X.setAttributes(bK({telemetry:b,attributes:{"ai.response.finishReason":ac,"ai.response.text":{output:()=>ag},"ai.response.toolCalls":{output:()=>c},"ai.response.id":af.id,"ai.response.model":af.modelId,"ai.response.timestamp":af.timestamp.toISOString(),"ai.response.providerMetadata":JSON.stringify(F),"ai.usage.inputTokens":ad.inputTokens,"ai.usage.outputTokens":ad.outputTokens,"ai.usage.totalTokens":ad.totalTokens,"ai.usage.reasoningTokens":ad.reasoningTokens,"ai.usage.cachedInputTokens":ad.cachedInputTokens,"gen_ai.response.finish_reasons":[ac],"gen_ai.response.id":af.id,"gen_ai.response.model":af.modelId,"gen_ai.usage.input_tokens":ad.inputTokens,"gen_ai.usage.output_tokens":ad.outputTokens}}))}catch(a){}finally{X.end()}a.enqueue({type:"finish-step",finishReason:ac,usage:ad,providerMetadata:F,response:{...af,headers:null==Q?void 0:Q.headers}});let f=bM(s,ad);await D.promise;let g=_.filter(a=>!0!==a.providerExecuted),h=aa.filter(a=>!0!==a.providerExecuted);if(g.length>0&&h.length===g.length&&!await bY({stopConditions:o,steps:L})){l.push(...b_({content:L[L.length-1].content,tools:j}));try{await e({currentStep:d+1,responseMessages:l,usage:f})}catch(b){a.enqueue({type:"error",error:b}),W.closeStream()}}else a.enqueue({type:"finish",finishReason:ac,totalUsage:f}),W.closeStream()}})))}E=d,await e({currentStep:0,responseMessages:[],usage:{inputTokens:void 0,outputTokens:void 0,totalTokens:void 0}})}}).catch(a=>{W.addStream(new ReadableStream({start(b){b.enqueue({type:"error",error:a}),b.close()}})),W.closeStream()})}get steps(){return this.consumeStream(),this._steps.promise}get finalStep(){return this.steps.then(a=>a[a.length-1])}get content(){return this.finalStep.then(a=>a.content)}get warnings(){return this.finalStep.then(a=>a.warnings)}get providerMetadata(){return this.finalStep.then(a=>a.providerMetadata)}get text(){return this.finalStep.then(a=>a.text)}get reasoningText(){return this.finalStep.then(a=>a.reasoningText)}get reasoning(){return this.finalStep.then(a=>a.reasoning)}get sources(){return this.finalStep.then(a=>a.sources)}get files(){return this.finalStep.then(a=>a.files)}get toolCalls(){return this.finalStep.then(a=>a.toolCalls)}get staticToolCalls(){return this.finalStep.then(a=>a.staticToolCalls)}get dynamicToolCalls(){return this.finalStep.then(a=>a.dynamicToolCalls)}get toolResults(){return this.finalStep.then(a=>a.toolResults)}get staticToolResults(){return this.finalStep.then(a=>a.staticToolResults)}get dynamicToolResults(){return this.finalStep.then(a=>a.dynamicToolResults)}get usage(){return this.finalStep.then(a=>a.usage)}get request(){return this.finalStep.then(a=>a.request)}get response(){return this.finalStep.then(a=>a.response)}get totalUsage(){return this.consumeStream(),this._totalUsage.promise}get finishReason(){return this.consumeStream(),this._finishReason.promise}teeStream(){let[a,b]=this.baseStream.tee();return this.baseStream=b,a}get textStream(){return cc(this.teeStream().pipeThrough(new TransformStream({transform({part:a},b){"text-delta"===a.type&&b.enqueue(a.text)}})))}get fullStream(){return cc(this.teeStream().pipeThrough(new TransformStream({transform({part:a},b){b.enqueue(a)}})))}async consumeStream(a){var b;try{await cd({stream:this.fullStream,onError:null==a?void 0:a.onError})}catch(c){null==(b=null==a?void 0:a.onError)||b.call(a,c)}}get experimental_partialOutputStream(){if(null==this.output)throw new ay;return cc(this.teeStream().pipeThrough(new TransformStream({transform({partialOutput:a},b){null!=a&&b.enqueue(a)}})))}toUIMessageStream({originalMessages:a,generateMessageId:b,onFinish:c,messageMetadata:d,sendReasoning:e=!0,sendSources:f=!1,sendStart:g=!0,sendFinish:h=!0,onError:i=D.u1}={}){let j=null!=b?function({originalMessages:a,responseMessageId:b}){if(null==a)return;let c=a[a.length-1];return(null==c?void 0:c.role)==="assistant"?c.id:"function"==typeof b?b():b}({originalMessages:a,responseMessageId:b}):void 0,k={},l=a=>{var b,c;let d=k[a];return(null==(c=null==(b=this.tools)?void 0:b[d])?void 0:c.type)==="dynamic"||void 0};return cc(function({messageId:a,originalMessages:b=[],onFinish:c,onError:d,stream:e}){let f=null==b?void 0:b[b.length-1];(null==f?void 0:f.role)!=="assistant"?f=void 0:a=f.id;let g=!1,h=e.pipeThrough(new TransformStream({transform(b,c){"start"===b.type&&null==b.messageId&&null!=a&&(b.messageId=a),"abort"===b.type&&(g=!0),c.enqueue(b)}}));if(null==c)return h;let i=function({lastMessage:a,messageId:b}){return{message:(null==a?void 0:a.role)==="assistant"?a:{id:b,metadata:void 0,role:"assistant",parts:[]},activeTextParts:{},activeReasoningParts:{},partialToolCalls:{}}}({lastMessage:f?structuredClone(f):void 0,messageId:null!=a?a:""});return(function({stream:a,messageMetadataSchema:b,dataPartSchemas:c,runUpdateMessageJob:d,onError:e,onToolCall:f,onData:g}){return a.pipeThrough(new TransformStream({async transform(a,h){await d(async({state:d,write:i})=>{var j,k,l,m;function n(a){let b=d.message.parts.filter(ca).find(b=>b.toolCallId===a);if(null==b)throw Error("tool-output-error must be preceded by a tool-input-available");return b}function o(a){let b=d.message.parts.filter(a=>"dynamic-tool"===a.type).find(b=>b.toolCallId===a);if(null==b)throw Error("tool-output-error must be preceded by a tool-input-available");return b}function p(a){var b;let c=d.message.parts.find(b=>ca(b)&&b.toolCallId===a.toolCallId);null!=c?(c.state=a.state,c.input=a.input,c.output=a.output,c.errorText=a.errorText,c.rawInput=a.rawInput,c.preliminary=a.preliminary,c.providerExecuted=null!=(b=a.providerExecuted)?b:c.providerExecuted,null!=a.providerMetadata&&"input-available"===c.state&&(c.callProviderMetadata=a.providerMetadata)):d.message.parts.push({type:`tool-${a.toolName}`,toolCallId:a.toolCallId,state:a.state,input:a.input,output:a.output,rawInput:a.rawInput,errorText:a.errorText,providerExecuted:a.providerExecuted,preliminary:a.preliminary,...null!=a.providerMetadata?{callProviderMetadata:a.providerMetadata}:{}})}function q(a){var b;let c=d.message.parts.find(b=>"dynamic-tool"===b.type&&b.toolCallId===a.toolCallId);null!=c?(c.state=a.state,c.toolName=a.toolName,c.input=a.input,c.output=a.output,c.errorText=a.errorText,c.rawInput=null!=(b=a.rawInput)?b:c.rawInput,c.preliminary=a.preliminary,null!=a.providerMetadata&&"input-available"===c.state&&(c.callProviderMetadata=a.providerMetadata)):d.message.parts.push({type:"dynamic-tool",toolName:a.toolName,toolCallId:a.toolCallId,state:a.state,input:a.input,output:a.output,errorText:a.errorText,preliminary:a.preliminary,...null!=a.providerMetadata?{callProviderMetadata:a.providerMetadata}:{}})}async function r(a){if(null!=a){let c=null!=d.message.metadata?function a(b,c){if(void 0===b&&void 0===c)return;if(void 0===b)return c;if(void 0===c)return b;let d={...b};for(let e in c)if(Object.prototype.hasOwnProperty.call(c,e)){let f=c[e];if(void 0===f)continue;let g=e in b?b[e]:void 0,h=null!==f&&"object"==typeof f&&!Array.isArray(f)&&!(f instanceof Date)&&!(f instanceof RegExp),i=null!=g&&"object"==typeof g&&!Array.isArray(g)&&!(g instanceof Date)&&!(g instanceof RegExp);h&&i?d[e]=a(g,f):d[e]=f}return d}(d.message.metadata,a):a;null!=b&&await (0,C.k5)({value:c,schema:b}),d.message.metadata=c}}switch(a.type){case"text-start":{let b={type:"text",text:"",providerMetadata:a.providerMetadata,state:"streaming"};d.activeTextParts[a.id]=b,d.message.parts.push(b),i();break}case"text-delta":{let b=d.activeTextParts[a.id];b.text+=a.delta,b.providerMetadata=null!=(j=a.providerMetadata)?j:b.providerMetadata,i();break}case"text-end":{let b=d.activeTextParts[a.id];b.state="done",b.providerMetadata=null!=(k=a.providerMetadata)?k:b.providerMetadata,delete d.activeTextParts[a.id],i();break}case"reasoning-start":{let b={type:"reasoning",text:"",providerMetadata:a.providerMetadata,state:"streaming"};d.activeReasoningParts[a.id]=b,d.message.parts.push(b),i();break}case"reasoning-delta":{let b=d.activeReasoningParts[a.id];b.text+=a.delta,b.providerMetadata=null!=(l=a.providerMetadata)?l:b.providerMetadata,i();break}case"reasoning-end":{let b=d.activeReasoningParts[a.id];b.providerMetadata=null!=(m=a.providerMetadata)?m:b.providerMetadata,b.state="done",delete d.activeReasoningParts[a.id],i();break}case"file":d.message.parts.push({type:"file",mediaType:a.mediaType,url:a.url}),i();break;case"source-url":d.message.parts.push({type:"source-url",sourceId:a.sourceId,url:a.url,title:a.title,providerMetadata:a.providerMetadata}),i();break;case"source-document":d.message.parts.push({type:"source-document",sourceId:a.sourceId,mediaType:a.mediaType,title:a.title,filename:a.filename,providerMetadata:a.providerMetadata}),i();break;case"tool-input-start":{let b=d.message.parts.filter(ca);d.partialToolCalls[a.toolCallId]={text:"",toolName:a.toolName,index:b.length,dynamic:a.dynamic},a.dynamic?q({toolCallId:a.toolCallId,toolName:a.toolName,state:"input-streaming",input:void 0}):p({toolCallId:a.toolCallId,toolName:a.toolName,state:"input-streaming",input:void 0,providerExecuted:a.providerExecuted}),i();break}case"tool-input-delta":{let b=d.partialToolCalls[a.toolCallId];b.text+=a.inputTextDelta;let{value:c}=await b9(b.text);b.dynamic?q({toolCallId:a.toolCallId,toolName:b.toolName,state:"input-streaming",input:c}):p({toolCallId:a.toolCallId,toolName:b.toolName,state:"input-streaming",input:c}),i();break}case"tool-input-available":a.dynamic?q({toolCallId:a.toolCallId,toolName:a.toolName,state:"input-available",input:a.input,providerMetadata:a.providerMetadata}):p({toolCallId:a.toolCallId,toolName:a.toolName,state:"input-available",input:a.input,providerExecuted:a.providerExecuted,providerMetadata:a.providerMetadata}),i(),f&&!a.providerExecuted&&await f({toolCall:a});break;case"tool-input-error":a.dynamic?q({toolCallId:a.toolCallId,toolName:a.toolName,state:"output-error",input:a.input,errorText:a.errorText,providerMetadata:a.providerMetadata}):p({toolCallId:a.toolCallId,toolName:a.toolName,state:"output-error",input:void 0,rawInput:a.input,errorText:a.errorText,providerExecuted:a.providerExecuted,providerMetadata:a.providerMetadata}),i();break;case"tool-output-available":if(a.dynamic){let b=o(a.toolCallId);q({toolCallId:a.toolCallId,toolName:b.toolName,state:"output-available",input:b.input,output:a.output,preliminary:a.preliminary})}else{let b=n(a.toolCallId);p({toolCallId:a.toolCallId,toolName:cb(b),state:"output-available",input:b.input,output:a.output,providerExecuted:a.providerExecuted,preliminary:a.preliminary})}i();break;case"tool-output-error":if(a.dynamic){let b=o(a.toolCallId);q({toolCallId:a.toolCallId,toolName:b.toolName,state:"output-error",input:b.input,errorText:a.errorText})}else{let b=n(a.toolCallId);p({toolCallId:a.toolCallId,toolName:cb(b),state:"output-error",input:b.input,rawInput:b.rawInput,errorText:a.errorText})}i();break;case"start-step":d.message.parts.push({type:"step-start"});break;case"finish-step":d.activeTextParts={},d.activeReasoningParts={};break;case"start":null!=a.messageId&&(d.message.id=a.messageId),await r(a.messageMetadata),(null!=a.messageId||null!=a.messageMetadata)&&i();break;case"finish":case"message-metadata":await r(a.messageMetadata),null!=a.messageMetadata&&i();break;case"error":null==e||e(Error(a.errorText));break;default:if(a.type.startsWith("data-")){if((null==c?void 0:c[a.type])!=null&&await (0,C.k5)({value:a.data,schema:c[a.type]}),a.transient){null==g||g(a);break}let b=null!=a.id?d.message.parts.find(b=>a.type===b.type&&a.id===b.id):void 0;null!=b?b.data=a.data:d.message.parts.push(a),null==g||g(a),i()}}h.enqueue(a)})}}))})({stream:h,runUpdateMessageJob:async a=>{await a({state:i,write:()=>{}})},onError:d}).pipeThrough(new TransformStream({transform(a,b){b.enqueue(a)},async flush(){let a=i.message.id===(null==f?void 0:f.id);await c({isAborted:g,isContinuation:a,responseMessage:i.message,messages:[...a?b.slice(0,-1):b,i.message]})}}))}({stream:this.fullStream.pipeThrough(new TransformStream({transform:async(a,b)=>{let c=null==d?void 0:d({part:a}),m=a.type;switch(m){case"text-start":b.enqueue({type:"text-start",id:a.id,...null!=a.providerMetadata?{providerMetadata:a.providerMetadata}:{}});break;case"text-delta":b.enqueue({type:"text-delta",id:a.id,delta:a.text,...null!=a.providerMetadata?{providerMetadata:a.providerMetadata}:{}});break;case"text-end":b.enqueue({type:"text-end",id:a.id,...null!=a.providerMetadata?{providerMetadata:a.providerMetadata}:{}});break;case"reasoning-start":b.enqueue({type:"reasoning-start",id:a.id,...null!=a.providerMetadata?{providerMetadata:a.providerMetadata}:{}});break;case"reasoning-delta":e&&b.enqueue({type:"reasoning-delta",id:a.id,delta:a.text,...null!=a.providerMetadata?{providerMetadata:a.providerMetadata}:{}});break;case"reasoning-end":b.enqueue({type:"reasoning-end",id:a.id,...null!=a.providerMetadata?{providerMetadata:a.providerMetadata}:{}});break;case"file":b.enqueue({type:"file",mediaType:a.file.mediaType,url:`data:${a.file.mediaType};base64,${a.file.base64}`});break;case"source":f&&"url"===a.sourceType&&b.enqueue({type:"source-url",sourceId:a.id,url:a.url,title:a.title,...null!=a.providerMetadata?{providerMetadata:a.providerMetadata}:{}}),f&&"document"===a.sourceType&&b.enqueue({type:"source-document",sourceId:a.id,mediaType:a.mediaType,title:a.title,filename:a.filename,...null!=a.providerMetadata?{providerMetadata:a.providerMetadata}:{}});break;case"tool-input-start":{k[a.id]=a.toolName;let c=l(a.id);b.enqueue({type:"tool-input-start",toolCallId:a.id,toolName:a.toolName,...null!=a.providerExecuted?{providerExecuted:a.providerExecuted}:{},...null!=c?{dynamic:c}:{}});break}case"tool-input-delta":b.enqueue({type:"tool-input-delta",toolCallId:a.id,inputTextDelta:a.delta});break;case"tool-call":{k[a.toolCallId]=a.toolName;let c=l(a.toolCallId);a.invalid?b.enqueue({type:"tool-input-error",toolCallId:a.toolCallId,toolName:a.toolName,input:a.input,...null!=a.providerExecuted?{providerExecuted:a.providerExecuted}:{},...null!=a.providerMetadata?{providerMetadata:a.providerMetadata}:{},...null!=c?{dynamic:c}:{},errorText:i(a.error)}):b.enqueue({type:"tool-input-available",toolCallId:a.toolCallId,toolName:a.toolName,input:a.input,...null!=a.providerExecuted?{providerExecuted:a.providerExecuted}:{},...null!=a.providerMetadata?{providerMetadata:a.providerMetadata}:{},...null!=c?{dynamic:c}:{}});break}case"tool-result":{let c=l(a.toolCallId);b.enqueue({type:"tool-output-available",toolCallId:a.toolCallId,output:a.output,...null!=a.providerExecuted?{providerExecuted:a.providerExecuted}:{},...null!=a.preliminary?{preliminary:a.preliminary}:{},...null!=c?{dynamic:c}:{}});break}case"tool-error":{let c=l(a.toolCallId);b.enqueue({type:"tool-output-error",toolCallId:a.toolCallId,errorText:i(a.error),...null!=a.providerExecuted?{providerExecuted:a.providerExecuted}:{},...null!=c?{dynamic:c}:{}});break}case"error":b.enqueue({type:"error",errorText:i(a.error)});break;case"start-step":b.enqueue({type:"start-step"});break;case"finish-step":b.enqueue({type:"finish-step"});break;case"start":g&&b.enqueue({type:"start",...null!=c?{messageMetadata:c}:{},...null!=j?{messageId:j}:{}});break;case"finish":h&&b.enqueue({type:"finish",...null!=c?{messageMetadata:c}:{}});break;case"abort":b.enqueue(a);break;case"tool-input-end":case"raw":break;default:throw Error(`Unknown chunk type: ${m}`)}null!=c&&"start"!==m&&"finish"!==m&&b.enqueue({type:"message-metadata",messageMetadata:c})}})),messageId:null!=j?j:null==b?void 0:b(),originalMessages:a,onFinish:c,onError:i}))}pipeUIMessageStreamToResponse(a,{originalMessages:b,generateMessageId:c,onFinish:d,messageMetadata:e,sendReasoning:f,sendSources:g,sendFinish:h,sendStart:i,onError:j,...k}={}){!function({response:a,status:b,statusText:c,headers:d,stream:e,consumeSseStream:f}){let g=e.pipeThrough(new b7);if(f){let[a,b]=g.tee();g=a,f({stream:b})}b6({response:a,status:b,statusText:c,headers:Object.fromEntries(b5(d,b8).entries()),stream:g.pipeThrough(new TextEncoderStream)})}({response:a,stream:this.toUIMessageStream({originalMessages:b,generateMessageId:c,onFinish:d,messageMetadata:e,sendReasoning:f,sendSources:g,sendFinish:h,sendStart:i,onError:j}),...k})}pipeTextStreamToResponse(a,b){!function({response:a,status:b,statusText:c,headers:d,textStream:e}){b6({response:a,status:b,statusText:c,headers:Object.fromEntries(b5(d,{"content-type":"text/plain; charset=utf-8"}).entries()),stream:e.pipeThrough(new TextEncoderStream)})}({response:a,textStream:this.textStream,...b})}toUIMessageStreamResponse({originalMessages:a,generateMessageId:b,onFinish:c,messageMetadata:d,sendReasoning:e,sendSources:f,sendFinish:g,sendStart:h,onError:i,...j}={}){return function({status:a,statusText:b,headers:c,stream:d,consumeSseStream:e}){let f=d.pipeThrough(new b7);if(e){let[a,b]=f.tee();f=a,e({stream:b})}return new Response(f.pipeThrough(new TextEncoderStream),{status:a,statusText:b,headers:b5(c,b8)})}({stream:this.toUIMessageStream({originalMessages:a,generateMessageId:b,onFinish:c,messageMetadata:d,sendReasoning:e,sendSources:f,sendFinish:g,sendStart:h,onError:i}),...j})}toTextStreamResponse(a){return function({status:a,statusText:b,headers:c,textStream:d}){return new Response(d.pipeThrough(new TextEncoderStream),{status:null!=a?a:200,statusText:b,headers:b5(c,{"content-type":"text/plain; charset=utf-8"})})}({textStream:this.textStream,...a})}};(0,C.hK)({prefix:"aiobj",size:24}),(0,C.hK)({prefix:"aiobj",size:24}),D.bD,((a,b)=>{for(var c in b)au(a,c,{get:b[c],enumerable:!0})})({},{object:()=>cl,text:()=>ck});var ck=()=>({type:"text",responseFormat:{type:"text"},parsePartial:async({text:a})=>({partial:a}),parseOutput:async({text:a})=>a}),cl=({schema:a})=>{let b=(0,C.mD)(a);return{type:"object",responseFormat:{type:"json",schema:b.jsonSchema},async parsePartial({text:a}){let b=await b9(a);switch(b.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":return{partial:b.value};default:{let a=b.state;throw Error(`Unsupported parse state: ${a}`)}}},async parseOutput({text:a},c){let d=await (0,C.N8)({text:a});if(!d.success)throw new aK({message:"No object generated: could not parse the response.",cause:d.error,text:a,response:c.response,usage:c.usage,finishReason:c.finishReason});let e=await (0,C.ZZ)({value:d.value,schema:b});if(!e.success)throw new aK({message:"No object generated: response did not match schema.",cause:e.error,text:a,response:c.response,usage:c.usage,finishReason:c.finishReason});return e.value}}},cm=Symbol.for("vercel.ai.error.AI_NoSuchProviderError");D.eM;var cn=E._H({name:E.Yj(),version:E.Yj()}),co=E._H({_meta:E.lq(E.Ik({}).loose())}),cp=E.Ik({method:E.Yj(),params:E.lq(co)}),cq=E._H({experimental:E.lq(E.Ik({}).loose()),logging:E.lq(E.Ik({}).loose()),prompts:E.lq(E._H({listChanged:E.lq(E.zM())})),resources:E.lq(E._H({subscribe:E.lq(E.zM()),listChanged:E.lq(E.zM())})),tools:E.lq(E._H({listChanged:E.lq(E.zM())}))});co.extend({protocolVersion:E.Yj(),capabilities:cq,serverInfo:cn,instructions:E.lq(E.Yj())});var cr=co.extend({nextCursor:E.lq(E.Yj())}),cs=E.Ik({name:E.Yj(),description:E.lq(E.Yj()),inputSchema:E.Ik({type:E.eu("object"),properties:E.lq(E.Ik({}).loose())}).loose()}).loose();cr.extend({tools:E.YO(cs)});var ct=E.Ik({type:E.eu("text"),text:E.Yj()}).loose(),cu=E.Ik({type:E.eu("image"),data:E.K3(),mimeType:E.Yj()}).loose(),cv=E.Ik({uri:E.Yj(),mimeType:E.lq(E.Yj())}).loose(),cw=cv.extend({text:E.Yj()}),cx=cv.extend({blob:E.K3()}),cy=E.Ik({type:E.eu("resource"),resource:E.KC([cw,cx])}).loose();co.extend({content:E.YO(E.KC([ct,cu,cy])),isError:E.zM().default(!1).optional()}).or(co.extend({toolResult:E.L5()}));var cz=E.Ik({jsonrpc:E.eu("2.0"),id:E.KC([E.Yj(),E.ai().int()])}).merge(cp).strict(),cA=E.Ik({jsonrpc:E.eu("2.0"),id:E.KC([E.Yj(),E.ai().int()]),result:co}).strict(),cB=E.Ik({jsonrpc:E.eu("2.0"),id:E.KC([E.Yj(),E.ai().int()]),error:E.Ik({code:E.ai().int(),message:E.Yj(),data:E.lq(E.L5())})}).strict(),cC=E.Ik({jsonrpc:E.eu("2.0")}).merge(E.Ik({method:E.Yj(),params:E.lq(co)})).strict();function cD(a,b){let c=[];for(let d of((null==b?void 0:b.ignoreIncompleteToolCalls)&&(a=a.map(a=>({...a,parts:a.parts.filter(a=>!ca(a)||"input-streaming"!==a.state&&"input-available"!==a.state)}))),a))switch(d.role){case"system":{let a=d.parts.filter(a=>"text"===a.type),b=a.reduce((a,b)=>null!=b.providerMetadata?{...a,...b.providerMetadata}:a,{});c.push({role:"system",content:a.map(a=>a.text).join(""),...Object.keys(b).length>0?{providerOptions:b}:{}});break}case"user":c.push({role:"user",content:d.parts.filter(a=>"text"===a.type||"file"===a.type).map(a=>{switch(a.type){case"text":return{type:"text",text:a.text,...null!=a.providerMetadata?{providerOptions:a.providerMetadata}:{}};case"file":return{type:"file",mediaType:a.mediaType,filename:a.filename,data:a.url,...null!=a.providerMetadata?{providerOptions:a.providerMetadata}:{}};default:return a}})});break;case"assistant":if(null!=d.parts){let a=function(){var a,f;if(0===e.length)return;let g=[];for(let c of e)if("text"===c.type)g.push({type:"text",text:c.text,...null!=c.providerMetadata?{providerOptions:c.providerMetadata}:{}});else if("file"===c.type)g.push({type:"file",mediaType:c.mediaType,filename:c.filename,data:c.url});else if("reasoning"===c.type)g.push({type:"reasoning",text:c.text,providerOptions:c.providerMetadata});else if("dynamic-tool"===c.type){let a=c.toolName;if("input-streaming"===c.state)throw new a4({originalMessage:d,message:`incomplete tool input is not supported: ${c.toolCallId}`});g.push({type:"tool-call",toolCallId:c.toolCallId,toolName:a,input:c.input,...null!=c.callProviderMetadata?{providerOptions:c.callProviderMetadata}:{}})}else if(ca(c)){let e=cb(c);if("input-streaming"===c.state)throw new a4({originalMessage:d,message:`incomplete tool input is not supported: ${c.toolCallId}`});g.push({type:"tool-call",toolCallId:c.toolCallId,toolName:e,input:"output-error"===c.state?null!=(a=c.input)?a:c.rawInput:c.input,providerExecuted:c.providerExecuted,...null!=c.callProviderMetadata?{providerOptions:c.callProviderMetadata}:{}}),!0===c.providerExecuted&&("output-available"===c.state||"output-error"===c.state)&&g.push({type:"tool-result",toolCallId:c.toolCallId,toolName:e,output:bZ({output:"output-error"===c.state?c.errorText:c.output,tool:null==(f=null==b?void 0:b.tools)?void 0:f[e],errorMode:"output-error"===c.state?"json":"none"})})}else throw Error(`Unsupported part: ${c}`);c.push({role:"assistant",content:g});let h=e.filter(a=>ca(a)&&!0!==a.providerExecuted||"dynamic-tool"===a.type);h.length>0&&c.push({role:"tool",content:h.map(a=>{var c;switch(a.state){case"output-error":case"output-available":{let d="dynamic-tool"===a.type?a.toolName:cb(a);return{type:"tool-result",toolCallId:a.toolCallId,toolName:d,output:bZ({output:"output-error"===a.state?a.errorText:a.output,tool:null==(c=null==b?void 0:b.tools)?void 0:c[d],errorMode:"output-error"===a.state?"text":"none"})}}default:throw new a4({originalMessage:d,message:`Unsupported tool part state: ${a.state}`})}})}),e=[]},e=[];for(let b of d.parts)"text"===b.type||"reasoning"===b.type||"file"===b.type||"dynamic-tool"===b.type||ca(b)?e.push(b):"step-start"===b.type&&a();a()}break;default:{let a=d.role;throw new a4({originalMessage:d,message:`Unsupported role: ${a}`})}}return c}E.KC([cz,cC,cA,cB]),D.bD;var cE=E.Ik({type:E.eu("text"),text:E.Yj(),state:E.k5(["streaming","done"]).optional(),providerMetadata:bn.optional()}),cF=E.Ik({type:E.eu("reasoning"),text:E.Yj(),state:E.k5(["streaming","done"]).optional(),providerMetadata:bn.optional()}),cG=E.Ik({type:E.eu("source-url"),sourceId:E.Yj(),url:E.Yj(),title:E.Yj().optional(),providerMetadata:bn.optional()}),cH=E.Ik({type:E.eu("source-document"),sourceId:E.Yj(),mediaType:E.Yj(),title:E.Yj(),filename:E.Yj().optional(),providerMetadata:bn.optional()}),cI=E.Ik({type:E.eu("file"),mediaType:E.Yj(),filename:E.Yj().optional(),url:E.Yj(),providerMetadata:bn.optional()}),cJ=E.Ik({type:E.eu("step-start")}),cK=E.Ik({type:E.Yj().startsWith("data-"),id:E.Yj().optional(),data:E.L5()}),cL=[E.Ik({type:E.eu("dynamic-tool"),toolName:E.Yj(),toolCallId:E.Yj(),state:E.eu("input-streaming"),input:E.L5().optional(),output:E.Zm().optional(),errorText:E.Zm().optional()}),E.Ik({type:E.eu("dynamic-tool"),toolName:E.Yj(),toolCallId:E.Yj(),state:E.eu("input-available"),input:E.L5(),output:E.Zm().optional(),errorText:E.Zm().optional(),callProviderMetadata:bn.optional()}),E.Ik({type:E.eu("dynamic-tool"),toolName:E.Yj(),toolCallId:E.Yj(),state:E.eu("output-available"),input:E.L5(),output:E.L5(),errorText:E.Zm().optional(),callProviderMetadata:bn.optional(),preliminary:E.zM().optional()}),E.Ik({type:E.eu("dynamic-tool"),toolName:E.Yj(),toolCallId:E.Yj(),state:E.eu("output-error"),input:E.L5(),output:E.Zm().optional(),errorText:E.Yj(),callProviderMetadata:bn.optional()})],cM=[E.Ik({type:E.Yj().startsWith("tool-"),toolCallId:E.Yj(),state:E.eu("input-streaming"),input:E.L5().optional(),output:E.Zm().optional(),errorText:E.Zm().optional()}),E.Ik({type:E.Yj().startsWith("tool-"),toolCallId:E.Yj(),state:E.eu("input-available"),input:E.L5(),output:E.Zm().optional(),errorText:E.Zm().optional(),callProviderMetadata:bn.optional()}),E.Ik({type:E.Yj().startsWith("tool-"),toolCallId:E.Yj(),state:E.eu("output-available"),input:E.L5(),output:E.L5(),errorText:E.Zm().optional(),callProviderMetadata:bn.optional(),preliminary:E.zM().optional()}),E.Ik({type:E.Yj().startsWith("tool-"),toolCallId:E.Yj(),state:E.eu("output-error"),input:E.L5(),output:E.Zm().optional(),errorText:E.Yj(),callProviderMetadata:bn.optional()})];E.Ik({id:E.Yj(),role:E.k5(["system","user","assistant"]),metadata:E.L5().optional(),parts:E.YO(E.KC([cE,cF,cG,cH,cI,cJ,cK,...cL,...cM]))})},67330:(a,b,c)=>{c.d(b,{mD:()=>Z,m2:()=>m,Z9:()=>aa,ej:()=>ac,n_:()=>ab,HD:()=>W,Ds:()=>U,hK:()=>q,sl:()=>T,cV:()=>V,hL:()=>R,cb:()=>n,o8:()=>ae,$C:()=>r,u1:()=>s,$b:()=>y,zf:()=>t,v0:()=>K,qs:()=>z,WL:()=>A,x3:()=>B,_Z:()=>L,xI:()=>M,S:()=>P,GU:()=>O,hd:()=>S,N8:()=>J,ZZ:()=>H,k5:()=>G,ae:()=>ad});var d=c(45702);class e extends Error{constructor(a,b){super(a),this.name="ParseError",this.type=b.type,this.field=b.field,this.value=b.value,this.line=b.line}}function f(a){}class g extends TransformStream{constructor({onError:a,onRetry:b,onComment:c}={}){let d;super({start(g){d=function(a){if("function"==typeof a)throw TypeError("`callbacks` must be an object, got a function instead. Did you mean `{onEvent: fn}`?");let{onEvent:b=f,onError:c=f,onRetry:d=f,onComment:g}=a,h="",i=!0,j,k="",l="";function m(a){if(""===a)return void(k.length>0&&b({id:j,event:l||void 0,data:k.endsWith(`
`)?k.slice(0,-1):k}),j=void 0,k="",l="");if(a.startsWith(":")){g&&g(a.slice(a.startsWith(": ")?2:1));return}let c=a.indexOf(":");if(-1!==c){let b=a.slice(0,c),d=" "===a[c+1]?2:1;n(b,a.slice(c+d),a);return}n(a,"",a)}function n(a,b,f){switch(a){case"event":l=b;break;case"data":k=`${k}${b}
`;break;case"id":j=b.includes("\0")?void 0:b;break;case"retry":/^\d+$/.test(b)?d(parseInt(b,10)):c(new e(`Invalid \`retry\` value: "${b}"`,{type:"invalid-retry",value:b,line:f}));break;default:c(new e(`Unknown field "${a.length>20?`${a.slice(0,20)}\u2026`:a}"`,{type:"unknown-field",field:a,value:b,line:f}))}}return{feed:function(a){let b=i?a.replace(/^\xEF\xBB\xBF/,""):a,[c,d]=function(a){let b=[],c="",d=0;for(;d<a.length;){let e=a.indexOf("\r",d),f=a.indexOf(`
`,d),g=-1;if(-1!==e&&-1!==f?g=Math.min(e,f):-1!==e?g=e:-1!==f&&(g=f),-1===g){c=a.slice(d);break}{let c=a.slice(d,g);b.push(c),"\r"===a[(d=g+1)-1]&&a[d]===`
`&&d++}}return[b,c]}(`${h}${b}`);for(let a of c)m(a);h=d,i=!1},reset:function(a={}){h&&a.consume&&m(h),i=!0,j=void 0,k="",l="",h=""}}}({onEvent:a=>{g.enqueue(a)},onError(b){"terminate"===a?g.error(b):"function"==typeof a&&a(b)},onRetry:b,onComment:c})},transform(a){d.feed(a)}})}}var h=c(70101),i=c(13602);class j{constructor(a){this.counter=0,this.metadataRegistry=a?.metadata??h.fd,this.target=a?.target??"draft-2020-12",this.unrepresentable=a?.unrepresentable??"throw",this.override=a?.override??(()=>{}),this.io=a?.io??"output",this.seen=new Map}process(a,b={path:[],schemaPath:[]}){var c;let d=a._zod.def,e=this.seen.get(a);if(e)return e.count++,b.schemaPath.includes(a)&&(e.cycle=b.path),e.schema;let f={schema:{},count:1,cycle:void 0,path:b.path};this.seen.set(a,f);let g=a._zod.toJSONSchema?.();if(g)f.schema=g;else{let c={...b,schemaPath:[...b.schemaPath,a],path:b.path},e=a._zod.parent;if(e)f.ref=e,this.process(e,c),this.seen.get(e).isParent=!0;else{let b=f.schema;switch(d.type){case"string":{b.type="string";let{minimum:c,maximum:d,format:e,patterns:g,contentEncoding:h}=a._zod.bag;if("number"==typeof c&&(b.minLength=c),"number"==typeof d&&(b.maxLength=d),e&&(b.format=({guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""})[e]??e,""===b.format&&delete b.format),h&&(b.contentEncoding=h),g&&g.size>0){let a=[...g];1===a.length?b.pattern=a[0].source:a.length>1&&(f.schema.allOf=[...a.map(a=>({..."draft-7"===this.target?{type:"string"}:{},pattern:a.source}))])}break}case"number":{let{minimum:c,maximum:d,format:e,multipleOf:f,exclusiveMaximum:g,exclusiveMinimum:h}=a._zod.bag;"string"==typeof e&&e.includes("int")?b.type="integer":b.type="number","number"==typeof h&&(b.exclusiveMinimum=h),"number"==typeof c&&(b.minimum=c,"number"==typeof h&&(h>=c?delete b.minimum:delete b.exclusiveMinimum)),"number"==typeof g&&(b.exclusiveMaximum=g),"number"==typeof d&&(b.maximum=d,"number"==typeof g&&(g<=d?delete b.maximum:delete b.exclusiveMaximum)),"number"==typeof f&&(b.multipleOf=f);break}case"boolean":case"success":b.type="boolean";break;case"bigint":if("throw"===this.unrepresentable)throw Error("BigInt cannot be represented in JSON Schema");break;case"symbol":if("throw"===this.unrepresentable)throw Error("Symbols cannot be represented in JSON Schema");break;case"null":b.type="null";break;case"any":case"unknown":break;case"undefined":if("throw"===this.unrepresentable)throw Error("Undefined cannot be represented in JSON Schema");break;case"void":if("throw"===this.unrepresentable)throw Error("Void cannot be represented in JSON Schema");break;case"never":b.not={};break;case"date":if("throw"===this.unrepresentable)throw Error("Date cannot be represented in JSON Schema");break;case"array":{let{minimum:e,maximum:f}=a._zod.bag;"number"==typeof e&&(b.minItems=e),"number"==typeof f&&(b.maxItems=f),b.type="array",b.items=this.process(d.element,{...c,path:[...c.path,"items"]});break}case"object":{b.type="object",b.properties={};let a=d.shape;for(let d in a)b.properties[d]=this.process(a[d],{...c,path:[...c.path,"properties",d]});let e=new Set([...new Set(Object.keys(a))].filter(a=>{let b=d.shape[a]._zod;return"input"===this.io?void 0===b.optin:void 0===b.optout}));e.size>0&&(b.required=Array.from(e)),d.catchall?._zod.def.type==="never"?b.additionalProperties=!1:d.catchall?d.catchall&&(b.additionalProperties=this.process(d.catchall,{...c,path:[...c.path,"additionalProperties"]})):"output"===this.io&&(b.additionalProperties=!1);break}case"union":b.anyOf=d.options.map((a,b)=>this.process(a,{...c,path:[...c.path,"anyOf",b]}));break;case"intersection":{let a=this.process(d.left,{...c,path:[...c.path,"allOf",0]}),e=this.process(d.right,{...c,path:[...c.path,"allOf",1]}),f=a=>"allOf"in a&&1===Object.keys(a).length;b.allOf=[...f(a)?a.allOf:[a],...f(e)?e.allOf:[e]];break}case"tuple":{b.type="array";let e=d.items.map((a,b)=>this.process(a,{...c,path:[...c.path,"prefixItems",b]}));if("draft-2020-12"===this.target?b.prefixItems=e:b.items=e,d.rest){let a=this.process(d.rest,{...c,path:[...c.path,"items"]});"draft-2020-12"===this.target?b.items=a:b.additionalItems=a}d.rest&&(b.items=this.process(d.rest,{...c,path:[...c.path,"items"]}));let{minimum:f,maximum:g}=a._zod.bag;"number"==typeof f&&(b.minItems=f),"number"==typeof g&&(b.maxItems=g);break}case"record":b.type="object",b.propertyNames=this.process(d.keyType,{...c,path:[...c.path,"propertyNames"]}),b.additionalProperties=this.process(d.valueType,{...c,path:[...c.path,"additionalProperties"]});break;case"map":if("throw"===this.unrepresentable)throw Error("Map cannot be represented in JSON Schema");break;case"set":if("throw"===this.unrepresentable)throw Error("Set cannot be represented in JSON Schema");break;case"enum":{let a=(0,i.w5)(d.entries);a.every(a=>"number"==typeof a)&&(b.type="number"),a.every(a=>"string"==typeof a)&&(b.type="string"),b.enum=a;break}case"literal":{let a=[];for(let b of d.values)if(void 0===b){if("throw"===this.unrepresentable)throw Error("Literal `undefined` cannot be represented in JSON Schema")}else if("bigint"==typeof b)if("throw"===this.unrepresentable)throw Error("BigInt literals cannot be represented in JSON Schema");else a.push(Number(b));else a.push(b);if(0===a.length);else if(1===a.length){let c=a[0];b.type=null===c?"null":typeof c,b.const=c}else a.every(a=>"number"==typeof a)&&(b.type="number"),a.every(a=>"string"==typeof a)&&(b.type="string"),a.every(a=>"boolean"==typeof a)&&(b.type="string"),a.every(a=>null===a)&&(b.type="null"),b.enum=a;break}case"file":{let c={type:"string",format:"binary",contentEncoding:"binary"},{minimum:d,maximum:e,mime:f}=a._zod.bag;void 0!==d&&(c.minLength=d),void 0!==e&&(c.maxLength=e),f?1===f.length?(c.contentMediaType=f[0],Object.assign(b,c)):b.anyOf=f.map(a=>({...c,contentMediaType:a})):Object.assign(b,c);break}case"transform":if("throw"===this.unrepresentable)throw Error("Transforms cannot be represented in JSON Schema");break;case"nullable":b.anyOf=[this.process(d.innerType,c),{type:"null"}];break;case"nonoptional":case"promise":case"optional":this.process(d.innerType,c),f.ref=d.innerType;break;case"default":this.process(d.innerType,c),f.ref=d.innerType,b.default=JSON.parse(JSON.stringify(d.defaultValue));break;case"prefault":this.process(d.innerType,c),f.ref=d.innerType,"input"===this.io&&(b._prefault=JSON.parse(JSON.stringify(d.defaultValue)));break;case"catch":{let a;this.process(d.innerType,c),f.ref=d.innerType;try{a=d.catchValue(void 0)}catch{throw Error("Dynamic catch values are not supported in JSON Schema")}b.default=a;break}case"nan":if("throw"===this.unrepresentable)throw Error("NaN cannot be represented in JSON Schema");break;case"template_literal":{let c=a._zod.pattern;if(!c)throw Error("Pattern not found in template literal");b.type="string",b.pattern=c.source;break}case"pipe":{let a="input"===this.io?"transform"===d.in._zod.def.type?d.out:d.in:d.out;this.process(a,c),f.ref=a;break}case"readonly":this.process(d.innerType,c),f.ref=d.innerType,b.readOnly=!0;break;case"lazy":{let b=a._zod.innerType;this.process(b,c),f.ref=b;break}case"custom":if("throw"===this.unrepresentable)throw Error("Custom types cannot be represented in JSON Schema")}}}let h=this.metadataRegistry.get(a);return h&&Object.assign(f.schema,h),"input"===this.io&&function a(b,c){let d=c??{seen:new Set};if(d.seen.has(b))return!1;d.seen.add(b);let e=b._zod.def;switch(e.type){case"string":case"number":case"bigint":case"boolean":case"date":case"symbol":case"undefined":case"null":case"any":case"unknown":case"never":case"void":case"literal":case"enum":case"nan":case"file":case"template_literal":case"custom":case"success":case"catch":return!1;case"array":return a(e.element,d);case"object":for(let b in e.shape)if(a(e.shape[b],d))return!0;return!1;case"union":for(let b of e.options)if(a(b,d))return!0;return!1;case"intersection":return a(e.left,d)||a(e.right,d);case"tuple":for(let b of e.items)if(a(b,d))return!0;if(e.rest&&a(e.rest,d))return!0;return!1;case"record":case"map":return a(e.keyType,d)||a(e.valueType,d);case"set":return a(e.valueType,d);case"promise":case"optional":case"nonoptional":case"nullable":case"readonly":case"default":case"prefault":return a(e.innerType,d);case"lazy":return a(e.getter(),d);case"transform":return!0;case"pipe":return a(e.in,d)||a(e.out,d)}throw Error(`Unknown schema type: ${e.type}`)}(a)&&(delete f.schema.examples,delete f.schema.default),"input"===this.io&&f.schema._prefault&&((c=f.schema).default??(c.default=f.schema._prefault)),delete f.schema._prefault,this.seen.get(a).schema}emit(a,b){let c={cycles:b?.cycles??"ref",reused:b?.reused??"inline",external:b?.external??void 0},d=this.seen.get(a);if(!d)throw Error("Unprocessed schema. This is a bug in Zod.");let e=a=>{let b="draft-2020-12"===this.target?"$defs":"definitions";if(c.external){let d=c.external.registry.get(a[0])?.id,e=c.external.uri??(a=>a);if(d)return{ref:e(d)};let f=a[1].defId??a[1].schema.id??`schema${this.counter++}`;return a[1].defId=f,{defId:f,ref:`${e("__shared")}#/${b}/${f}`}}if(a[1]===d)return{ref:"#"};let e=`#/${b}/`,f=a[1].schema.id??`__schema${this.counter++}`;return{defId:f,ref:e+f}},f=a=>{if(a[1].schema.$ref)return;let b=a[1],{ref:c,defId:d}=e(a);b.def={...b.schema},d&&(b.defId=d);let f=b.schema;for(let a in f)delete f[a];f.$ref=c};if("throw"===c.cycles)for(let a of this.seen.entries()){let b=a[1];if(b.cycle)throw Error(`Cycle detected: #/${b.cycle?.join("/")}/<root>

Set the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.`)}for(let b of this.seen.entries()){let d=b[1];if(a===b[0]){f(b);continue}if(c.external){let d=c.external.registry.get(b[0])?.id;if(a!==b[0]&&d){f(b);continue}}if(this.metadataRegistry.get(b[0])?.id||d.cycle||d.count>1&&"ref"===c.reused){f(b);continue}}let g=(a,b)=>{let c=this.seen.get(a),d=c.def??c.schema,e={...d};if(null===c.ref)return;let f=c.ref;if(c.ref=null,f){g(f,b);let a=this.seen.get(f).schema;a.$ref&&"draft-7"===b.target?(d.allOf=d.allOf??[],d.allOf.push(a)):(Object.assign(d,a),Object.assign(d,e))}c.isParent||this.override({zodSchema:a,jsonSchema:d,path:c.path??[]})};for(let a of[...this.seen.entries()].reverse())g(a[0],{target:this.target});let h={};if("draft-2020-12"===this.target?h.$schema="https://json-schema.org/draft/2020-12/schema":"draft-7"===this.target?h.$schema="http://json-schema.org/draft-07/schema#":console.warn(`Invalid target: ${this.target}`),c.external?.uri){let b=c.external.registry.get(a)?.id;if(!b)throw Error("Schema is missing an `id` property");h.$id=c.external.uri(b)}Object.assign(h,d.def);let i=c.external?.defs??{};for(let a of this.seen.entries()){let b=a[1];b.def&&b.defId&&(i[b.defId]=b.def)}c.external||Object.keys(i).length>0&&("draft-2020-12"===this.target?h.$defs=i:h.definitions=i);try{return JSON.parse(JSON.stringify(h))}catch(a){throw Error("Error converting schema to JSON.")}}}var k=c(45443),l=c(21379);function m(...a){return a.reduce((a,b)=>({...a,...null!=b?b:{}}),{})}async function n(a,b){if(null==a)return Promise.resolve();let c=null==b?void 0:b.abortSignal;return new Promise((b,d)=>{if(null==c?void 0:c.aborted)return void d(o());let e=setTimeout(()=>{f(),b()},a),f=()=>{clearTimeout(e),null==c||c.removeEventListener("abort",g)},g=()=>{f(),d(o())};null==c||c.addEventListener("abort",g)})}function o(){return new DOMException("Delay was aborted","AbortError")}function p(a){return Object.fromEntries([...a.headers])}var q=({prefix:a,size:b=16,alphabet:c="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:e="-"}={})=>{let f=()=>{let a=c.length,d=Array(b);for(let e=0;e<b;e++)d[e]=c[Math.random()*a|0];return d.join("")};if(null==a)return f;if(c.includes(e))throw new d.Di({argument:"separator",message:`The separator "${e}" must not be part of the alphabet "${c}".`});return()=>`${a}${e}${f()}`},r=q();function s(a){return null==a?"unknown error":"string"==typeof a?a:a instanceof Error?a.message:JSON.stringify(a)}function t(a){return(a instanceof Error||a instanceof DOMException)&&("AbortError"===a.name||"ResponseAborted"===a.name||"TimeoutError"===a.name)}var u=["fetch failed","failed to fetch"];function v({error:a,url:b,requestBodyValues:c}){if(t(a))return a;if(a instanceof TypeError&&u.includes(a.message.toLowerCase())){let e=a.cause;if(null!=e)return new d.hL({message:`Cannot connect to API: ${e.message}`,cause:e,url:b,requestBodyValues:c,isRetryable:!0})}return a}function w(a){return Object.fromEntries(Object.entries(a).filter(([a,b])=>null!=b))}var x=()=>globalThis.fetch,y=async({url:a,headers:b={},successfulResponseHandler:c,failedResponseHandler:e,abortSignal:f,fetch:g=x()})=>{try{let h=await g(a,{method:"GET",headers:w(b),signal:f}),i=p(h);if(!h.ok){let b;try{b=await e({response:h,url:a,requestBodyValues:{}})}catch(b){if(t(b)||d.hL.isInstance(b))throw b;throw new d.hL({message:"Failed to process error response",cause:b,statusCode:h.status,url:a,responseHeaders:i,requestBodyValues:{}})}throw b.value}try{return await c({response:h,url:a,requestBodyValues:{}})}catch(b){if(b instanceof Error&&(t(b)||d.hL.isInstance(b)))throw b;throw new d.hL({message:"Failed to process successful response",cause:b,statusCode:h.status,url:a,responseHeaders:i,requestBodyValues:{}})}}catch(b){throw v({error:b,url:a,requestBodyValues:{}})}};function z({mediaType:a,url:b,supportedUrls:c}){return b=b.toLowerCase(),a=a.toLowerCase(),Object.entries(c).map(([a,b])=>{let c=a.toLowerCase();return"*"===c||"*/*"===c?{mediaTypePrefix:"",regexes:b}:{mediaTypePrefix:c.replace(/\*/,""),regexes:b}}).filter(({mediaTypePrefix:b})=>a.startsWith(b)).flatMap(({regexes:a})=>a).some(a=>a.test(b))}function A({apiKey:a,environmentVariableName:b,apiKeyParameterName:c="apiKey",description:e}){if("string"==typeof a)return a;if(null!=a)throw new d.Kq({message:`${e} API key must be a string.`});if("undefined"==typeof process)throw new d.Kq({message:`${e} API key is missing. Pass it using the '${c}' parameter. Environment variables is not supported in this environment.`});if(null==(a=process.env[b]))throw new d.Kq({message:`${e} API key is missing. Pass it using the '${c}' parameter or the ${b} environment variable.`});if("string"!=typeof a)throw new d.Kq({message:`${e} API key must be a string. The value of the ${b} environment variable is not a string.`});return a}function B({settingValue:a,environmentVariableName:b}){return"string"==typeof a?a:null!=a||"undefined"==typeof process?void 0:null!=(a=process.env[b])&&"string"==typeof a?a:void 0}var C=/"__proto__"\s*:/,D=/"constructor"\s*:/;function E(a){let{stackTraceLimit:b}=Error;Error.stackTraceLimit=0;try{let b=JSON.parse(a);return null===b||"object"!=typeof b||!1===C.test(a)&&!1===D.test(a)?b:function(a){let b=[a];for(;b.length;){let a=b;for(let c of(b=[],a)){if(Object.prototype.hasOwnProperty.call(c,"__proto__")||Object.prototype.hasOwnProperty.call(c,"constructor")&&Object.prototype.hasOwnProperty.call(c.constructor,"prototype"))throw SyntaxError("Object contains forbidden prototype property");for(let a in c){let d=c[a];d&&"object"==typeof d&&b.push(d)}}}return a}(b)}finally{Error.stackTraceLimit=b}}var F=Symbol.for("vercel.ai.validator");async function G({value:a,schema:b}){let c=await H({value:a,schema:b});if(!c.success)throw d.iM.wrap({value:a,cause:c.error});return c.value}async function H({value:a,schema:b}){var c;let e="object"==typeof b&&null!==b&&F in b&&!0===b[F]&&"validate"in b?b:(c=b,{[F]:!0,validate:async a=>{let b=await c["~standard"].validate(a);return null==b.issues?{success:!0,value:b.value}:{success:!1,error:new d.iM({value:a,cause:b.issues})}}});try{if(null==e.validate)return{success:!0,value:a,rawValue:a};let b=await e.validate(a);if(b.success)return{success:!0,value:b.value,rawValue:a};return{success:!1,error:d.iM.wrap({value:a,cause:b.error}),rawValue:a}}catch(b){return{success:!1,error:d.iM.wrap({value:a,cause:b}),rawValue:a}}}async function I({text:a,schema:b}){try{let c=E(a);if(null==b)return c;return G({value:c,schema:b})}catch(b){if(d.u6.isInstance(b)||d.iM.isInstance(b))throw b;throw new d.u6({text:a,cause:b})}}async function J({text:a,schema:b}){try{let c=E(a);if(null==b)return{success:!0,value:c,rawValue:c};return await H({value:c,schema:b})}catch(b){return{success:!1,error:d.u6.isInstance(b)?b:new d.u6({text:a,cause:b}),rawValue:void 0}}}function K(a){try{return E(a),!0}catch(a){return!1}}function L({stream:a,schema:b}){return a.pipeThrough(new TextDecoderStream).pipeThrough(new g).pipeThrough(new TransformStream({async transform({data:a},c){"[DONE]"!==a&&c.enqueue(await J({text:a,schema:b}))}}))}async function M({provider:a,providerOptions:b,schema:c}){if((null==b?void 0:b[a])==null)return;let e=await H({value:b[a],schema:c});if(!e.success)throw new d.Di({argument:"providerOptions",message:`invalid ${a} provider options`,cause:e.error});return e.value}var N=()=>globalThis.fetch,O=async({url:a,headers:b,body:c,failedResponseHandler:d,successfulResponseHandler:e,abortSignal:f,fetch:g})=>Q({url:a,headers:{"Content-Type":"application/json",...b},body:{content:JSON.stringify(c),values:c},failedResponseHandler:d,successfulResponseHandler:e,abortSignal:f,fetch:g}),P=async({url:a,headers:b,formData:c,failedResponseHandler:d,successfulResponseHandler:e,abortSignal:f,fetch:g})=>Q({url:a,headers:b,body:{content:c,values:Object.fromEntries(c.entries())},failedResponseHandler:d,successfulResponseHandler:e,abortSignal:f,fetch:g}),Q=async({url:a,headers:b={},body:c,successfulResponseHandler:e,failedResponseHandler:f,abortSignal:g,fetch:h=N()})=>{try{let i=await h(a,{method:"POST",headers:w(b),body:c.content,signal:g}),j=p(i);if(!i.ok){let b;try{b=await f({response:i,url:a,requestBodyValues:c.values})}catch(b){if(t(b)||d.hL.isInstance(b))throw b;throw new d.hL({message:"Failed to process error response",cause:b,statusCode:i.status,url:a,responseHeaders:j,requestBodyValues:c.values})}throw b.value}try{return await e({response:i,url:a,requestBodyValues:c.values})}catch(b){if(b instanceof Error&&(t(b)||d.hL.isInstance(b)))throw b;throw new d.hL({message:"Failed to process successful response",cause:b,statusCode:i.status,url:a,responseHeaders:j,requestBodyValues:c.values})}}catch(b){throw v({error:b,url:a,requestBodyValues:c.values})}};function R({id:a,name:b,inputSchema:c}){return({execute:d,outputSchema:e,toModelOutput:f,onInputStart:g,onInputDelta:h,onInputAvailable:i,...j})=>({type:"provider-defined",id:a,name:b,args:j,inputSchema:c,outputSchema:e,execute:d,toModelOutput:f,onInputStart:g,onInputDelta:h,onInputAvailable:i})}async function S(a){return"function"==typeof a&&(a=a()),Promise.resolve(a)}var T=({errorSchema:a,errorToMessage:b,isRetryable:c})=>async({response:e,url:f,requestBodyValues:g})=>{let h=await e.text(),i=p(e);if(""===h.trim())return{responseHeaders:i,value:new d.hL({message:e.statusText,url:f,requestBodyValues:g,statusCode:e.status,responseHeaders:i,responseBody:h,isRetryable:null==c?void 0:c(e)})};try{let j=await I({text:h,schema:a});return{responseHeaders:i,value:new d.hL({message:b(j),url:f,requestBodyValues:g,statusCode:e.status,responseHeaders:i,responseBody:h,data:j,isRetryable:null==c?void 0:c(e,j)})}}catch(a){return{responseHeaders:i,value:new d.hL({message:e.statusText,url:f,requestBodyValues:g,statusCode:e.status,responseHeaders:i,responseBody:h,isRetryable:null==c?void 0:c(e)})}}},U=a=>async({response:b})=>{let c=p(b);if(null==b.body)throw new d.Tt({});return{responseHeaders:c,value:L({stream:b.body,schema:a})}},V=a=>async({response:b,url:c,requestBodyValues:e})=>{let f=await b.text(),g=await J({text:f,schema:a}),h=p(b);if(!g.success)throw new d.hL({message:"Invalid JSON response",cause:g.error,statusCode:b.status,responseHeaders:h,responseBody:f,url:c,requestBodyValues:e});return{responseHeaders:h,value:g.value,rawValue:g.rawValue}},W=()=>async({response:a,url:b,requestBodyValues:c})=>{let e=p(a);if(!a.body)throw new d.hL({message:"Response body is empty",url:b,requestBodyValues:c,statusCode:a.status,responseHeaders:e,responseBody:void 0});try{let b=await a.arrayBuffer();return{responseHeaders:e,value:new Uint8Array(b)}}catch(f){throw new d.hL({message:"Failed to read response as array buffer",url:b,requestBodyValues:c,statusCode:a.status,responseHeaders:e,responseBody:void 0,cause:f})}},X=Symbol.for("vercel.ai.schema");function Y(a,{validate:b}={}){return{[X]:!0,_type:void 0,[F]:!0,jsonSchema:a,validate:b}}function Z(a){return null==a?Y({properties:{},additionalProperties:!1}):"object"==typeof a&&null!==a&&X in a&&!0===a[X]&&"jsonSchema"in a&&"validate"in a?a:function(a,b){var c;if("_zod"in a)return Y(function(a,b){if(a instanceof h.rs){let c=new j(b),d={};for(let b of a._idmap.entries()){let[a,d]=b;c.process(d)}let e={},f={registry:a,uri:b?.uri,defs:d};for(let d of a._idmap.entries()){let[a,g]=d;e[a]=c.emit(g,{...b,external:f})}return Object.keys(d).length>0&&(e.__shared={["draft-2020-12"===c.target?"$defs":"definitions"]:d}),{schemas:e}}let c=new j(b);return c.process(a),c.emit(a,b)}(a,{target:"draft-7",io:"output",reused:"inline"}),{validate:async b=>{let c=await k.bp(a,b);return c.success?{success:!0,value:c.data}:{success:!1,error:c.error}}});let d=(c=void 0,false);return Y((0,l.Ay)(a,{$refStrategy:d?"root":"none",target:"jsonSchema7"}),{validate:async b=>{let c=await a.safeParseAsync(b);return c.success?{success:!0,value:c.data}:{success:!1,error:c.error}}})}(a)}var{btoa:$,atob:_}=globalThis;function aa(a){let b=_(a.replace(/-/g,"+").replace(/_/g,"/"));return Uint8Array.from(b,a=>a.codePointAt(0))}function ab(a){let b="";for(let c=0;c<a.length;c++)b+=String.fromCodePoint(a[c]);return $(b)}function ac(a){return a instanceof Uint8Array?ab(a):a}function ad(a){return null==a?void 0:a.replace(/\/$/,"")}async function*ae({execute:a,input:b,options:c}){let d=a(b,c);if(null!=d&&"function"==typeof d[Symbol.asyncIterator]){let a;for await(let b of d)a=b,yield{type:"preliminary",output:b};yield{type:"final",output:a}}else yield{type:"final",output:await d}}},70101:(a,b,c)=>{c.d(b,{fd:()=>e,rs:()=>d}),Symbol("ZodOutput"),Symbol("ZodInput");class d{constructor(){this._map=new Map,this._idmap=new Map}add(a,...b){let c=b[0];if(this._map.set(a,c),c&&"object"==typeof c&&"id"in c){if(this._idmap.has(c.id))throw Error(`ID ${c.id} already exists in the registry`);this._idmap.set(c.id,a)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(a){let b=this._map.get(a);return b&&"object"==typeof b&&"id"in b&&this._idmap.delete(b.id),this._map.delete(a),this}get(a){let b=a._zod.parent;if(b){let c={...this.get(b)??{}};return delete c.id,{...c,...this._map.get(a)}}return this._map.get(a)}has(a){return this._map.has(a)}}let e=new d},75490:(a,b,c)=>{c.d(b,{rS:()=>aZ,EB:()=>aE,bz:()=>a5,YO:()=>bb,K3:()=>aV,zM:()=>a1,Ie:()=>bG,gM:()=>bj,k5:()=>bo,Nl:()=>bH,RZ:()=>bE,eu:()=>bq,_H:()=>bf,Zm:()=>a9,ch:()=>a3,ai:()=>a$,Ik:()=>bd,lq:()=>bt,g1:()=>bm,re:()=>be,Yj:()=>aD,KC:()=>bh,L5:()=>a7});var d=c(41725),e=c(29979);class f{constructor(a=[]){this.content=[],this.indent=0,this&&(this.args=a)}indented(a){this.indent+=1,a(this),this.indent-=1}write(a){if("function"==typeof a){a(this,{execution:"sync"}),a(this,{execution:"async"});return}let b=a.split("\n").filter(a=>a),c=Math.min(...b.map(a=>a.length-a.trimStart().length));for(let a of b.map(a=>a.slice(c)).map(a=>" ".repeat(2*this.indent)+a))this.content.push(a)}compile(){return Function(...this?.args,[...(this?.content??[""]).map(a=>`  ${a}`)].join("\n"))}}var g=c(27771),h=c(44667),i=c(13602);let j={major:4,minor:0,patch:0},k=d.xI("$ZodType",(a,b)=>{var c;a??(a={}),a._zod.def=b,a._zod.bag=a._zod.bag||{},a._zod.version=j;let e=[...a._zod.def.checks??[]];for(let b of(a._zod.traits.has("$ZodCheck")&&e.unshift(a),e))for(let c of b._zod.onattach)c(a);if(0===e.length)(c=a._zod).deferred??(c.deferred=[]),a._zod.deferred?.push(()=>{a._zod.run=a._zod.parse});else{let b=(a,b,c)=>{let e,f=i.QH(a);for(let g of b){if(g._zod.def.when){if(!g._zod.def.when(a))continue}else if(f)continue;let b=a.issues.length,h=g._zod.check(a);if(h instanceof Promise&&c?.async===!1)throw new d.GT;if(e||h instanceof Promise)e=(e??Promise.resolve()).then(async()=>{await h,a.issues.length!==b&&(f||(f=i.QH(a,b)))});else{if(a.issues.length===b)continue;f||(f=i.QH(a,b))}}return e?e.then(()=>a):a};a._zod.run=(c,f)=>{let g=a._zod.parse(c,f);if(g instanceof Promise){if(!1===f.async)throw new d.GT;return g.then(a=>b(a,e,f))}return b(g,e,f)}}a["~standard"]={validate:b=>{try{let c=(0,g.xL)(a,b);return c.success?{value:c.data}:{issues:c.error?.issues}}catch(c){return(0,g.bp)(a,b).then(a=>a.success?{value:a.data}:{issues:a.error?.issues})}},vendor:"zod",version:1}}),l=d.xI("$ZodString",(a,b)=>{k.init(a,b),a._zod.pattern=[...a?._zod.bag?.patterns??[]].pop()??h.Yj(a._zod.bag),a._zod.parse=(c,d)=>{if(b.coerce)try{c.value=String(c.value)}catch(a){}return"string"==typeof c.value||c.issues.push({expected:"string",code:"invalid_type",input:c.value,inst:a}),c}}),m=d.xI("$ZodStringFormat",(a,b)=>{e.ql.init(a,b),l.init(a,b)}),n=d.xI("$ZodGUID",(a,b)=>{b.pattern??(b.pattern=h.Os),m.init(a,b)}),o=d.xI("$ZodUUID",(a,b)=>{if(b.version){let a={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[b.version];if(void 0===a)throw Error(`Invalid UUID version: "${b.version}"`);b.pattern??(b.pattern=h.uR(a))}else b.pattern??(b.pattern=h.uR());m.init(a,b)}),p=d.xI("$ZodEmail",(a,b)=>{b.pattern??(b.pattern=h.Rp),m.init(a,b)}),q=d.xI("$ZodURL",(a,b)=>{m.init(a,b),a._zod.check=c=>{try{let d=c.value,e=new URL(d),f=e.href;b.hostname&&(b.hostname.lastIndex=0,b.hostname.test(e.hostname)||c.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:h.OI.source,input:c.value,inst:a,continue:!b.abort})),b.protocol&&(b.protocol.lastIndex=0,b.protocol.test(e.protocol.endsWith(":")?e.protocol.slice(0,-1):e.protocol)||c.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:b.protocol.source,input:c.value,inst:a,continue:!b.abort})),!d.endsWith("/")&&f.endsWith("/")?c.value=f.slice(0,-1):c.value=f;return}catch(d){c.issues.push({code:"invalid_format",format:"url",input:c.value,inst:a,continue:!b.abort})}}}),r=d.xI("$ZodEmoji",(a,b)=>{b.pattern??(b.pattern=h.Zg()),m.init(a,b)}),s=d.xI("$ZodNanoID",(a,b)=>{b.pattern??(b.pattern=h.Ak),m.init(a,b)}),t=d.xI("$ZodCUID",(a,b)=>{b.pattern??(b.pattern=h.gF),m.init(a,b)}),u=d.xI("$ZodCUID2",(a,b)=>{b.pattern??(b.pattern=h.Gl),m.init(a,b)}),v=d.xI("$ZodULID",(a,b)=>{b.pattern??(b.pattern=h.Z0),m.init(a,b)}),w=d.xI("$ZodXID",(a,b)=>{b.pattern??(b.pattern=h.kM),m.init(a,b)}),x=d.xI("$ZodKSUID",(a,b)=>{b.pattern??(b.pattern=h.fO),m.init(a,b)}),y=d.xI("$ZodISODateTime",(a,b)=>{b.pattern??(b.pattern=h.w$(b)),m.init(a,b)}),z=d.xI("$ZodISODate",(a,b)=>{b.pattern??(b.pattern=h.p6),m.init(a,b)}),A=d.xI("$ZodISOTime",(a,b)=>{b.pattern??(b.pattern=h.kB(b)),m.init(a,b)}),B=d.xI("$ZodISODuration",(a,b)=>{b.pattern??(b.pattern=h.p0),m.init(a,b)}),C=d.xI("$ZodIPv4",(a,b)=>{b.pattern??(b.pattern=h.uX),m.init(a,b),a._zod.onattach.push(a=>{a._zod.bag.format="ipv4"})}),D=d.xI("$ZodIPv6",(a,b)=>{b.pattern??(b.pattern=h.ug),m.init(a,b),a._zod.onattach.push(a=>{a._zod.bag.format="ipv6"}),a._zod.check=c=>{try{new URL(`http://[${c.value}]`)}catch{c.issues.push({code:"invalid_format",format:"ipv6",input:c.value,inst:a,continue:!b.abort})}}}),E=d.xI("$ZodCIDRv4",(a,b)=>{b.pattern??(b.pattern=h.zr),m.init(a,b)}),F=d.xI("$ZodCIDRv6",(a,b)=>{b.pattern??(b.pattern=h.l7),m.init(a,b),a._zod.check=c=>{let[d,e]=c.value.split("/");try{if(!e)throw Error();let a=Number(e);if(`${a}`!==e||a<0||a>128)throw Error();new URL(`http://[${d}]`)}catch{c.issues.push({code:"invalid_format",format:"cidrv6",input:c.value,inst:a,continue:!b.abort})}}});function G(a){if(""===a)return!0;if(a.length%4!=0)return!1;try{return atob(a),!0}catch{return!1}}let H=d.xI("$ZodBase64",(a,b)=>{b.pattern??(b.pattern=h.K3),m.init(a,b),a._zod.onattach.push(a=>{a._zod.bag.contentEncoding="base64"}),a._zod.check=c=>{G(c.value)||c.issues.push({code:"invalid_format",format:"base64",input:c.value,inst:a,continue:!b.abort})}}),I=d.xI("$ZodBase64URL",(a,b)=>{b.pattern??(b.pattern=h.r0),m.init(a,b),a._zod.onattach.push(a=>{a._zod.bag.contentEncoding="base64url"}),a._zod.check=c=>{!function(a){if(!h.r0.test(a))return!1;let b=a.replace(/[-_]/g,a=>"-"===a?"+":"/");return G(b.padEnd(4*Math.ceil(b.length/4),"="))}(c.value)&&c.issues.push({code:"invalid_format",format:"base64url",input:c.value,inst:a,continue:!b.abort})}}),J=d.xI("$ZodE164",(a,b)=>{b.pattern??(b.pattern=h.hQ),m.init(a,b)}),K=d.xI("$ZodJWT",(a,b)=>{m.init(a,b),a._zod.check=c=>{!function(a,b=null){try{let c=a.split(".");if(3!==c.length)return!1;let[d]=c;if(!d)return!1;let e=JSON.parse(atob(d));if("typ"in e&&e?.typ!=="JWT"||!e.alg||b&&(!("alg"in e)||e.alg!==b))return!1;return!0}catch{return!1}}(c.value,b.alg)&&c.issues.push({code:"invalid_format",format:"jwt",input:c.value,inst:a,continue:!b.abort})}}),L=d.xI("$ZodNumber",(a,b)=>{k.init(a,b),a._zod.pattern=a._zod.bag.pattern??h.ai,a._zod.parse=(c,d)=>{if(b.coerce)try{c.value=Number(c.value)}catch(a){}let e=c.value;if("number"==typeof e&&!Number.isNaN(e)&&Number.isFinite(e))return c;let f="number"==typeof e?Number.isNaN(e)?"NaN":Number.isFinite(e)?void 0:"Infinity":void 0;return c.issues.push({expected:"number",code:"invalid_type",input:e,inst:a,...f?{received:f}:{}}),c}}),M=d.xI("$ZodNumber",(a,b)=>{e.KH.init(a,b),L.init(a,b)}),N=d.xI("$ZodBoolean",(a,b)=>{k.init(a,b),a._zod.pattern=h.zM,a._zod.parse=(c,d)=>{if(b.coerce)try{c.value=!!c.value}catch(a){}let e=c.value;return"boolean"==typeof e||c.issues.push({expected:"boolean",code:"invalid_type",input:e,inst:a}),c}}),O=d.xI("$ZodNull",(a,b)=>{k.init(a,b),a._zod.pattern=h.ch,a._zod.values=new Set([null]),a._zod.parse=(b,c)=>{let d=b.value;return null===d||b.issues.push({expected:"null",code:"invalid_type",input:d,inst:a}),b}}),P=d.xI("$ZodAny",(a,b)=>{k.init(a,b),a._zod.parse=a=>a}),Q=d.xI("$ZodUnknown",(a,b)=>{k.init(a,b),a._zod.parse=a=>a}),R=d.xI("$ZodNever",(a,b)=>{k.init(a,b),a._zod.parse=(b,c)=>(b.issues.push({expected:"never",code:"invalid_type",input:b.value,inst:a}),b)});function S(a,b,c){a.issues.length&&b.issues.push(...i.lQ(c,a.issues)),b.value[c]=a.value}let T=d.xI("$ZodArray",(a,b)=>{k.init(a,b),a._zod.parse=(c,d)=>{let e=c.value;if(!Array.isArray(e))return c.issues.push({expected:"array",code:"invalid_type",input:e,inst:a}),c;c.value=Array(e.length);let f=[];for(let a=0;a<e.length;a++){let g=e[a],h=b.element._zod.run({value:g,issues:[]},d);h instanceof Promise?f.push(h.then(b=>S(b,c,a))):S(h,c,a)}return f.length?Promise.all(f).then(()=>c):c}});function U(a,b,c){a.issues.length&&b.issues.push(...i.lQ(c,a.issues)),b.value[c]=a.value}function V(a,b,c,d){a.issues.length?void 0===d[c]?c in d?b.value[c]=void 0:b.value[c]=a.value:b.issues.push(...i.lQ(c,a.issues)):void 0===a.value?c in d&&(b.value[c]=void 0):b.value[c]=a.value}let W=d.xI("$ZodObject",(a,b)=>{let c,e;k.init(a,b);let g=i.PO(()=>{let a=Object.keys(b.shape);for(let c of a)if(!(b.shape[c]instanceof k))throw Error(`Invalid element at key "${c}": expected a Zod schema`);let c=i.NM(b.shape);return{shape:b.shape,keys:a,keySet:new Set(a),numKeys:a.length,optionalKeys:new Set(c)}});i.gJ(a._zod,"propValues",()=>{let a=b.shape,c={};for(let b in a){let d=a[b]._zod;if(d.values)for(let a of(c[b]??(c[b]=new Set),d.values))c[b].add(a)}return c});let h=i.Gv,j=!d.cr.jitless,l=i.hI,m=j&&l.value,n=b.catchall;a._zod.parse=(d,k)=>{e??(e=g.value);let l=d.value;if(!h(l))return d.issues.push({expected:"object",code:"invalid_type",input:l,inst:a}),d;let o=[];if(j&&m&&k?.async===!1&&!0!==k.jitless)c||(c=(a=>{let b=new f(["shape","payload","ctx"]),c=g.value,d=a=>{let b=i.UQ(a);return`shape[${b}]._zod.run({ value: input[${b}], issues: [] }, ctx)`};b.write("const input = payload.value;");let e=Object.create(null),h=0;for(let a of c.keys)e[a]=`key_${h++}`;for(let a of(b.write("const newResult = {}"),c.keys))if(c.optionalKeys.has(a)){let c=e[a];b.write(`const ${c} = ${d(a)};`);let f=i.UQ(a);b.write(`
        if (${c}.issues.length) {
          if (input[${f}] === undefined) {
            if (${f} in input) {
              newResult[${f}] = undefined;
            }
          } else {
            payload.issues = payload.issues.concat(
              ${c}.issues.map((iss) => ({
                ...iss,
                path: iss.path ? [${f}, ...iss.path] : [${f}],
              }))
            );
          }
        } else if (${c}.value === undefined) {
          if (${f} in input) newResult[${f}] = undefined;
        } else {
          newResult[${f}] = ${c}.value;
        }
        `)}else{let c=e[a];b.write(`const ${c} = ${d(a)};`),b.write(`
          if (${c}.issues.length) payload.issues = payload.issues.concat(${c}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${i.UQ(a)}, ...iss.path] : [${i.UQ(a)}]
          })));`),b.write(`newResult[${i.UQ(a)}] = ${c}.value`)}b.write("payload.value = newResult;"),b.write("return payload;");let j=b.compile();return(b,c)=>j(a,b,c)})(b.shape)),d=c(d,k);else{d.value={};let a=e.shape;for(let b of e.keys){let c=a[b],e=c._zod.run({value:l[b],issues:[]},k),f="optional"===c._zod.optin&&"optional"===c._zod.optout;e instanceof Promise?o.push(e.then(a=>f?V(a,d,b,l):U(a,d,b))):f?V(e,d,b,l):U(e,d,b)}}if(!n)return o.length?Promise.all(o).then(()=>d):d;let p=[],q=e.keySet,r=n._zod,s=r.def.type;for(let a of Object.keys(l)){if(q.has(a))continue;if("never"===s){p.push(a);continue}let b=r.run({value:l[a],issues:[]},k);b instanceof Promise?o.push(b.then(b=>U(b,d,a))):U(b,d,a)}return(p.length&&d.issues.push({code:"unrecognized_keys",keys:p,input:l,inst:a}),o.length)?Promise.all(o).then(()=>d):d}});function X(a,b,c,e){for(let c of a)if(0===c.issues.length)return b.value=c.value,b;return b.issues.push({code:"invalid_union",input:b.value,inst:c,errors:a.map(a=>a.issues.map(a=>i.iR(a,e,d.$W())))}),b}let Y=d.xI("$ZodUnion",(a,b)=>{k.init(a,b),i.gJ(a._zod,"optin",()=>b.options.some(a=>"optional"===a._zod.optin)?"optional":void 0),i.gJ(a._zod,"optout",()=>b.options.some(a=>"optional"===a._zod.optout)?"optional":void 0),i.gJ(a._zod,"values",()=>{if(b.options.every(a=>a._zod.values))return new Set(b.options.flatMap(a=>Array.from(a._zod.values)))}),i.gJ(a._zod,"pattern",()=>{if(b.options.every(a=>a._zod.pattern)){let a=b.options.map(a=>a._zod.pattern);return RegExp(`^(${a.map(a=>i.p6(a.source)).join("|")})$`)}}),a._zod.parse=(c,d)=>{let e=!1,f=[];for(let a of b.options){let b=a._zod.run({value:c.value,issues:[]},d);if(b instanceof Promise)f.push(b),e=!0;else{if(0===b.issues.length)return b;f.push(b)}}return e?Promise.all(f).then(b=>X(b,c,a,d)):X(f,c,a,d)}}),Z=d.xI("$ZodDiscriminatedUnion",(a,b)=>{Y.init(a,b);let c=a._zod.parse;i.gJ(a._zod,"propValues",()=>{let a={};for(let c of b.options){let d=c._zod.propValues;if(!d||0===Object.keys(d).length)throw Error(`Invalid discriminated union option at index "${b.options.indexOf(c)}"`);for(let[b,c]of Object.entries(d))for(let d of(a[b]||(a[b]=new Set),c))a[b].add(d)}return a});let d=i.PO(()=>{let a=b.options,c=new Map;for(let d of a){let a=d._zod.propValues[b.discriminator];if(!a||0===a.size)throw Error(`Invalid discriminated union option at index "${b.options.indexOf(d)}"`);for(let b of a){if(c.has(b))throw Error(`Duplicate discriminator value "${String(b)}"`);c.set(b,d)}}return c});a._zod.parse=(e,f)=>{let g=e.value;if(!i.Gv(g))return e.issues.push({code:"invalid_type",expected:"object",input:g,inst:a}),e;let h=d.value.get(g?.[b.discriminator]);return h?h._zod.run(e,f):b.unionFallback?c(e,f):(e.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",input:g,path:[b.discriminator],inst:a}),e)}}),$=d.xI("$ZodIntersection",(a,b)=>{k.init(a,b),a._zod.parse=(a,c)=>{let d=a.value,e=b.left._zod.run({value:d,issues:[]},c),f=b.right._zod.run({value:d,issues:[]},c);return e instanceof Promise||f instanceof Promise?Promise.all([e,f]).then(([b,c])=>_(a,b,c)):_(a,e,f)}});function _(a,b,c){if(b.issues.length&&a.issues.push(...b.issues),c.issues.length&&a.issues.push(...c.issues),i.QH(a))return a;let d=function a(b,c){if(b===c||b instanceof Date&&c instanceof Date&&+b==+c)return{valid:!0,data:b};if(i.Qd(b)&&i.Qd(c)){let d=Object.keys(c),e=Object.keys(b).filter(a=>-1!==d.indexOf(a)),f={...b,...c};for(let d of e){let e=a(b[d],c[d]);if(!e.valid)return{valid:!1,mergeErrorPath:[d,...e.mergeErrorPath]};f[d]=e.data}return{valid:!0,data:f}}if(Array.isArray(b)&&Array.isArray(c)){if(b.length!==c.length)return{valid:!1,mergeErrorPath:[]};let d=[];for(let e=0;e<b.length;e++){let f=a(b[e],c[e]);if(!f.valid)return{valid:!1,mergeErrorPath:[e,...f.mergeErrorPath]};d.push(f.data)}return{valid:!0,data:d}}return{valid:!1,mergeErrorPath:[]}}(b.value,c.value);if(!d.valid)throw Error(`Unmergable intersection. Error path: ${JSON.stringify(d.mergeErrorPath)}`);return a.value=d.data,a}let aa=d.xI("$ZodRecord",(a,b)=>{k.init(a,b),a._zod.parse=(c,e)=>{let f=c.value;if(!i.Qd(f))return c.issues.push({expected:"record",code:"invalid_type",input:f,inst:a}),c;let g=[];if(b.keyType._zod.values){let d,h=b.keyType._zod.values;for(let a of(c.value={},h))if("string"==typeof a||"number"==typeof a||"symbol"==typeof a){let d=b.valueType._zod.run({value:f[a],issues:[]},e);d instanceof Promise?g.push(d.then(b=>{b.issues.length&&c.issues.push(...i.lQ(a,b.issues)),c.value[a]=b.value})):(d.issues.length&&c.issues.push(...i.lQ(a,d.issues)),c.value[a]=d.value)}for(let a in f)h.has(a)||(d=d??[]).push(a);d&&d.length>0&&c.issues.push({code:"unrecognized_keys",input:f,inst:a,keys:d})}else for(let h of(c.value={},Reflect.ownKeys(f))){if("__proto__"===h)continue;let j=b.keyType._zod.run({value:h,issues:[]},e);if(j instanceof Promise)throw Error("Async schemas not supported in object keys currently");if(j.issues.length){c.issues.push({origin:"record",code:"invalid_key",issues:j.issues.map(a=>i.iR(a,e,d.$W())),input:h,path:[h],inst:a}),c.value[j.value]=j.value;continue}let k=b.valueType._zod.run({value:f[h],issues:[]},e);k instanceof Promise?g.push(k.then(a=>{a.issues.length&&c.issues.push(...i.lQ(h,a.issues)),c.value[j.value]=a.value})):(k.issues.length&&c.issues.push(...i.lQ(h,k.issues)),c.value[j.value]=k.value)}return g.length?Promise.all(g).then(()=>c):c}}),ab=d.xI("$ZodEnum",(a,b)=>{k.init(a,b);let c=i.w5(b.entries);a._zod.values=new Set(c),a._zod.pattern=RegExp(`^(${c.filter(a=>i.qQ.has(typeof a)).map(a=>"string"==typeof a?i.$f(a):a.toString()).join("|")})$`),a._zod.parse=(b,d)=>{let e=b.value;return a._zod.values.has(e)||b.issues.push({code:"invalid_value",values:c,input:e,inst:a}),b}}),ac=d.xI("$ZodLiteral",(a,b)=>{k.init(a,b),a._zod.values=new Set(b.values),a._zod.pattern=RegExp(`^(${b.values.map(a=>"string"==typeof a?i.$f(a):a?a.toString():String(a)).join("|")})$`),a._zod.parse=(c,d)=>{let e=c.value;return a._zod.values.has(e)||c.issues.push({code:"invalid_value",values:b.values,input:e,inst:a}),c}}),ad=d.xI("$ZodTransform",(a,b)=>{k.init(a,b),a._zod.parse=(a,c)=>{let e=b.transform(a.value,a);if(c.async)return(e instanceof Promise?e:Promise.resolve(e)).then(b=>(a.value=b,a));if(e instanceof Promise)throw new d.GT;return a.value=e,a}}),ae=d.xI("$ZodOptional",(a,b)=>{k.init(a,b),a._zod.optin="optional",a._zod.optout="optional",i.gJ(a._zod,"values",()=>b.innerType._zod.values?new Set([...b.innerType._zod.values,void 0]):void 0),i.gJ(a._zod,"pattern",()=>{let a=b.innerType._zod.pattern;return a?RegExp(`^(${i.p6(a.source)})?$`):void 0}),a._zod.parse=(a,c)=>"optional"===b.innerType._zod.optin?b.innerType._zod.run(a,c):void 0===a.value?a:b.innerType._zod.run(a,c)}),af=d.xI("$ZodNullable",(a,b)=>{k.init(a,b),i.gJ(a._zod,"optin",()=>b.innerType._zod.optin),i.gJ(a._zod,"optout",()=>b.innerType._zod.optout),i.gJ(a._zod,"pattern",()=>{let a=b.innerType._zod.pattern;return a?RegExp(`^(${i.p6(a.source)}|null)$`):void 0}),i.gJ(a._zod,"values",()=>b.innerType._zod.values?new Set([...b.innerType._zod.values,null]):void 0),a._zod.parse=(a,c)=>null===a.value?a:b.innerType._zod.run(a,c)}),ag=d.xI("$ZodDefault",(a,b)=>{k.init(a,b),a._zod.optin="optional",i.gJ(a._zod,"values",()=>b.innerType._zod.values),a._zod.parse=(a,c)=>{if(void 0===a.value)return a.value=b.defaultValue,a;let d=b.innerType._zod.run(a,c);return d instanceof Promise?d.then(a=>ah(a,b)):ah(d,b)}});function ah(a,b){return void 0===a.value&&(a.value=b.defaultValue),a}let ai=d.xI("$ZodPrefault",(a,b)=>{k.init(a,b),a._zod.optin="optional",i.gJ(a._zod,"values",()=>b.innerType._zod.values),a._zod.parse=(a,c)=>(void 0===a.value&&(a.value=b.defaultValue),b.innerType._zod.run(a,c))}),aj=d.xI("$ZodNonOptional",(a,b)=>{k.init(a,b),i.gJ(a._zod,"values",()=>{let a=b.innerType._zod.values;return a?new Set([...a].filter(a=>void 0!==a)):void 0}),a._zod.parse=(c,d)=>{let e=b.innerType._zod.run(c,d);return e instanceof Promise?e.then(b=>ak(b,a)):ak(e,a)}});function ak(a,b){return a.issues.length||void 0!==a.value||a.issues.push({code:"invalid_type",expected:"nonoptional",input:a.value,inst:b}),a}let al=d.xI("$ZodCatch",(a,b)=>{k.init(a,b),a._zod.optin="optional",i.gJ(a._zod,"optout",()=>b.innerType._zod.optout),i.gJ(a._zod,"values",()=>b.innerType._zod.values),a._zod.parse=(a,c)=>{let e=b.innerType._zod.run(a,c);return e instanceof Promise?e.then(e=>(a.value=e.value,e.issues.length&&(a.value=b.catchValue({...a,error:{issues:e.issues.map(a=>i.iR(a,c,d.$W()))},input:a.value}),a.issues=[]),a)):(a.value=e.value,e.issues.length&&(a.value=b.catchValue({...a,error:{issues:e.issues.map(a=>i.iR(a,c,d.$W()))},input:a.value}),a.issues=[]),a)}}),am=d.xI("$ZodPipe",(a,b)=>{k.init(a,b),i.gJ(a._zod,"values",()=>b.in._zod.values),i.gJ(a._zod,"optin",()=>b.in._zod.optin),i.gJ(a._zod,"optout",()=>b.out._zod.optout),a._zod.parse=(a,c)=>{let d=b.in._zod.run(a,c);return d instanceof Promise?d.then(a=>an(a,b,c)):an(d,b,c)}});function an(a,b,c){return i.QH(a)?a:b.out._zod.run({value:a.value,issues:a.issues},c)}let ao=d.xI("$ZodReadonly",(a,b)=>{k.init(a,b),i.gJ(a._zod,"propValues",()=>b.innerType._zod.propValues),i.gJ(a._zod,"values",()=>b.innerType._zod.values),i.gJ(a._zod,"optin",()=>b.innerType._zod.optin),i.gJ(a._zod,"optout",()=>b.innerType._zod.optout),a._zod.parse=(a,c)=>{let d=b.innerType._zod.run(a,c);return d instanceof Promise?d.then(ap):ap(d)}});function ap(a){return a.value=Object.freeze(a.value),a}let aq=d.xI("$ZodLazy",(a,b)=>{k.init(a,b),i.gJ(a._zod,"innerType",()=>b.getter()),i.gJ(a._zod,"pattern",()=>a._zod.innerType._zod.pattern),i.gJ(a._zod,"propValues",()=>a._zod.innerType._zod.propValues),i.gJ(a._zod,"optin",()=>a._zod.innerType._zod.optin),i.gJ(a._zod,"optout",()=>a._zod.innerType._zod.optout),a._zod.parse=(b,c)=>a._zod.innerType._zod.run(b,c)}),ar=d.xI("$ZodCustom",(a,b)=>{e.QP.init(a,b),k.init(a,b),a._zod.parse=(a,b)=>a,a._zod.check=c=>{let d=c.value,e=b.fn(d);if(e instanceof Promise)return e.then(b=>as(b,c,d,a));as(e,c,d,a)}});function as(a,b,c,d){if(!a){let a={code:"custom",input:c,inst:d,path:[...d._zod.def.path??[]],continue:!d._zod.def.abort};d._zod.def.params&&(a.params=d._zod.def.params),b.issues.push(i.sn(a))}}var at=c(70101),au=c(59432);let av=d.xI("ZodISODateTime",(a,b)=>{y.init(a,b),aE.init(a,b)}),aw=d.xI("ZodISODate",(a,b)=>{z.init(a,b),aE.init(a,b)}),ax=d.xI("ZodISOTime",(a,b)=>{A.init(a,b),aE.init(a,b)}),ay=d.xI("ZodISODuration",(a,b)=>{B.init(a,b),aE.init(a,b)});var az=c(45443);let aA=d.xI("ZodType",(a,b)=>(k.init(a,b),a.def=b,Object.defineProperty(a,"_def",{value:b}),a.check=(...c)=>a.clone({...b,checks:[...b.checks??[],...c.map(a=>"function"==typeof a?{_zod:{check:a,def:{check:"custom"},onattach:[]}}:a)]}),a.clone=(b,c)=>i.o8(a,b,c),a.brand=()=>a,a.register=(b,c)=>(b.add(a,c),a),a.parse=(b,c)=>az.qg(a,b,c,{callee:a.parse}),a.safeParse=(b,c)=>az.xL(a,b,c),a.parseAsync=async(b,c)=>az.EJ(a,b,c,{callee:a.parseAsync}),a.safeParseAsync=async(b,c)=>az.bp(a,b,c),a.spa=a.safeParseAsync,a.refine=(b,c)=>a.check(function(a,b={}){return au.fU(bF,a,b)}(b,c)),a.superRefine=b=>a.check(function(a){let b=function(a){let b=new e.QP({check:"custom"});return b._zod.check=a,b}(c=>(c.addIssue=a=>{"string"==typeof a?c.issues.push(i.sn(a,c.value,b._zod.def)):(a.fatal&&(a.continue=!1),a.code??(a.code="custom"),a.input??(a.input=c.value),a.inst??(a.inst=b),a.continue??(a.continue=!b._zod.def.abort),c.issues.push(i.sn(a)))},a(c.value,c)));return b}(b)),a.overwrite=b=>a.check(au.bS(b)),a.optional=()=>bt(a),a.nullable=()=>bv(a),a.nullish=()=>bt(bv(a)),a.nonoptional=b=>{var c,d;return c=a,d=b,new by({type:"nonoptional",innerType:c,...i.A2(d)})},a.array=()=>bb(a),a.or=b=>bh([a,b]),a.and=b=>new bk({type:"intersection",left:a,right:b}),a.transform=b=>bB(a,new br({type:"transform",transform:b})),a.default=b=>(function(a,b){return new bw({type:"default",innerType:a,get defaultValue(){return"function"==typeof b?b():b}})})(a,b),a.prefault=b=>(function(a,b){return new bx({type:"prefault",innerType:a,get defaultValue(){return"function"==typeof b?b():b}})})(a,b),a.catch=b=>(function(a,b){return new bz({type:"catch",innerType:a,catchValue:"function"==typeof b?b:()=>b})})(a,b),a.pipe=b=>bB(a,b),a.readonly=()=>new bC({type:"readonly",innerType:a}),a.describe=b=>{let c=a.clone();return at.fd.add(c,{description:b}),c},Object.defineProperty(a,"description",{get:()=>at.fd.get(a)?.description,configurable:!0}),a.meta=(...b)=>{if(0===b.length)return at.fd.get(a);let c=a.clone();return at.fd.add(c,b[0]),c},a.isOptional=()=>a.safeParse(void 0).success,a.isNullable=()=>a.safeParse(null).success,a)),aB=d.xI("_ZodString",(a,b)=>{l.init(a,b),aA.init(a,b);let c=a._zod.bag;a.format=c.format??null,a.minLength=c.minimum??null,a.maxLength=c.maximum??null,a.regex=(...b)=>a.check(au.Fk(...b)),a.includes=(...b)=>a.check(au.dR(...b)),a.startsWith=(...b)=>a.check(au.$S(...b)),a.endsWith=(...b)=>a.check(au.ER(...b)),a.min=(...b)=>a.check(au.m9(...b)),a.max=(...b)=>a.check(au.Eb(...b)),a.length=(...b)=>a.check(au.YA(...b)),a.nonempty=(...b)=>a.check(au.m9(1,...b)),a.lowercase=b=>a.check(au.hH(b)),a.uppercase=b=>a.check(au.qF(b)),a.trim=()=>a.check(au.WN()),a.normalize=(...b)=>a.check(au.lo(...b)),a.toLowerCase=()=>a.check(au.Il()),a.toUpperCase=()=>a.check(au.xY())}),aC=d.xI("ZodString",(a,b)=>{l.init(a,b),aB.init(a,b),a.email=b=>a.check(au.Mu(aF,b)),a.url=b=>a.check(au.Fn(aI,b)),a.jwt=b=>a.check(au.rk(aY,b)),a.emoji=b=>a.check(au.aC(aJ,b)),a.guid=b=>a.check(au.tB(aG,b)),a.uuid=b=>a.check(au.Be(aH,b)),a.uuidv4=b=>a.check(au.nA(aH,b)),a.uuidv6=b=>a.check(au.pY(aH,b)),a.uuidv7=b=>a.check(au.wA(aH,b)),a.nanoid=b=>a.check(au.Dl(aK,b)),a.guid=b=>a.check(au.tB(aG,b)),a.cuid=b=>a.check(au.fs(aL,b)),a.cuid2=b=>a.check(au.Bj(aM,b)),a.ulid=b=>a.check(au.Ct(aN,b)),a.base64=b=>a.check(au.rt(aU,b)),a.base64url=b=>a.check(au.cU(aW,b)),a.xid=b=>a.check(au.Pw(aO,b)),a.ksuid=b=>a.check(au._z(aP,b)),a.ipv4=b=>a.check(au.Ny(aQ,b)),a.ipv6=b=>a.check(au.$O(aR,b)),a.cidrv4=b=>a.check(au.Uy(aS,b)),a.cidrv6=b=>a.check(au.gP(aT,b)),a.e164=b=>a.check(au.KB(aX,b)),a.datetime=b=>a.check(au.G1(av,b)),a.date=b=>a.check(au.db(aw,b)),a.time=b=>a.check(au.Kn(ax,b)),a.duration=b=>a.check(au.f2(ay,b))});function aD(a){return au.Rl(aC,a)}let aE=d.xI("ZodStringFormat",(a,b)=>{m.init(a,b),aB.init(a,b)}),aF=d.xI("ZodEmail",(a,b)=>{p.init(a,b),aE.init(a,b)}),aG=d.xI("ZodGUID",(a,b)=>{n.init(a,b),aE.init(a,b)}),aH=d.xI("ZodUUID",(a,b)=>{o.init(a,b),aE.init(a,b)}),aI=d.xI("ZodURL",(a,b)=>{q.init(a,b),aE.init(a,b)}),aJ=d.xI("ZodEmoji",(a,b)=>{r.init(a,b),aE.init(a,b)}),aK=d.xI("ZodNanoID",(a,b)=>{s.init(a,b),aE.init(a,b)}),aL=d.xI("ZodCUID",(a,b)=>{t.init(a,b),aE.init(a,b)}),aM=d.xI("ZodCUID2",(a,b)=>{u.init(a,b),aE.init(a,b)}),aN=d.xI("ZodULID",(a,b)=>{v.init(a,b),aE.init(a,b)}),aO=d.xI("ZodXID",(a,b)=>{w.init(a,b),aE.init(a,b)}),aP=d.xI("ZodKSUID",(a,b)=>{x.init(a,b),aE.init(a,b)}),aQ=d.xI("ZodIPv4",(a,b)=>{C.init(a,b),aE.init(a,b)}),aR=d.xI("ZodIPv6",(a,b)=>{D.init(a,b),aE.init(a,b)}),aS=d.xI("ZodCIDRv4",(a,b)=>{E.init(a,b),aE.init(a,b)}),aT=d.xI("ZodCIDRv6",(a,b)=>{F.init(a,b),aE.init(a,b)}),aU=d.xI("ZodBase64",(a,b)=>{H.init(a,b),aE.init(a,b)});function aV(a){return au.rt(aU,a)}let aW=d.xI("ZodBase64URL",(a,b)=>{I.init(a,b),aE.init(a,b)}),aX=d.xI("ZodE164",(a,b)=>{J.init(a,b),aE.init(a,b)}),aY=d.xI("ZodJWT",(a,b)=>{K.init(a,b),aE.init(a,b)}),aZ=d.xI("ZodNumber",(a,b)=>{L.init(a,b),aA.init(a,b),a.gt=(b,c)=>a.check(au.Tx(b,c)),a.gte=(b,c)=>a.check(au.qm(b,c)),a.min=(b,c)=>a.check(au.qm(b,c)),a.lt=(b,c)=>a.check(au.Au(b,c)),a.lte=(b,c)=>a.check(au.Zm(b,c)),a.max=(b,c)=>a.check(au.Zm(b,c)),a.int=b=>{var c;return a.check((c=b,au.LK(a_,c)))},a.safe=b=>{var c;return a.check((c=b,au.LK(a_,c)))},a.positive=b=>a.check(au.Tx(0,b)),a.nonnegative=b=>a.check(au.qm(0,b)),a.negative=b=>a.check(au.Au(0,b)),a.nonpositive=b=>a.check(au.Zm(0,b)),a.multipleOf=(b,c)=>a.check(au.Hi(b,c)),a.step=(b,c)=>a.check(au.Hi(b,c)),a.finite=()=>a;let c=a._zod.bag;a.minValue=Math.max(c.minimum??-1/0,c.exclusiveMinimum??-1/0)??null,a.maxValue=Math.min(c.maximum??1/0,c.exclusiveMaximum??1/0)??null,a.isInt=(c.format??"").includes("int")||Number.isSafeInteger(c.multipleOf??.5),a.isFinite=!0,a.format=c.format??null});function a$(a){return au.F7(aZ,a)}let a_=d.xI("ZodNumberFormat",(a,b)=>{M.init(a,b),aZ.init(a,b)}),a0=d.xI("ZodBoolean",(a,b)=>{N.init(a,b),aA.init(a,b)});function a1(a){return au._L(a0,a)}let a2=d.xI("ZodNull",(a,b)=>{O.init(a,b),aA.init(a,b)});function a3(a){return au.jw(a2,a)}let a4=d.xI("ZodAny",(a,b)=>{P.init(a,b),aA.init(a,b)});function a5(){return au.KA(a4)}let a6=d.xI("ZodUnknown",(a,b)=>{Q.init(a,b),aA.init(a,b)});function a7(){return au.em(a6)}let a8=d.xI("ZodNever",(a,b)=>{R.init(a,b),aA.init(a,b)});function a9(a){return au.G8(a8,a)}let ba=d.xI("ZodArray",(a,b)=>{T.init(a,b),aA.init(a,b),a.element=b.element,a.min=(b,c)=>a.check(au.m9(b,c)),a.nonempty=b=>a.check(au.m9(1,b)),a.max=(b,c)=>a.check(au.Eb(b,c)),a.length=(b,c)=>a.check(au.YA(b,c)),a.unwrap=()=>a.element});function bb(a,b){return au.dZ(ba,a,b)}let bc=d.xI("ZodObject",(a,b)=>{W.init(a,b),aA.init(a,b),i.gJ(a,"shape",()=>b.shape),a.keyof=()=>bo(Object.keys(a._zod.def.shape)),a.catchall=b=>a.clone({...a._zod.def,catchall:b}),a.passthrough=()=>a.clone({...a._zod.def,catchall:a7()}),a.loose=()=>a.clone({...a._zod.def,catchall:a7()}),a.strict=()=>a.clone({...a._zod.def,catchall:a9()}),a.strip=()=>a.clone({...a._zod.def,catchall:void 0}),a.extend=b=>i.X$(a,b),a.merge=b=>i.h1(a,b),a.pick=b=>i.Up(a,b),a.omit=b=>i.cJ(a,b),a.partial=(...b)=>i.OH(bs,a,b[0]),a.required=(...b)=>i.mw(by,a,b[0])});function bd(a,b){return new bc({type:"object",get shape(){return i.Vy(this,"shape",{...a}),this.shape},...i.A2(b)})}function be(a,b){return new bc({type:"object",get shape(){return i.Vy(this,"shape",{...a}),this.shape},catchall:a9(),...i.A2(b)})}function bf(a,b){return new bc({type:"object",get shape(){return i.Vy(this,"shape",{...a}),this.shape},catchall:a7(),...i.A2(b)})}let bg=d.xI("ZodUnion",(a,b)=>{Y.init(a,b),aA.init(a,b),a.options=b.options});function bh(a,b){return new bg({type:"union",options:a,...i.A2(b)})}let bi=d.xI("ZodDiscriminatedUnion",(a,b)=>{bg.init(a,b),Z.init(a,b)});function bj(a,b,c){return new bi({type:"union",options:b,discriminator:a,...i.A2(c)})}let bk=d.xI("ZodIntersection",(a,b)=>{$.init(a,b),aA.init(a,b)}),bl=d.xI("ZodRecord",(a,b)=>{aa.init(a,b),aA.init(a,b),a.keyType=b.keyType,a.valueType=b.valueType});function bm(a,b,c){return new bl({type:"record",keyType:a,valueType:b,...i.A2(c)})}let bn=d.xI("ZodEnum",(a,b)=>{ab.init(a,b),aA.init(a,b),a.enum=b.entries,a.options=Object.values(b.entries);let c=new Set(Object.keys(b.entries));a.extract=(a,d)=>{let e={};for(let d of a)if(c.has(d))e[d]=b.entries[d];else throw Error(`Key ${d} not found in enum`);return new bn({...b,checks:[],...i.A2(d),entries:e})},a.exclude=(a,d)=>{let e={...b.entries};for(let b of a)if(c.has(b))delete e[b];else throw Error(`Key ${b} not found in enum`);return new bn({...b,checks:[],...i.A2(d),entries:e})}});function bo(a,b){return new bn({type:"enum",entries:Array.isArray(a)?Object.fromEntries(a.map(a=>[a,a])):a,...i.A2(b)})}let bp=d.xI("ZodLiteral",(a,b)=>{ac.init(a,b),aA.init(a,b),a.values=new Set(b.values),Object.defineProperty(a,"value",{get(){if(b.values.length>1)throw Error("This schema contains multiple valid literal values. Use `.values` instead.");return b.values[0]}})});function bq(a,b){return new bp({type:"literal",values:Array.isArray(a)?a:[a],...i.A2(b)})}let br=d.xI("ZodTransform",(a,b)=>{ad.init(a,b),aA.init(a,b),a._zod.parse=(c,d)=>{c.addIssue=d=>{"string"==typeof d?c.issues.push(i.sn(d,c.value,b)):(d.fatal&&(d.continue=!1),d.code??(d.code="custom"),d.input??(d.input=c.value),d.inst??(d.inst=a),d.continue??(d.continue=!0),c.issues.push(i.sn(d)))};let e=b.transform(c.value,c);return e instanceof Promise?e.then(a=>(c.value=a,c)):(c.value=e,c)}}),bs=d.xI("ZodOptional",(a,b)=>{ae.init(a,b),aA.init(a,b),a.unwrap=()=>a._zod.def.innerType});function bt(a){return new bs({type:"optional",innerType:a})}let bu=d.xI("ZodNullable",(a,b)=>{af.init(a,b),aA.init(a,b),a.unwrap=()=>a._zod.def.innerType});function bv(a){return new bu({type:"nullable",innerType:a})}let bw=d.xI("ZodDefault",(a,b)=>{ag.init(a,b),aA.init(a,b),a.unwrap=()=>a._zod.def.innerType,a.removeDefault=a.unwrap}),bx=d.xI("ZodPrefault",(a,b)=>{ai.init(a,b),aA.init(a,b),a.unwrap=()=>a._zod.def.innerType}),by=d.xI("ZodNonOptional",(a,b)=>{aj.init(a,b),aA.init(a,b),a.unwrap=()=>a._zod.def.innerType}),bz=d.xI("ZodCatch",(a,b)=>{al.init(a,b),aA.init(a,b),a.unwrap=()=>a._zod.def.innerType,a.removeCatch=a.unwrap}),bA=d.xI("ZodPipe",(a,b)=>{am.init(a,b),aA.init(a,b),a.in=b.in,a.out=b.out});function bB(a,b){return new bA({type:"pipe",in:a,out:b})}let bC=d.xI("ZodReadonly",(a,b)=>{ao.init(a,b),aA.init(a,b)}),bD=d.xI("ZodLazy",(a,b)=>{aq.init(a,b),aA.init(a,b),a.unwrap=()=>a._zod.def.getter()});function bE(a){return new bD({type:"lazy",getter:a})}let bF=d.xI("ZodCustom",(a,b)=>{ar.init(a,b),aA.init(a,b)});function bG(a,b){return au.FO(bF,a??(()=>!0),b)}function bH(a,b={error:`Input not instance of ${a.name}`}){let c=new bF({type:"custom",check:"custom",fn:b=>b instanceof a,abort:!0,...i.A2(b)});return c._zod.bag.Class=a,c}},84181:(a,b,c)=>{c.d(b,{JM:()=>i,Kd:()=>h,Wk:()=>j,a$:()=>g});var d=c(41725),e=c(13602);let f=(a,b)=>{a.name="$ZodError",Object.defineProperty(a,"_zod",{value:a._zod,enumerable:!1}),Object.defineProperty(a,"issues",{value:b,enumerable:!1}),Object.defineProperty(a,"message",{get:()=>JSON.stringify(b,e.k8,2),enumerable:!0}),Object.defineProperty(a,"toString",{value:()=>a.message,enumerable:!1})},g=(0,d.xI)("$ZodError",f),h=(0,d.xI)("$ZodError",f,{Parent:Error});function i(a,b=a=>a.message){let c={},d=[];for(let e of a.issues)e.path.length>0?(c[e.path[0]]=c[e.path[0]]||[],c[e.path[0]].push(b(e))):d.push(b(e));return{formErrors:d,fieldErrors:c}}function j(a,b){let c=b||function(a){return a.message},d={_errors:[]},e=a=>{for(let b of a.issues)if("invalid_union"===b.code&&b.errors.length)b.errors.map(a=>e({issues:a}));else if("invalid_key"===b.code)e({issues:b.issues});else if("invalid_element"===b.code)e({issues:b.issues});else if(0===b.path.length)d._errors.push(c(b));else{let a=d,e=0;for(;e<b.path.length;){let d=b.path[e];e===b.path.length-1?(a[d]=a[d]||{_errors:[]},a[d]._errors.push(c(b))):a[d]=a[d]||{_errors:[]},a=a[d],e++}}};return e(a),d}}};